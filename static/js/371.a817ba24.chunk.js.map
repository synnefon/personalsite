{"version":3,"file":"static/js/371.a817ba24.chunk.js","mappings":"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","sources":["4096/Game4096.tsx","util/Random.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\n\nimport \"../styles/game4096.css\";\nimport { randomChoice, shuffle } from \"../util/Random\";\n\nconst DIM = 4;\n\nconst COLOR_MAP = {\n  0: \"grey\",\n  2: \"#D6B300\",\n  4: \"#AC8F10\",\n  8: \"#826B20\",\n  16: \"#58482F\",\n  32: \"#2E243F\", \n  64: \"#04004F\",\n  128: \"#020024\",\n  256: \"#000000\",\n  512: \"#062B1A\",\n  1024: \"#062B1A\",\n  2048: \"#0D5635\",\n  4096: \"#13804F\"\n}\n\nconst LEFT = \"ArrowLeft\";\nconst RIGHT = \"ArrowRight\";\nconst UP = \"ArrowUp\";\nconst DOWN = \"ArrowDown\";\n\nconst initCells = (): Array<Array<number>> => {\n  const choices = Array.from({ length: DIM }, (_, idx) => idx);\n  let c1 = {x: randomChoice(choices), y: randomChoice(choices)};\n  let c2 = {x: randomChoice(choices), y: randomChoice(choices)};\n  while (c1.x === c2.x && c1.y === c2.y) {\n    c2 = {x: randomChoice(choices), y: randomChoice(choices)};\n  }\n\n  const cells = Array.from({ length: DIM }, () => new Array(DIM).fill(0));\n  cells[c1.y][c1.x] = 2;\n  cells[c2.y][c2.x] = 2;\n\n  return cells;\n}\n\nconst DrawableCell = ({value}) => {\n  const style = {\n    backgroundColor: COLOR_MAP[value] || \"black\",\n  }\n  return (\n    <div className=\"cell-4096\" style={style}>\n      {value === 0 ? \"\" : value}\n    </div>\n  );\n}\n\nexport default function Game4096() {\n  const cells = useRef(initCells());\n  const processing = useRef(false);\n  const [score, setScore] = useState(0);\n\n  const spawnBaby = () => {\n    const empties: Array<{x: number, y: number}> = [];\n    for (let y=0; y<DIM; y++) {\n      for (let x=0; x<DIM; x++) {\n        if (cells.current[y][x] === 0) {\n          empties.push({x: x, y: y});\n        }\n      }\n    }\n    if (empties.length === 0) return;\n\n    const selected = shuffle(empties)[0];\n    cells.current[selected.y][selected.x] = 2;\n  }\n\n  const clenchStrip = (strip: Array<number>): Array<number> => {\n    strip.reverse();\n    let found = 0;\n    for (let i=0; i<strip.length-1; i++) {\n      if (strip[i+found] && strip[i] === strip[i+1]) {\n        found += 1;\n        strip[i] += strip[i];\n      } else if (found > 0) {\n        strip[i] = strip[i+found] || 0;\n      }\n    }\n    if (found) {\n      strip.pop();\n      strip = [...Array.from({ length: found }, () => 0), ...strip];\n    }\n    return strip;\n  }\n\n  const shiftY = (dir: string) => {\n    let yd = dir === DOWN ? -1 : 1;\n    let start = dir === DOWN ? DIM-1 : 0;\n    let end = dir === DOWN ? -1 : DIM;\n\n    const newCells = Array.from({ length: DIM }, () => new Array(DIM).fill(0));\n\n    for (let x = 0; x < DIM; x++) {\n      let col: Array<number> = [];\n      for (let y = start; y !== end; y+=yd) {\n        const val = cells.current[y][x];\n        if (val !== 0) col.push(val);\n      }\n      col = clenchStrip(col);\n      for (let y = start; y !== end; y+=yd) {\n        newCells[y][x] = col.pop() || 0;\n      }\n    }\n\n    cells.current = newCells;\n    spawnBaby();\n    setScore(s => s+1);\n  };\n\n  const shiftX = (dir: string) => {\n    let xd = dir === RIGHT ? -1 : 1;\n    let start = dir === RIGHT ? DIM-1 : 0;\n    let end = dir === RIGHT ? -1 : DIM;\n\n    const newCells = Array.from({ length: DIM }, () => new Array(DIM).fill(0));\n\n    for (let y = 0; y < DIM; y++) {\n      let col: Array<number> = [];\n      for (let x = start; x !== end; x+=xd) {\n        const val = cells.current[y][x];\n        if (val !== 0) col.push(val);\n      }\n      col = clenchStrip(col);\n      for (let x = start; x !== end; x+=xd) {\n        newCells[y][x] = col.pop() || 0;\n      }\n    }\n\n    cells.current = newCells;\n    spawnBaby();\n    setScore(s => s+1);\n  };\n\n  useEffect(() => {\n    const onKeydown = (e: KeyboardEvent) => {\n      if (processing.current) return;\n      processing.current = true;\n      switch (e.key) {\n        case LEFT: \n        case RIGHT: shiftX (e.key); break;\n        case UP:\n        case DOWN: shiftY(e.key);\n      }\n      processing.current = false;\n    };\n\n    window.addEventListener(\"keydown\", onKeydown);\n    return () => window.removeEventListener(\"keydown\", onKeydown);\n  });\n\n  return (\n    <div id=\"game-4096\">\n      {score}\n      <div className=\"board-4096\">\n        {cells.current.flatMap((row: Array<number>, ridx: number) => {\n          return row.map((c: number, cidx: number) => {\n            return <DrawableCell key={`${ridx}-${cidx}`} value={c}/>\n          });\n        })}\n      </div>\n    </div>\n  );\n}","export const randomChoice = (arr) => arr[Math.floor(Math.random() * arr.length)];\n\nexport const shuffle = ([...arr]) => {\n  let m = arr.length;\n  while (m) {\n    const i = Math.floor(Math.random() * m--);\n    [arr[m], arr[i]] = [arr[i], arr[m]];\n  }\n  return arr;\n};"],"names":["DIM","COLOR_MAP","LEFT","RIGHT","UP","DOWN","initCells","choices","Array","from","length","_","idx","c1","randomChoice","c2","x","y","cells","fill","DrawableCell","_ref","value","style","backgroundColor","_jsx","className","children","Game4096","useRef","processing","score","setScore","useState","spawnBaby","empties","current","push","selected","shuffle","clenchStrip","strip","reverse","found","i","pop","useEffect","onKeydown","e","key","dir","xd","start","end","newCells","col","val","s","shiftX","yd","shiftY","window","addEventListener","removeEventListener","_jsxs","id","flatMap","row","ridx","map","c","cidx","concat","arr","Math","floor","random","m"],"sourceRoot":""}