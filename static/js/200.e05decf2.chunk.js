"use strict";(self.webpackChunkpersonalsite=self.webpackChunkpersonalsite||[]).push([[200],{202:(e,t,n)=>{n.r(t),n.d(t,{default:()=>L,stepSimulationOnePairPass:()=>x});var a=n(5043);const r=n.p+"static/media/guitar.7c3177d2baeb887643cc.mp3",s=n.p+"static/media/click.1c87678ffc4ae6835e44.mp3";var i=n(7375),l=n(579);const c={GRAVITY:.01,BUOYANCY:.04,FRICTION:.98,HEAT_RATE:.005,COOL_RATE:.0017,HEAT_CONDUCTION:.002,HEAT_SOURCE_DISTANCE:45,COHESION_RADIUS:25,COHESION_STRENGTH:.0035,MOUSE_HEAT_RADIUS:100},o={PARTICLE_RADIUS:10,PIXEL_SIZE:6,THRESHOLD:.8},u={COUNT:15,RADIUS:50,TOP_HALF_PROB:.3},h={WIDTH:1920,HEIGHT:1080,PARTICLES:1200},d={MIN:0,MAX:5,DEFAULT:1,STEPS:10};function m(e){const t=e.trim().replace("#","");if(3===t.length){return{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16)}}if(6===t.length){return{r:parseInt(t.slice(0,2),16),g:parseInt(t.slice(2,4),16),b:parseInt(t.slice(4,6),16)}}return{r:255,g:221,b:0}}function v(e,t,n){const a=e+(t-e)*n;return a<0?0:a>255?255:Math.round(a)}function f(e,t,n){const a=T(e),r=m(t),s=m(n);return{r:v(r.r,s.r,a),g:v(r.g,s.g,a),b:v(r.b,s.b,a)}}const p="lavaLamp.musicTimeSeconds";function E(e){if(e<=0)return 0;const t=d.STEPS;if(t<=1)return d.DEFAULT;const n=(e-1)/(t-2),a=Math.log(.25),r=Math.log(d.MAX);return Math.exp(function(e,t,n){return e+(t-e)*n}(a,r,n))}function T(e){return e<0?0:e>1?1:e}function w(e,t){return Math.hypot(e,t)}function g(e){const t=Math.random()*Math.PI*2,n=Math.random()*e;return{x:Math.cos(t)*n,y:Math.sin(t)*n}}function S(e,t,n){e.x<0?(e.x=0,e.vx*=-.5):e.x>t&&(e.x=t,e.vx*=-.5),e.y<0?(e.y=0,e.vy*=-.5):e.y>n&&(e.y=n,e.vy*=-.5)}function x(e,t,n,a,r,s,i){const l=Math.max(0,Math.min(4,i));for(let c=0;c<e.length;c++){const i=e[c];A(i,l),I(i,l),N(i,l),a&&y(i,r,l),s[c]=0,S(i,t,n)}if(l>0){for(let t=0;t<e.length;t++){const n=e[t];for(let a=t+1;a<e.length;a++){const r=e[a],i=r.x-n.x,o=r.y-n.y,u=w(i,o);u>0&&u<c.COHESION_RADIUS&&(s[t]++,s[a]++,b(n,r,i,o,u,l),C(n,r,l))}}for(let t=0;t<e.length;t++){const a=e[t];R(a,n,s[t],l),a.heat=T(a.heat)}}else for(let c=0;c<e.length;c++)e[c].heat=T(e[c].heat);!function(e,t,n){for(let a=0;a<e.length;a++)S(e[a],t,n)}(e,t,n)}function A(e,t){if(0===t)return;const n=e.heat*e.heat*c.BUOYANCY;e.vy+=(c.GRAVITY-n)*t}function I(e,t){if(0===t)return;const n=Math.pow(c.FRICTION,t);e.vx*=n,e.vy*=n}function N(e,t){0!==t&&(e.x+=e.vx*t,e.y+=e.vy*t)}function y(e,t,n){const a=w(e.x-t.x,e.y-t.y);if(a<c.MOUSE_HEAT_RADIUS){const t=1-a*(1/c.MOUSE_HEAT_RADIUS);e.heat+=2*c.HEAT_RATE*t*(0===n?1:n)}}function b(e,t,n,a,r,s){const i=c.COHESION_STRENGTH*(1-r*(1/c.COHESION_RADIUS)),l=1/r,o=n*l*i*s,u=a*l*i*s;e.vx+=o,e.vy+=u,t.vx-=o,t.vy-=u}function C(e,t,n){const a=(e.heat-t.heat)*c.HEAT_CONDUCTION*n;e.heat-=a,t.heat+=a}function R(e,t,n,a){const r=t-e.y;if(r<c.HEAT_SOURCE_DISTANCE){const t=1-r*(1/c.HEAT_SOURCE_DISTANCE);return void(e.heat+=c.HEAT_RATE*t*a)}const s=1-(n<8?n:8)/8;e.heat-=c.COOL_RATE*(.2+.8*s)*a}function M(e,t,n,a,r,s,i,l,c){for(let o=0;o<s;o++){const u=r+o;if(u>=n)continue;const h=u*t*4;for(let n=0;n<s;n++){const r=a+n;if(r>=t)continue;const s=h+4*r;e[s+0]=i,e[s+1]=l,e[s+2]=c,e[s+3]=255}}}function O(e,t,n,a){const r=t-e.x,s=n-e.y;return a/(r*r+s*s+1)}function H(e,t,n,a,r){const s=e.getContext("2d");if(!s)return;s.fillStyle="#000",s.fillRect(0,0,e.width,e.height);const i=function(e,t,n,a){const r=t.current;return r&&r.width===n&&r.height===a||(t.current=e.createImageData(n,a)),t.current}(s,n,e.width,e.height);!function(e,t,n,a,r,s){const i=e.data;i.fill(0);const l=o.PIXEL_SIZE,c=o.THRESHOLD,u=o.PARTICLE_RADIUS*o.PARTICLE_RADIUS;for(let o=0;o<a;o+=l)for(let e=0;e<n;e+=l){let h=0,d=0;for(let n=0;n<t.length;n++){const a=t[n],r=O(a,e,o,u);h+=r,d+=r*a.heat}if(h<=c)continue;const m=d/h,{r:v,g:p,b:E}=f(m,r,s);M(i,n,a,e,o,l,v,p,E)}}(i,t,e.width,e.height,a,r),s.putImageData(i,0,0)}function L(){const e=(0,a.useRef)(null),t=(0,a.useRef)(null),n=(0,a.useRef)([]),c=(0,a.useRef)(null),o=(0,a.useRef)(new Uint16Array(0)),m=(0,a.useRef)(null),v=(0,a.useMemo)((()=>new i.D(r,!0)),[]),f=(0,a.useMemo)((()=>new i.D(s,!1)),[]),[T,w]=(0,a.useState)(!1),S=(0,a.useRef)(!1),A=(0,a.useRef)({x:0,y:0}),I=(0,a.useMemo)((()=>function(e){if(e<=0)return 0;const t=d.STEPS;let n=1,a=1/0;const r=Math.log(e);for(let s=1;s<t;s++){const e=E(s),t=Math.abs(Math.log(e)-r);t<a&&(a=t,n=s)}return n}(d.DEFAULT)),[]),[N,y]=(0,a.useState)(I),b=(0,a.useRef)(d.DEFAULT);(0,a.useEffect)((()=>{b.current=E(N)}),[N]);const[C,R]=(0,a.useState)(!1),M=(0,a.useCallback)((()=>{R((e=>!e))}),[]),[O,L]=(0,a.useState)(1);(0,a.useEffect)((()=>{v.volume=O}),[O,v]);const _=(0,a.useRef)("#ffdd00"),U=(0,a.useRef)("#ff5500"),D=(0,a.useCallback)((()=>{const e=window.innerWidth,t=window.innerHeight;null===m.current&&(m.current=function(e,t){const n=h.WIDTH*h.HEIGHT,a=e*t,r=h.PARTICLES/n,s=Math.round(a*r);return Math.max(200,Math.min(2e3,s))}(e,t));const a=m.current;n.current=function(e,t,n){const a=[],r=Math.floor(n/u.COUNT);for(let s=0;s<u.COUNT;s++){const n=Math.random()*e,s=Math.random()<u.TOP_HALF_PROB?Math.random()*t*.5:.5*t+Math.random()*t*.5,i=Math.random();for(let e=0;e<r;e++){const e=g(u.RADIUS);a.push({x:n+e.x,y:s+e.y,vx:0,vy:0,heat:i})}}for(;a.length<n;)a.push({x:Math.random()*e,y:Math.random()*t,vx:0,vy:0,heat:0});return a}(e,t,a),o.current=new Uint16Array(a)}),[]),j=(0,a.useCallback)((()=>{var e;!function(e){try{if(!Number.isFinite(e)||e<0)return;localStorage.setItem(p,String(e))}catch(t){}}(null!==(e=v.currentTime)&&void 0!==e?e:0)}),[v]);(0,a.useEffect)((()=>{if(!T)return;const e=window.setInterval((()=>j()),1e3),t=()=>j(),n=()=>{"hidden"===document.visibilityState&&j()};return window.addEventListener("pagehide",t),document.addEventListener("visibilitychange",n),()=>{window.clearInterval(e),window.removeEventListener("pagehide",t),document.removeEventListener("visibilitychange",n)}}),[T,j]),(0,a.useEffect)((()=>()=>{j(),v.pause(),v.volume=0,v.reset(),f.pause(),f.volume=0,f.reset()}),[v,f,j]);const P=(0,a.useCallback)((()=>{x(n.current,window.innerWidth,window.innerHeight,S.current,A.current,o.current,b.current)}),[]),k=(0,a.useCallback)((()=>{const t=e.current;t&&H(t,n.current,c,_.current,U.current)}),[]),F=(0,a.useCallback)((()=>{P(),k(),t.current=requestAnimationFrame(F)}),[P,k]);(0,a.useEffect)((()=>{const t=()=>{const t=e.current;t&&(!function(e){e.width=window.innerWidth,e.height=window.innerHeight}(t),c.current=null,T&&k())};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)}),[k,T]),(0,a.useEffect)((()=>{const t=e.current;if(!t)return;const n=e=>{const n=t.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}},a=e=>{S.current=!0,A.current=n(e)},r=e=>{A.current=n(e)},s=()=>{S.current=!1};return t.addEventListener("pointerdown",a),window.addEventListener("pointermove",r),window.addEventListener("pointerup",s),window.addEventListener("pointercancel",s),()=>{t.removeEventListener("pointerdown",a),window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",s),window.removeEventListener("pointercancel",s)}}),[]);const Y=(0,a.useCallback)((()=>{try{f.volume=1,f.currentTime=0,f.reset(),f.play()}catch(e){}}),[f]),G=(0,a.useCallback)((()=>{const e=function(){try{const e=localStorage.getItem(p);if(!e)return 0;const t=Number(e);return Number.isFinite(t)&&t>=0?t:0}catch(e){return 0}}();try{const t=v.duration;"number"===typeof t&&Number.isFinite(t)&&t>0?v.currentTime=e%t:v.currentTime=e}catch(t){}}),[v]),W=(0,a.useCallback)((()=>{Y(),T||(w(!0),D(),requestAnimationFrame((()=>k())),t.current=requestAnimationFrame(F)),G(),v.volume=1,v.play()}),[F,k,v,T,D,Y,G]),B=(0,a.useMemo)((()=>({w:window.innerWidth,h:window.innerHeight})),[]),X=(0,a.useRef)(null);return(0,l.jsxs)("div",{className:"lava-lamp-container",children:[(0,l.jsx)("canvas",{ref:e,className:"lava-lamp-canvas",width:B.w,height:B.h}),T?(0,l.jsxs)("div",{className:"lava-lamp-controls",children:[(0,l.jsx)("button",{type:"button",className:"lava-lamp-menu-toggle",onClick:M,"aria-label":C?"Hide menu":"Show menu","aria-pressed":C,children:C?"\u2715":"\u2630"}),C&&(0,l.jsxs)("div",{className:"lava-lamp-menu",children:[(0,l.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,l.jsx)("div",{className:"lava-lamp-control-header",children:(0,l.jsxs)("div",{className:"lava-lamp-control-title",children:["speed: ",N]})}),(0,l.jsx)("div",{ref:X,className:"lava-lamp-slider-wrap",children:(0,l.jsx)("input",{className:"lava-lamp-slider",type:"range",min:0,max:d.STEPS,step:1,value:N,onChange:e=>{return y((t=Number(e.target.value),n=0,a=d.STEPS,t<n?n:t>a?a:t));var t,n,a},"aria-label":"Simulation speed"})})]}),(0,l.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,l.jsx)("div",{className:"lava-lamp-control-header",children:(0,l.jsxs)("div",{className:"lava-lamp-control-title",children:["volume: ",Math.round(100*O),"%"]})}),(0,l.jsx)("div",{className:"lava-lamp-slider-wrap",children:(0,l.jsx)("input",{className:"lava-lamp-slider",type:"range",min:0,max:1,step:.01,value:O,onChange:e=>L(Number(e.target.value)),"aria-label":"Music volume"})})]}),(0,l.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,l.jsx)("div",{className:"lava-lamp-control-header",children:(0,l.jsx)("div",{className:"lava-lamp-control-title",children:"lava colors"})}),(0,l.jsxs)("div",{className:"lava-lamp-color-row",children:[(0,l.jsxs)("label",{className:"lava-lamp-color-label",children:["low",(0,l.jsx)("input",{className:"lava-lamp-color-input",type:"color",value:_.current,onChange:e=>_.current=e.target.value,"aria-label":"Lava low color"})]}),(0,l.jsxs)("label",{className:"lava-lamp-color-label",children:["high",(0,l.jsx)("input",{className:"lava-lamp-color-input",type:"color",value:U.current,onChange:e=>U.current=e.target.value,"aria-label":"Lava high color"})]}),(0,l.jsx)("button",{type:"button",className:"lava-lamp-color-reset",onClick:()=>{_.current="#ffdd00",U.current="#ff5500"},children:"reset"})]})]})]})]}):(0,l.jsx)("div",{className:"lava-lamp-start-overlay",children:(0,l.jsx)("button",{type:"button",className:"lava-lamp-start",onClick:W,"aria-label":"Start lava lamp",children:"START"})})]})}},7375:(e,t,n)=>{n.d(t,{D:()=>a});class a extends Audio{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e),this.isPlayingSrc=e=>{var t;return(null===(t=this.src)||void 0===t?void 0:t.includes(e))&&this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2},this.isPlaying=()=>this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2,this.timeLeft=()=>this.duration-this.currentTime,this.reset=()=>{this.pause(),this.currentTime=0},this.loop=t}}}}]);
//# sourceMappingURL=200.e05decf2.chunk.js.map