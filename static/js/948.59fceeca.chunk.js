"use strict";(self.webpackChunkpersonalsite=self.webpackChunkpersonalsite||[]).push([[948],{7246:(e,a,t)=>{t.r(a),t.d(a,{default:()=>X,stepSimulationOnePairPass:()=>M});var n=t(5043);const r=t.p+"static/media/guitar.7c3177d2baeb887643cc.mp3",l=t.p+"static/media/click.1c87678ffc4ae6835e44.mp3";const s=t.p+"static/media/power.632cc1e66922cf3fa35d93370ea84178.svg";var c=t(7375),o=t(579);const i={REDWOOD:"redwood",KEXP:"kexp"},u={[i.REDWOOD]:{label:"redwood meditation",url:r},[i.KEXP]:{label:"kexp",url:"https://kexp.streamguys1.com/kexp160.aac"}},d="#ffdd00",h="#ff5500",m={GRAVITY:.01,BUOYANCY:.04,FRICTION:.98,HEAT_RATE:.005,COOL_RATE:.0017,HEAT_CONDUCTION:.002,HEAT_SOURCE_DISTANCE:45,COHESION_RADIUS:25,COHESION_STRENGTH:.0035,MOUSE_HEAT_RADIUS:100},v={PARTICLE_RADIUS:10,PIXEL_SIZE:6,THRESHOLD:.8},p={COUNT:15,RADIUS:50,TOP_HALF_PROB:.3},f={WIDTH:1920,HEIGHT:1080,PARTICLES:1200},w={MIN:0,MAX:5,DEFAULT:.25,STEPS:10},x=1e3/60,g=4,E="lavaLamp.musicTimeSeconds";function y(e){return e<0?0:e>1?1:e}function b(e,a,t){const n=e+(a-e)*t;return n<0?0:n>255?255:Math.round(n)}function N(e){const a=Math.random()*Math.PI*2,t=Math.random()*e;return{x:Math.cos(a)*t,y:Math.sin(a)*t}}function S(e,a,t){e.x<0?(e.x=0,e.vx*=-.5):e.x>a&&(e.x=a,e.vx*=-.5),e.y<0?(e.y=0,e.vy*=-.5):e.y>t&&(e.y=t,e.vy*=-.5)}function A(e,a,t){for(let n=0;n<e.length;n++)S(e[n],a,t)}function T(e){if(e<=0)return 0;const a=w.STEPS;if(e>=a)return w.MAX;const t=e/a,n=.25/w.MAX,r=Math.log(n),l=Math.log(w.MAX);return Math.exp(function(e,a,t){return e+(a-e)*t}(r,l,t))}function I(e){const a=e.trim().replace("#","");if(3===a.length){return{r:parseInt(a[0]+a[0],16),g:parseInt(a[1]+a[1],16),b:parseInt(a[2]+a[2],16)}}if(6===a.length){return{r:parseInt(a.slice(0,2),16),g:parseInt(a.slice(2,4),16),b:parseInt(a.slice(4,6),16)}}return{r:255,g:221,b:0}}function C(e,a,t,n){return n<<24|t<<16|a<<8|e}function R(e,a){const t=I(e),n=I(a),r=new Uint32Array(256);for(let l=0;l<256;l++){const e=l/255,a=b(t.r,n.r,e),s=b(t.g,n.g,e),c=b(t.b,n.b,e);r[l]=C(a,s,c,255)}return r}function j(e,a,t){return t*e.cols+a}function M(e,a,t,n,r,l,s,c){const o=Math.max(0,Math.min(4,s));for(let h=0;h<e.length;h++){const s=e[h];O(s,o),k(s,o),L(s,o),n&&H(s,r,o),l[h]=0,S(s,a,t)}if(0===o){for(let a=0;a<e.length;a++)e[a].heat=y(e[a].heat);return void A(e,a,t)}c.heads.fill(-1);const i=1/c.cellSize;for(let h=0;h<e.length;h++){const a=e[h];let t=a.x*i|0,n=a.y*i|0;t<0?t=0:t>=c.cols&&(t=c.cols-1),n<0?n=0:n>=c.rows&&(n=c.rows-1);const r=j(c,t,n);c.next[h]=c.heads[r],c.heads[r]=h}const u=m.COHESION_RADIUS,d=u*u;for(let h=0;h<e.length;h++){const a=e[h];let t=a.x*i|0,n=a.y*i|0;t<0?t=0:t>=c.cols&&(t=c.cols-1),n<0?n=0:n>=c.rows&&(n=c.rows-1);const r=t>0?t-1:t,s=t+1<c.cols?t+1:t,u=n>0?n-1:n,m=n+1<c.rows?n+1:n;for(let i=u;i<=m;i++)for(let t=r;t<=s;t++){let n=c.heads[j(c,t,i)];for(;-1!==n;){if(n>h){const t=e[n],r=t.x-a.x,s=t.y-a.y,c=r*r+s*s;if(c>0&&c<d){l[h]++,l[n]++;P(a,t,r,s,Math.sqrt(c),o),_(a,t,o)}}n=c.next[n]}}}for(let h=0;h<e.length;h++){const a=e[h];D(a,t,l[h],o),a.heat=y(a.heat)}A(e,a,t)}function O(e,a){const t=e.heat*e.heat*m.BUOYANCY;e.vy+=(m.GRAVITY-t)*a}function k(e,a){const t=Math.pow(m.FRICTION,a);e.vx*=t,e.vy*=t}function L(e,a){e.x+=e.vx*a,e.y+=e.vy*a}function H(e,a,t){const n=e.x-a.x,r=e.y-a.y,l=n*n+r*r,s=m.MOUSE_HEAT_RADIUS;if(l<s*s){const a=1-Math.sqrt(l)*(1/s);e.heat+=2*m.HEAT_RATE*a*t}}function P(e,a,t,n,r,l){const s=m.COHESION_STRENGTH*(1-r*(1/m.COHESION_RADIUS)),c=1/r,o=t*c*s*l,i=n*c*s*l;e.vx+=o,e.vy+=i,a.vx-=o,a.vy-=i}function _(e,a,t){const n=(e.heat-a.heat)*m.HEAT_CONDUCTION*t;e.heat-=n,a.heat+=n}function D(e,a,t,n){const r=a-e.y;if(r<m.HEAT_SOURCE_DISTANCE){const a=1-r*(1/m.HEAT_SOURCE_DISTANCE);return void(e.heat+=m.HEAT_RATE*a*n)}const l=1-(t<8?t:8)/8;e.heat-=m.COOL_RATE*(.2+.8*l)*n}function U(e,a,t,n,r){const l=function(e,a,t,n){const r=a.current;return r&&r.width===t&&r.height===n||(a.current=e.createImageData(t,n)),a.current}(e,n,a.width,a.height);!function(e,a,t,n,r){const l=v.PIXEL_SIZE,s=v.THRESHOLD,c=v.PARTICLE_RADIUS*v.PARTICLE_RADIUS,o=new Uint32Array(e.data.buffer),i=C(0,0,0,255);o.fill(i);const u=t;for(let d=0;d<n;d+=l)for(let e=0;e<t;e+=l){let t=0,i=0;for(let n=0;n<a.length;n++){const r=a[n],l=e-r.x,s=d-r.y,o=c/(l*l+s*s+1);t+=o,i+=o*r.heat}if(t<=s)continue;const h=i/t,m=r[h<=0?0:h>=1?255:255*h|0];for(let a=0;a<l;a++){const t=d+a;if(t>=n)break;let r=t*u+e;const s=Math.min(e+l,u);for(let a=e;a<s;a++)o[r++]=m}}}(l,t,a.width,a.height,r),e.putImageData(l,0,0)}function X(){const e=(0,n.useRef)(null),a=(0,n.useRef)(null),t=(0,n.useRef)(null),r=(0,n.useRef)([]),v=(0,n.useRef)(null),y=(0,n.useRef)(new Uint16Array(0)),b=(0,n.useRef)(null),S=(0,n.useRef)(null),A=(0,n.useRef)({w:1,h:1}),[I,C]=(0,n.useState)(i.KEXP),j=(0,n.useMemo)((()=>{const e=new c.D(u[i.KEXP].url,!0);return e.preload="auto",e}),[]),O=(0,n.useMemo)((()=>new c.D(l,!1)),[]),[k,L]=(0,n.useState)(!1),H=(0,n.useRef)(!1),P=(0,n.useRef)({x:0,y:0}),_=(0,n.useMemo)((()=>function(e){if(e<=0)return 0;const a=w.STEPS-1;let t=1,n=1/0;const r=Math.log(e);for(let l=1;l<=a;l++){const e=T(l),a=Math.abs(Math.log(e)-r);a<n&&(n=a,t=l)}return t}(w.DEFAULT)),[]),[D,X]=(0,n.useState)(_),F=(0,n.useRef)(w.DEFAULT);(0,n.useEffect)((()=>{F.current=T(D)}),[D]);const[K,W]=(0,n.useState)(!1),Y=(0,n.useCallback)((()=>W((e=>!e))),[]),[G,q]=(0,n.useState)(1);(0,n.useEffect)((()=>{j.volume=G}),[G,j]);const[z,B]=(0,n.useState)(null),[V,Z]=(0,n.useState)(!0),J=(0,n.useRef)(null),Q=(0,n.useRef)(null),$=(0,n.useRef)(null),ee=(0,n.useRef)(!0);(0,n.useEffect)((()=>{if(ee.current)return void(ee.current=!1);const e=u[I],a=j.isPlaying();if(a&&j.pause(),j.src=e.url,j.load(),a){const e=()=>{j.play().catch((()=>{})),j.removeEventListener("canplaythrough",e)};j.addEventListener("canplaythrough",e,{once:!0})}}),[I,j]),(0,n.useEffect)((()=>{if(!k||I!==i.KEXP)return void B(null);const e=async()=>{try{var e;const a=await fetch("https://api.kexp.org/v2/plays/?limit=5"),t=null===(e=(await a.json()).results)||void 0===e?void 0:e.find((e=>"trackplay"===e.play_type));if(t){const e={song:(t.song||"unknown track").toLowerCase(),artist:(t.artist||"unknown artist").toLowerCase(),album:(t.album||"unknown album").toLowerCase(),isAirbreak:!1};console.log("[KEXP] Updating now playing:",e),B(e)}else console.log("[KEXP] No trackplay found, showing airbreak message"),B({song:"station break",artist:"",album:"",isAirbreak:!0})}catch(a){console.log("[KEXP] Fetch error:",a)}};e();const a=setInterval(e,1e4);return()=>clearInterval(a)}),[k,I]),(0,n.useEffect)((()=>{const e=()=>{[J.current,Q.current,$.current].forEach((e=>{if(e){e.scrollWidth>e.clientWidth?e.classList.add("overflowing"):e.classList.remove("overflowing")}}))};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[z,V]);const ae=(0,n.useRef)(h),te=(0,n.useRef)(d),[ne,re]=(0,n.useState)(h),[le,se]=(0,n.useState)(d),ce=(0,n.useRef)(R(h,d));(0,n.useEffect)((()=>{ae.current=ne,te.current=le,ce.current=R(ne,le)}),[ne,le,k]),(0,n.useEffect)((()=>{const t=e.current;if(!t)return;const n=window.innerWidth,r=window.innerHeight;A.current={w:n,h:r},t.width=n,t.height=r,a.current=t.getContext("2d"),v.current=null}),[]);const oe=(0,n.useCallback)((()=>{const{w:e,h:a}=A.current;null===b.current&&(b.current=function(e,a){const t=f.WIDTH*f.HEIGHT,n=e*a,r=f.PARTICLES/t,l=Math.round(n*r);return Math.max(200,Math.min(2e3,l))}(e,a));const t=b.current;r.current=function(e,a,t){const n=[],r=Math.floor(t/p.COUNT);for(let l=0;l<p.COUNT;l++){const t=Math.random()*e,l=Math.random()<p.TOP_HALF_PROB?Math.random()*a*.5:.5*a+Math.random()*a*.5,s=Math.random();for(let e=0;e<r;e++){const e=N(p.RADIUS);n.push({x:t+e.x,y:l+e.y,vx:0,vy:0,heat:s})}}for(;n.length<t;)n.push({x:Math.random()*e,y:Math.random()*a,vx:0,vy:0,heat:0});return n}(e,a,t),y.current=new Uint16Array(t),function(e,a,t,n,r){const l=Math.max(1,Math.ceil(a/r)),s=Math.max(1,Math.ceil(t/r)),c=l*s,o=e.current;o&&o.cols===l&&o.rows===s&&o.cellSize===r&&o.next.length===n&&o.heads.length===c||(e.current={cellSize:r,cols:l,rows:s,heads:new Int32Array(c),next:new Int32Array(n)})}(S,e,a,t,m.COHESION_RADIUS)}),[]),ie=(0,n.useCallback)((()=>{var e;!function(e){try{if(!Number.isFinite(e)||e<0)return;localStorage.setItem(E,String(e))}catch(a){}}(null!==(e=j.currentTime)&&void 0!==e?e:0)}),[j]);(0,n.useEffect)((()=>{if(!k)return;const e=window.setInterval((()=>ie()),1e3),a=()=>ie(),t=()=>{"hidden"===document.visibilityState&&ie()};return window.addEventListener("pagehide",a),document.addEventListener("visibilitychange",t),()=>{window.clearInterval(e),window.removeEventListener("pagehide",a),document.removeEventListener("visibilitychange",t)}}),[k,ie]),(0,n.useEffect)((()=>()=>{ie(),j.pause(),j.volume=0,j.reset(),O.pause(),O.volume=0,O.reset()}),[j,O,ie]);const ue=(0,n.useCallback)((()=>{const e=S.current;if(!e)return;const{w:a,h:t}=A.current;M(r.current,a,t,H.current,P.current,y.current,F.current,e)}),[]),de=(0,n.useCallback)((()=>{const t=e.current,n=a.current;t&&n&&U(n,t,r.current,v,ce.current)}),[]),he=(0,n.useRef)({last:0,acc:0}),me=(0,n.useCallback)((e=>{const a=he.current;0===a.last&&(a.last=e);const n=e-a.last;a.last=e,a.acc+=Math.min(250,Math.max(0,n));let r=0;for(;a.acc>=x&&r<g;)ue(),a.acc-=x,r++;a.acc>=x&&(a.acc=0),de(),t.current=requestAnimationFrame(me)}),[de,ue]);(0,n.useEffect)((()=>{const a=e.current;if(!a)return;const t=e=>{const t=a.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}},n=e=>{H.current=!0,P.current=t(e)},r=e=>{P.current=t(e)},l=()=>{H.current=!1};return a.addEventListener("pointerdown",n),window.addEventListener("pointermove",r),window.addEventListener("pointerup",l),window.addEventListener("pointercancel",l),()=>{a.removeEventListener("pointerdown",n),window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",l),window.removeEventListener("pointercancel",l)}}),[]);const ve=(0,n.useCallback)((()=>{try{O.volume=1,O.currentTime=0,O.reset(),O.play()}catch(e){}}),[O]),pe=(0,n.useCallback)((()=>{const e=function(){try{const e=localStorage.getItem(E);if(!e)return 0;const a=Number(e);return Number.isFinite(a)&&a>=0?a:0}catch(e){return 0}}();try{const a=j.duration;"number"===typeof a&&Number.isFinite(a)&&a>0?j.currentTime=e%a:j.currentTime=e}catch(a){}}),[j]),fe=(0,n.useCallback)((async()=>{if(ve(),k||(L(!0),oe(),he.current={last:0,acc:0},requestAnimationFrame((()=>de())),t.current=requestAnimationFrame(me)),I!==i.KEXP&&pe(),j.volume=1,j.readyState<3){j.load();const e=async()=>{try{await j.play()}catch(a){}j.removeEventListener("canplaythrough",e)};j.addEventListener("canplaythrough",e,{once:!0})}else try{await j.play()}catch(e){}}),[me,I,de,j,k,oe,ve,pe]),we=(0,n.useMemo)((()=>({w:window.innerWidth,h:window.innerHeight})),[]),xe=w.STEPS-1;return(0,o.jsxs)("div",{className:"lava-lamp-container",children:[(0,o.jsx)("canvas",{ref:e,className:"lava-lamp-canvas",width:we.w,height:we.h}),z&&(0,o.jsxs)("div",{className:"lava-lamp-now-playing ".concat(V?"expanded":"collapsed"),children:[(0,o.jsx)("button",{type:"button",className:"lava-lamp-now-playing-toggle",onClick:()=>Z(!V),"aria-label":V?"Collapse now playing":"Expand now playing",children:V?"\u203a":"\u2039"}),(0,o.jsxs)("div",{className:"lava-lamp-now-playing-content",children:[(0,o.jsxs)("div",{className:"lava-lamp-now-playing-header",children:[(0,o.jsx)("div",{className:"lava-lamp-now-playing-label",children:"kexp"}),!z.isAirbreak&&(0,o.jsxs)("div",{className:"lava-lamp-soundwave",children:[(0,o.jsx)("div",{className:"lava-lamp-soundwave-bar"}),(0,o.jsx)("div",{className:"lava-lamp-soundwave-bar"}),(0,o.jsx)("div",{className:"lava-lamp-soundwave-bar"}),(0,o.jsx)("div",{className:"lava-lamp-soundwave-bar"})]})]}),(0,o.jsx)("div",{ref:J,className:"lava-lamp-now-playing-song",children:z.song}),!z.isAirbreak&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{ref:Q,className:"lava-lamp-now-playing-artist",children:z.artist}),(0,o.jsx)("div",{ref:$,className:"lava-lamp-now-playing-album",children:z.album})]})]})]}),k?(0,o.jsxs)("div",{className:"lava-lamp-controls",children:[(0,o.jsx)("button",{type:"button",className:"lava-lamp-menu-toggle",onClick:Y,"aria-label":K?"Hide menu":"Show menu","aria-pressed":K,children:K?"\u2715":"\u2630"}),K&&(0,o.jsxs)("div",{className:"lava-lamp-menu",children:[(0,o.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,o.jsx)("div",{className:"lava-lamp-control-header",children:(0,o.jsxs)("div",{className:"lava-lamp-control-title",children:["speed: ",D]})}),(0,o.jsx)("div",{className:"lava-lamp-slider-wrap",children:(0,o.jsx)("input",{className:"lava-lamp-slider",type:"range",min:0,max:xe,step:1,value:D,onChange:e=>{return X((a=Number(e.target.value),n=xe,a<(t=0)?t:a>n?n:a));var a,t,n},"aria-label":"Simulation speed"})})]}),(0,o.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,o.jsx)("div",{className:"lava-lamp-control-header",children:(0,o.jsxs)("div",{className:"lava-lamp-control-title",children:["volume: ",Math.round(100*G),"%"]})}),(0,o.jsx)("div",{className:"lava-lamp-slider-wrap",children:(0,o.jsx)("input",{className:"lava-lamp-slider",type:"range",min:0,max:1,step:.01,value:G,onChange:e=>q(Number(e.target.value)),"aria-label":"Music volume"})})]}),(0,o.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,o.jsx)("div",{className:"lava-lamp-control-header",children:(0,o.jsx)("div",{className:"lava-lamp-control-title",children:"audio source"})}),(0,o.jsx)("div",{className:"lava-lamp-slider-wrap",children:(0,o.jsx)("select",{className:"lava-lamp-slider",value:I,onChange:e=>C(e.target.value),"aria-label":"Audio source",children:Object.entries(u).map((e=>{let[a,t]=e;return(0,o.jsx)("option",{value:a,children:t.label},a)}))})})]}),(0,o.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,o.jsx)("div",{className:"lava-lamp-control-header",children:(0,o.jsx)("div",{className:"lava-lamp-control-title",children:"lava colors"})}),(0,o.jsxs)("div",{className:"lava-lamp-color-row",children:[(0,o.jsxs)("label",{className:"lava-lamp-color-label",children:["hot",(0,o.jsx)("input",{className:"lava-lamp-color-input",type:"color",value:le,onChange:e=>se(e.target.value),"aria-label":"Lava high color"})]}),(0,o.jsxs)("label",{className:"lava-lamp-color-label",children:["cool",(0,o.jsx)("input",{className:"lava-lamp-color-input",type:"color",value:ne,onChange:e=>re(e.target.value),"aria-label":"Lava low color"})]}),(0,o.jsx)("button",{type:"button",className:"lava-lamp-color-reset",onClick:()=>{re(h),se(d)},children:"reset"})]})]}),(0,o.jsx)("div",{className:"lava-lamp-control-block",children:(0,o.jsxs)("button",{type:"button",className:"lava-lamp-power-off",onClick:()=>window.location.reload(),"aria-label":"Power off",children:[(0,o.jsx)("img",{src:s,alt:"Power off",className:"lava-lamp-power-off-icon"}),(0,o.jsx)("span",{children:"power off"})]})})]})]}):(0,o.jsx)("div",{className:"lava-lamp-start-overlay",children:(0,o.jsx)("button",{type:"button",className:"lava-lamp-start",onClick:fe,"aria-label":"Start lava lamp radio",children:(0,o.jsx)("img",{src:s,alt:"Power",className:"lava-lamp-start-icon"})})})]})}},7375:(e,a,t)=>{t.d(a,{D:()=>n});class n extends Audio{constructor(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e),this.isPlayingSrc=e=>{var a;return(null===(a=this.src)||void 0===a?void 0:a.includes(e))&&this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2},this.isPlaying=()=>this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2,this.timeLeft=()=>this.duration-this.currentTime,this.reset=()=>{this.pause(),this.currentTime=0},this.loop=a}}}}]);
//# sourceMappingURL=948.59fceeca.chunk.js.map