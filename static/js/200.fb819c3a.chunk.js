"use strict";(self.webpackChunkpersonalsite=self.webpackChunkpersonalsite||[]).push([[200],{202:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j,stepSimulationOnePairPass:()=>b});var a=n(5043);const r=n.p+"static/media/guitar.7c3177d2baeb887643cc.mp3",s=n.p+"static/media/click.1c87678ffc4ae6835e44.mp3";var l=n(7375),c=n(579);const o="#ffdd00",i="#ff5500",u={GRAVITY:.01,BUOYANCY:.04,FRICTION:.98,HEAT_RATE:.005,COOL_RATE:.0017,HEAT_CONDUCTION:.002,HEAT_SOURCE_DISTANCE:45,COHESION_RADIUS:25,COHESION_STRENGTH:.0035,MOUSE_HEAT_RADIUS:100},h={PARTICLE_RADIUS:10,PIXEL_SIZE:6,THRESHOLD:.8},d={COUNT:15,RADIUS:50,TOP_HALF_PROB:.3},m={WIDTH:1920,HEIGHT:1080,PARTICLES:1200},v={MIN:0,MAX:5,DEFAULT:.25,STEPS:10},f=1e3/60,p=4,E="lavaLamp.musicTimeSeconds";function x(e){return e<0?0:e>1?1:e}function w(e,t,n){const a=e+(t-e)*n;return a<0?0:a>255?255:Math.round(a)}function S(e){const t=Math.random()*Math.PI*2,n=Math.random()*e;return{x:Math.cos(t)*n,y:Math.sin(t)*n}}function T(e,t,n){e.x<0?(e.x=0,e.vx*=-.5):e.x>t&&(e.x=t,e.vx*=-.5),e.y<0?(e.y=0,e.vy*=-.5):e.y>n&&(e.y=n,e.vy*=-.5)}function g(e,t,n){for(let a=0;a<e.length;a++)T(e[a],t,n)}function A(e){if(e<=0)return 0;const t=v.STEPS;if(e>=t)return v.MAX;const n=e/t,a=.25/v.MAX,r=Math.log(a),s=Math.log(v.MAX);return Math.exp(function(e,t,n){return e+(t-e)*n}(r,s,n))}function I(e){const t=e.trim().replace("#","");if(3===t.length){return{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16)}}if(6===t.length){return{r:parseInt(t.slice(0,2),16),g:parseInt(t.slice(2,4),16),b:parseInt(t.slice(4,6),16)}}return{r:255,g:221,b:0}}function y(e,t,n,a){return a<<24|n<<16|t<<8|e}function N(e,t){const n=I(e),a=I(t),r=new Uint32Array(256);for(let s=0;s<256;s++){const e=s/255,t=w(n.r,a.r,e),l=w(n.g,a.g,e),c=w(n.b,a.b,e);r[s]=y(t,l,c,255)}return r}function R(e,t,n){return n*e.cols+t}function b(e,t,n,a,r,s,l,c){const o=Math.max(0,Math.min(4,l));for(let u=0;u<e.length;u++){const l=e[u];C(l,o),M(l,o),O(l,o),a&&H(l,r,o),s[u]=0,T(l,t,n)}if(0===o){for(let t=0;t<e.length;t++)e[t].heat=x(e[t].heat);return void g(e,t,n)}c.heads.fill(-1);const i=1/c.cellSize;for(let u=0;u<e.length;u++){const t=e[u];let n=t.x*i|0,a=t.y*i|0;n<0?n=0:n>=c.cols&&(n=c.cols-1),a<0?a=0:a>=c.rows&&(a=c.rows-1);const r=R(c,n,a);c.next[u]=c.heads[r],c.heads[r]=u}const h=u.COHESION_RADIUS,d=h*h;for(let u=0;u<e.length;u++){const t=e[u];let n=t.x*i|0,a=t.y*i|0;n<0?n=0:n>=c.cols&&(n=c.cols-1),a<0?a=0:a>=c.rows&&(a=c.rows-1);const r=n>0?n-1:n,l=n+1<c.cols?n+1:n,h=a>0?a-1:a,m=a+1<c.rows?a+1:a;for(let i=h;i<=m;i++)for(let n=r;n<=l;n++){let a=c.heads[R(c,n,i)];for(;-1!==a;){if(a>u){const n=e[a],r=n.x-t.x,l=n.y-t.y,c=r*r+l*l;if(c>0&&c<d){s[u]++,s[a]++;L(t,n,r,l,Math.sqrt(c),o),_(t,n,o)}}a=c.next[a]}}}for(let u=0;u<e.length;u++){const t=e[u];U(t,n,s[u],o),t.heat=x(t.heat)}g(e,t,n)}function C(e,t){const n=e.heat*e.heat*u.BUOYANCY;e.vy+=(u.GRAVITY-n)*t}function M(e,t){const n=Math.pow(u.FRICTION,t);e.vx*=n,e.vy*=n}function O(e,t){e.x+=e.vx*t,e.y+=e.vy*t}function H(e,t,n){const a=e.x-t.x,r=e.y-t.y,s=a*a+r*r,l=u.MOUSE_HEAT_RADIUS;if(s<l*l){const t=1-Math.sqrt(s)*(1/l);e.heat+=2*u.HEAT_RATE*t*n}}function L(e,t,n,a,r,s){const l=u.COHESION_STRENGTH*(1-r*(1/u.COHESION_RADIUS)),c=1/r,o=n*c*l*s,i=a*c*l*s;e.vx+=o,e.vy+=i,t.vx-=o,t.vy-=i}function _(e,t,n){const a=(e.heat-t.heat)*u.HEAT_CONDUCTION*n;e.heat-=a,t.heat+=a}function U(e,t,n,a){const r=t-e.y;if(r<u.HEAT_SOURCE_DISTANCE){const t=1-r*(1/u.HEAT_SOURCE_DISTANCE);return void(e.heat+=u.HEAT_RATE*t*a)}const s=1-(n<8?n:8)/8;e.heat-=u.COOL_RATE*(.2+.8*s)*a}function D(e,t,n,a,r){const s=function(e,t,n,a){const r=t.current;return r&&r.width===n&&r.height===a||(t.current=e.createImageData(n,a)),t.current}(e,a,t.width,t.height);!function(e,t,n,a,r){const s=h.PIXEL_SIZE,l=h.THRESHOLD,c=h.PARTICLE_RADIUS*h.PARTICLE_RADIUS,o=new Uint32Array(e.data.buffer),i=y(0,0,0,255);o.fill(i);const u=n;for(let h=0;h<a;h+=s)for(let e=0;e<n;e+=s){let n=0,i=0;for(let a=0;a<t.length;a++){const r=t[a],s=e-r.x,l=h-r.y,o=c/(s*s+l*l+1);n+=o,i+=o*r.heat}if(n<=l)continue;const d=i/n,m=r[d<=0?0:d>=1?255:255*d|0];for(let t=0;t<s;t++){const n=h+t;if(n>=a)break;let r=n*u+e;const l=Math.min(e+s,u);for(let t=e;t<l;t++)o[r++]=m}}}(s,n,t.width,t.height,r),e.putImageData(s,0,0)}function j(){const e=(0,a.useRef)(null),t=(0,a.useRef)(null),n=(0,a.useRef)(null),h=(0,a.useRef)([]),x=(0,a.useRef)(null),w=(0,a.useRef)(new Uint16Array(0)),T=(0,a.useRef)(null),g=(0,a.useRef)(null),I=(0,a.useRef)({w:1,h:1}),y=(0,a.useMemo)((()=>new l.D(r,!0)),[]),R=(0,a.useMemo)((()=>new l.D(s,!1)),[]),[C,M]=(0,a.useState)(!1),O=(0,a.useRef)(!1),H=(0,a.useRef)({x:0,y:0}),L=(0,a.useMemo)((()=>function(e){if(e<=0)return 0;const t=v.STEPS-1;let n=1,a=1/0;const r=Math.log(e);for(let s=1;s<=t;s++){const e=A(s),t=Math.abs(Math.log(e)-r);t<a&&(a=t,n=s)}return n}(v.DEFAULT)),[]),[_,U]=(0,a.useState)(L),j=(0,a.useRef)(v.DEFAULT);(0,a.useEffect)((()=>{j.current=A(_)}),[_]);const[k,P]=(0,a.useState)(!1),F=(0,a.useCallback)((()=>P((e=>!e))),[]),[X,Y]=(0,a.useState)(1);(0,a.useEffect)((()=>{y.volume=X}),[X,y]);const G=(0,a.useRef)(i),q=(0,a.useRef)(o),[B,W]=(0,a.useState)(i),[z,V]=(0,a.useState)(o),Z=(0,a.useRef)(N(i,o));(0,a.useEffect)((()=>{G.current=B,q.current=z,Z.current=N(B,z)}),[B,z,C]),(0,a.useEffect)((()=>{const n=e.current;if(!n)return;const a=window.innerWidth,r=window.innerHeight;I.current={w:a,h:r},n.width=a,n.height=r,t.current=n.getContext("2d"),x.current=null}),[]);const J=(0,a.useCallback)((()=>{const{w:e,h:t}=I.current;null===T.current&&(T.current=function(e,t){const n=m.WIDTH*m.HEIGHT,a=e*t,r=m.PARTICLES/n,s=Math.round(a*r);return Math.max(200,Math.min(2e3,s))}(e,t));const n=T.current;h.current=function(e,t,n){const a=[],r=Math.floor(n/d.COUNT);for(let s=0;s<d.COUNT;s++){const n=Math.random()*e,s=Math.random()<d.TOP_HALF_PROB?Math.random()*t*.5:.5*t+Math.random()*t*.5,l=Math.random();for(let e=0;e<r;e++){const e=S(d.RADIUS);a.push({x:n+e.x,y:s+e.y,vx:0,vy:0,heat:l})}}for(;a.length<n;)a.push({x:Math.random()*e,y:Math.random()*t,vx:0,vy:0,heat:0});return a}(e,t,n),w.current=new Uint16Array(n),function(e,t,n,a,r){const s=Math.max(1,Math.ceil(t/r)),l=Math.max(1,Math.ceil(n/r)),c=s*l,o=e.current;o&&o.cols===s&&o.rows===l&&o.cellSize===r&&o.next.length===a&&o.heads.length===c||(e.current={cellSize:r,cols:s,rows:l,heads:new Int32Array(c),next:new Int32Array(a)})}(g,e,t,n,u.COHESION_RADIUS)}),[]),K=(0,a.useCallback)((()=>{var e;!function(e){try{if(!Number.isFinite(e)||e<0)return;localStorage.setItem(E,String(e))}catch(t){}}(null!==(e=y.currentTime)&&void 0!==e?e:0)}),[y]);(0,a.useEffect)((()=>{if(!C)return;const e=window.setInterval((()=>K()),1e3),t=()=>K(),n=()=>{"hidden"===document.visibilityState&&K()};return window.addEventListener("pagehide",t),document.addEventListener("visibilitychange",n),()=>{window.clearInterval(e),window.removeEventListener("pagehide",t),document.removeEventListener("visibilitychange",n)}}),[C,K]),(0,a.useEffect)((()=>()=>{K(),y.pause(),y.volume=0,y.reset(),R.pause(),R.volume=0,R.reset()}),[y,R,K]);const Q=(0,a.useCallback)((()=>{const e=g.current;if(!e)return;const{w:t,h:n}=I.current;b(h.current,t,n,O.current,H.current,w.current,j.current,e)}),[]),$=(0,a.useCallback)((()=>{const n=e.current,a=t.current;n&&a&&D(a,n,h.current,x,Z.current)}),[]),ee=(0,a.useRef)({last:0,acc:0}),te=(0,a.useCallback)((e=>{const t=ee.current;0===t.last&&(t.last=e);const a=e-t.last;t.last=e,t.acc+=Math.min(250,Math.max(0,a));let r=0;for(;t.acc>=f&&r<p;)Q(),t.acc-=f,r++;t.acc>=f&&(t.acc=0),$(),n.current=requestAnimationFrame(te)}),[$,Q]);(0,a.useEffect)((()=>{const t=e.current;if(!t)return;const n=e=>{const n=t.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}},a=e=>{O.current=!0,H.current=n(e)},r=e=>{H.current=n(e)},s=()=>{O.current=!1};return t.addEventListener("pointerdown",a),window.addEventListener("pointermove",r),window.addEventListener("pointerup",s),window.addEventListener("pointercancel",s),()=>{t.removeEventListener("pointerdown",a),window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",s),window.removeEventListener("pointercancel",s)}}),[]);const ne=(0,a.useCallback)((()=>{try{R.volume=1,R.currentTime=0,R.reset(),R.play()}catch(e){}}),[R]),ae=(0,a.useCallback)((()=>{const e=function(){try{const e=localStorage.getItem(E);if(!e)return 0;const t=Number(e);return Number.isFinite(t)&&t>=0?t:0}catch(e){return 0}}();try{const t=y.duration;"number"===typeof t&&Number.isFinite(t)&&t>0?y.currentTime=e%t:y.currentTime=e}catch(t){}}),[y]),re=(0,a.useCallback)((()=>{ne(),C||(M(!0),J(),ee.current={last:0,acc:0},requestAnimationFrame((()=>$())),n.current=requestAnimationFrame(te)),ae(),y.volume=1,y.play()}),[te,$,y,C,J,ne,ae]),se=(0,a.useMemo)((()=>({w:window.innerWidth,h:window.innerHeight})),[]),le=v.STEPS-1;return(0,c.jsxs)("div",{className:"lava-lamp-container",children:[(0,c.jsx)("canvas",{ref:e,className:"lava-lamp-canvas",width:se.w,height:se.h}),C?(0,c.jsxs)("div",{className:"lava-lamp-controls",children:[(0,c.jsx)("button",{type:"button",className:"lava-lamp-menu-toggle",onClick:F,"aria-label":k?"Hide menu":"Show menu","aria-pressed":k,children:k?"\u2715":"\u2630"}),k&&(0,c.jsxs)("div",{className:"lava-lamp-menu",children:[(0,c.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,c.jsx)("div",{className:"lava-lamp-control-header",children:(0,c.jsxs)("div",{className:"lava-lamp-control-title",children:["speed: ",_]})}),(0,c.jsx)("div",{className:"lava-lamp-slider-wrap",children:(0,c.jsx)("input",{className:"lava-lamp-slider",type:"range",min:0,max:le,step:1,value:_,onChange:e=>{return U((t=Number(e.target.value),a=le,t<(n=0)?n:t>a?a:t));var t,n,a},"aria-label":"Simulation speed"})})]}),(0,c.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,c.jsx)("div",{className:"lava-lamp-control-header",children:(0,c.jsxs)("div",{className:"lava-lamp-control-title",children:["volume: ",Math.round(100*X),"%"]})}),(0,c.jsx)("div",{className:"lava-lamp-slider-wrap",children:(0,c.jsx)("input",{className:"lava-lamp-slider",type:"range",min:0,max:1,step:.01,value:X,onChange:e=>Y(Number(e.target.value)),"aria-label":"Music volume"})})]}),(0,c.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,c.jsx)("div",{className:"lava-lamp-control-header",children:(0,c.jsx)("div",{className:"lava-lamp-control-title",children:"lava colors"})}),(0,c.jsxs)("div",{className:"lava-lamp-color-row",children:[(0,c.jsxs)("label",{className:"lava-lamp-color-label",children:["hot",(0,c.jsx)("input",{className:"lava-lamp-color-input",type:"color",value:z,onChange:e=>V(e.target.value),"aria-label":"Lava high color"})]}),(0,c.jsxs)("label",{className:"lava-lamp-color-label",children:["cool",(0,c.jsx)("input",{className:"lava-lamp-color-input",type:"color",value:B,onChange:e=>W(e.target.value),"aria-label":"Lava low color"})]}),(0,c.jsx)("button",{type:"button",className:"lava-lamp-color-reset",onClick:()=>{W(i),V(o)},children:"reset"})]})]})]})]}):(0,c.jsx)("div",{className:"lava-lamp-start-overlay",children:(0,c.jsx)("button",{type:"button",className:"lava-lamp-start",onClick:re,"aria-label":"Start lava lamp",children:"START"})})]})}},7375:(e,t,n)=>{n.d(t,{D:()=>a});class a extends Audio{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e),this.isPlayingSrc=e=>{var t;return(null===(t=this.src)||void 0===t?void 0:t.includes(e))&&this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2},this.isPlaying=()=>this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2,this.timeLeft=()=>this.duration-this.currentTime,this.reset=()=>{this.pause(),this.currentTime=0},this.loop=t}}}}]);
//# sourceMappingURL=200.fb819c3a.chunk.js.map