"use strict";(self.webpackChunkpersonalsite=self.webpackChunkpersonalsite||[]).push([[673],{9899:(e,r,t)=>{t.r(r),t.d(r,{default:()=>N});var n=t(2782),c=t(5043),o=t(2432);const s=t.p+"static/media/eye.dec3834250fe27c81ae7b742bbba007f.svg";const l=t.p+"static/media/eye-crossed.abb67d156b26b0605d33d1bb10209b99.svg";var u=t(579);const a=()=>{const{isColorBlindMode:e,toggleColorBlindMode:r}=(0,o.Z)();return(0,u.jsx)("button",{className:"colorblind-toggle ".concat(e?"colorblind-mode":"regular-mode"),onClick:r,"aria-label":e?"Switch to color mode":"Switch to colorblind-friendly mode",title:e?"Color mode":"Colorblind-friendly mode",children:(0,u.jsx)("img",{src:e?l:s,alt:e?"Eye crossed icon":"Eye icon",className:"colorblind-toggle-icon"})})};var i=t(7375);const d=e=>{let{setDirection:r}=e;const[t,o]=(0,c.useState)();return(0,c.useEffect)((()=>{document.addEventListener("touchmove",(e=>{e.preventDefault()}),{passive:!1})}),[]),(0,u.jsx)(n.Ay,{className:"joystick",onChange:e=>{t!==e.direction&&e.direction!==n.OP.Center&&(o(e.direction),r(e.direction))}})},f=t.p+"static/media/game_over.21c74c34f50a8ecedde0.mp3",h=t.p+"static/media/groovy_click.5cb6eae90670166005af.mp3",m=t.p+"static/media/the_gathering.2d97c4755109d9278151.mp3",w=35,b=20,g=6,p=125,v=5,y=22,k=1,R=w*y,C=b*y,x=(e,r)=>e*w+r,A=(e,r)=>e<0||r<0||e>=b||r>=w,E=e=>(e+2)%4,j=function(e,r,t,n){let c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return((e,r,t,n)=>Math.max(Math.abs(e-t),Math.abs(r-n)))(e,r,t,n)>=c+1},M=(e,r,t)=>[[e-1,r],[e,r+1],[e+1,r],[e,r-1]][t],S={w:"ArrowUp",W:"ArrowUp",[n.OP.Top]:"ArrowUp",s:"ArrowDown",S:"ArrowDown",[n.OP.Bottom]:"ArrowDown",a:"ArrowLeft",A:"ArrowLeft",[n.OP.Left]:"ArrowLeft",d:"ArrowRight",D:"ArrowRight",[n.OP.Right]:"ArrowRight"},L={ArrowUp:0,ArrowDown:2,ArrowLeft:3,ArrowRight:k},D=function(e,r,t,n){let c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y;e.fillStyle=n,e.fillRect(t*c,r*c,c,c)},O=function(e,r,t){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y;return e.clearRect(t*n,r*n,n,n)};function N(){const{isColorBlindMode:e}=(0,o.Z)(),[r,t]=(0,c.useState)(0),[n,s]=(0,c.useState)(!1),[l,N]=(0,c.useState)(0),[T,P]=(0,c.useState)("ArrowRight"),[F,K]=(0,c.useState)(0),[U,z]=(0,c.useState)(0),B=(0,c.useRef)(null),I=(0,c.useRef)(p),q=(0,c.useRef)(!1),W=(0,c.useRef)(k),_=(0,c.useRef)(k),G=(0,c.useRef)([]),V=(0,c.useRef)(new Set),Z=(0,c.useRef)({row:-1,col:-1}),H=(0,c.useRef)(!1),J=(0,c.useRef)(!1),Q=(0,c.useRef)([]),X=(0,c.useRef)(new Set),Y=(0,c.useRef)(new Uint8Array(b*w)),$=(0,c.useRef)([]),ee=(0,c.useRef)(),re=(0,c.useMemo)((()=>new i.D(h)),[]),te=(0,c.useMemo)((()=>new i.D(f)),[]),ne=(0,c.useMemo)((()=>new i.D(m,!0)),[]),ce=F<=768,oe=(0,c.useCallback)(((e,r,t)=>{for(let n=e-1;n<=e+1;n++)for(let e=r-1;e<=r+1;e++){if(n<0||e<0||n>=b||e>=w)continue;const r=x(n,e),c=Y.current[r]+t;Y.current[r]=c<0?0:c}}),[]),se=(0,c.useRef)(null),le=(0,c.useRef)(null),ue=(0,c.useRef)(null),ae=(0,c.useRef)(null),ie=(0,c.useRef)(null),de=(0,c.useMemo)((()=>e?{grid:"rgba(255,255,255,0.3)",obstacle:"rgba(255,255,255,0.3)",food:"#3cff00",body:"#ffffff",head:"#ffffff",headKO:"#ff4d4f"}:{grid:"rgba(233,233,242,0.55)",obstacle:"rgba(28, 28, 28, 0.9)",food:"#3cff00",body:"#ffffff",head:"#ffffff",headKO:"#ff4d4f"}),[e]),fe=(0,c.useCallback)((function(e,r,t){let{alpha:n}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{alpha:!0};const c=Math.max(1,window.devicePixelRatio||1);(e.width!==r*c||e.height!==t*c)&&(e.width=r*c,e.height=t*c,e.style.width="".concat(r,"px"),e.style.height="".concat(t,"px"));const o=e.getContext("2d",{alpha:n});return o.setTransform(c,0,0,c,0,0),o}),[]),he=(0,c.useCallback)((e=>{e.save(),e.strokeStyle=de.grid,e.setLineDash([2,3]),e.lineWidth=1,e.beginPath();for(let r=0;r<=b;r++){const t=r*y+.5;e.moveTo(0,t),e.lineTo(R,t)}for(let r=0;r<=w;r++){const t=r*y+.5;e.moveTo(t,0),e.lineTo(t,C)}e.stroke(),e.restore()}),[de.grid]),me=(0,c.useCallback)(((e,r)=>{ae.current&&D(ae.current,e,r,de.obstacle)}),[de.obstacle]),we=(0,c.useCallback)((()=>{const e=Z.current;ie.current&&e.row>=0&&D(ie.current,e.row,e.col,de.food)}),[de.food]),be=(0,c.useCallback)((()=>{const e=Z.current;if(!ie.current||e.row<0)return;const r=G.current[G.current.length-1];r&&r.row===e.row&&r.col===e.col||O(ie.current,e.row,e.col)}),[]),ge=(0,c.useCallback)((()=>{if(!ie.current||!G.current.length)return;const e=G.current;for(let n=0;n<e.length-1;n++)D(ie.current,e[n].row,e[n].col,de.body);const r=e[e.length-1],t=J.current?de.headKO:de.head;D(ie.current,r.row,r.col,t)}),[de.body,de.head,de.headKO]),pe=ge,ve=(0,c.useCallback)((e=>{const r=S[e]||e,t=L[r];return null==t||t===E(W.current)?null:t}),[]),ye=e=>{var r;if(null==e)return;const t=$.current,n=t.length?t[t.length-1]:null!==(r=_.current)&&void 0!==r?r:W.current;e===E(n)||t.length&&t[t.length-1]===e||t.length>=3||t.push(e)},ke=(0,c.useCallback)(((e,r)=>!V.current.has(x(e,r))),[]),Re=(0,c.useCallback)(((e,r)=>!X.current.has(x(e,r))),[]),Ce=(0,c.useCallback)(((e,r)=>0===Y.current[x(e,r)]),[]),xe=(0,c.useCallback)(((e,r)=>{const t=Z.current;return t.row<0||j(e,r,t.row,t.col,1)}),[]),Ae=(0,c.useCallback)(((e,r)=>{if(!G.current.length)return!0;const t=G.current[G.current.length-1];return j(e,r,t.row,t.col,5)}),[]),Ee=(0,c.useCallback)(((e,r)=>ke(e,r)&&Ae(e,r)&&Re(e,r)&&Ce(e,r)),[ke,Ae,Re,Ce]),je=(0,c.useCallback)(((e,r)=>ke(e,r)&&Re(e,r)&&Ce(e,r)&&xe(e,r)),[ke,Re,Ce,xe]),Me=(0,c.useCallback)((()=>{let e,r,t=0;do{if(e=Math.random()*b|0,r=Math.random()*w|0,++t>300)return}while(!je(e,r));Q.current.push({row:e,col:r}),X.current.add(x(e,r)),me(e,r),oe(e,r,1)}),[je,me,oe]),Se=(0,c.useCallback)((()=>{let e,r,t=0;do{if(e=Math.random()*b|0,r=Math.random()*w|0,++t>200)break}while(!Ee(e,r));be(),Z.current={row:e,col:r},we()}),[Ee,be,we]),Le=(0,c.useCallback)((()=>{t((r=>{const t=r+1;return e||t%v!==0||z((e=>0===e?Math.floor(Math.random()*(360-(e+43.5))):e+43.5)),t>=v&&t%v===0&&(Me(),Me()),t})),Se()}),[e,Me,Se]),De=(0,c.useCallback)((()=>{G.current=[],V.current=new Set,Q.current=[],X.current=new Set,Y.current=new Uint8Array(b*w),le.current&&ue.current&&(ae.current=fe(le.current,R,C,{alpha:!0}),ie.current=fe(ue.current,R,C,{alpha:!0}),ae.current.clearRect(0,0,R,C),he(ae.current),ie.current.clearRect(0,0,R,C));for(let e=0;e<g;e++)G.current.push({row:0,col:e}),V.current.add(x(0,e));te.volume=1,re.volume=1,ne.volume=1,s(!1),t(0),W.current=k,_.current=k,$.current=[],H.current=!1,J.current=!1,pe(),Se()}),[re,ne,te,Se,he,pe]),Oe=()=>{if(q.current)return;q.current=!0;let e=performance.now(),r=0;const t=n=>{if(!q.current)return;r+=n-e,e=n;const c=I.current;for(;r>=c;)Fe(),r-=c;B.current=requestAnimationFrame(t)};B.current=requestAnimationFrame(t)},Ne=()=>{B.current&&cancelAnimationFrame(B.current),B.current=null,q.current=!1},Te=(0,c.useCallback)((()=>{if(!ie.current||!G.current.length)return;const e=G.current[G.current.length-1];D(ie.current,e.row,e.col,de.headKO)}),[de.headKO]),Pe=(0,c.useCallback)(((e,r)=>A(e,r)||X.current.has(x(e,r))?"wall":!!V.current.has(x(e,r))&&"self"),[]),Fe=(0,c.useCallback)((()=>{if(!H.current||J.current)return;$.current.length&&(_.current=$.current.shift()),W.current=_.current;const e=G.current[G.current.length-1],[r,t]=M(e.row,e.col,W.current),n=r===Z.current.row&&t===Z.current.col;if(Pe(r,t))return s(!0),z(0),te.play(),ne.reset(),N(0),H.current=!1,J.current=!0,$.current=[],Te(),void Ne();if(n&&be(),D(ie.current,e.row,e.col,de.body),G.current.push({row:r,col:t}),V.current.add(x(r,t)),D(ie.current,r,t,de.head),n)Le();else{const e=G.current.shift();V.current.delete(x(e.row,e.col)),O(ie.current,e.row,e.col)}}),[Pe,be,de.body,de.head,Le]),Ke=(0,c.useCallback)((()=>{if(ae.current&&ie.current){ae.current.clearRect(0,0,R,C),he(ae.current);for(const e of Q.current)me(e.row,e.col);ie.current.clearRect(0,0,R,C),ge(),we()}}),[he,me,ge,we]);return(0,c.useLayoutEffect)((()=>{let e=0;const r=()=>{cancelAnimationFrame(e),e=requestAnimationFrame((()=>{K(window.innerWidth),le.current&&ue.current&&(ae.current=fe(le.current,R,C,{alpha:!0}),ie.current=fe(ue.current,R,C,{alpha:!0}),Ke())}))};return window.addEventListener("resize",r),r(),()=>{cancelAnimationFrame(e),window.removeEventListener("resize",r)}}),[Ke]),(0,c.useEffect)((()=>{const e=e=>{const r=ve(e.key);ye(r)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[ve]),(0,c.useEffect)((()=>{if(!ce)return;const e=ve(T);ye(e)}),[T,ve,ce]),(0,c.useEffect)((()=>{const r=document.getElementById("app-base");r&&(r.style.filter=e?"none":"hue-rotate(".concat(U,"deg)"))}),[U,e]),(0,c.useEffect)((()=>{Ke()}),[e,Ke]),(0,c.useEffect)((()=>{const e=()=>document.hidden?Ne():H.current&&Oe();return document.addEventListener("visibilitychange",e,{passive:!0}),()=>document.removeEventListener("visibilitychange",e)}),[]),(0,c.useEffect)((()=>()=>{te.volume=0,re.volume=0,ne.volume=0,ne.currentTime=0,Ne()}),[te,re,ne]),(0,c.useEffect)((()=>{De()}),[De]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(a,{}),(0,u.jsx)("div",{id:"app-base",className:"snek-colors ".concat(e?"colorblind-mode":""),children:(0,u.jsxs)("div",{className:"game-container",style:{cursor:l?"none":"inherit"},children:[(0,u.jsx)("h1",{className:"snek-title",style:{display:l||n?"none":"block"},children:"SNEK"}),!l&&(0,u.jsx)("button",{onMouseDown:()=>re.play(),onClick:()=>{q.current||(Ne(),De(),ee.current=d,N(1),H.current=!0,J.current=!1,ne.play(),Oe())},disabled:q.current,children:n?"try again":"start game"}),(0,u.jsxs)("div",{id:"board-wrap",className:"board",ref:se,style:{display:l||n?"block":"none",position:"absolute",width:R,height:C},children:[(0,u.jsx)("canvas",{ref:le,width:R,height:C,style:{position:"absolute",left:0,top:0,zIndex:1}}),(0,u.jsx)("canvas",{ref:ue,width:R,height:C,style:{position:"absolute",left:0,top:0,background:"transparent",zIndex:2,imageRendering:"pixelated"}}),n&&(0,u.jsxs)("div",{className:"game-over",style:{zIndex:3},children:[(0,u.jsx)("p",{className:"game-over-text",children:(0,u.jsx)("span",{children:"GAME OVER "})}),(0,u.jsx)("p",{className:"game-over-text second",children:(0,u.jsx)("span",{children:"GAME OVER "})})]})]}),(0,u.jsx)("p",{className:"score",style:{display:l||n?"block":"none"},children:r}),ce&&l&&ee.current&&(0,u.jsx)(ee.current,{setDirection:P})]})})]})}},7375:(e,r,t)=>{t.d(r,{D:()=>n});class n extends Audio{constructor(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e),this.isPlayingSrc=e=>{var r;return(null===(r=this.src)||void 0===r?void 0:r.includes(e))&&this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2},this.timeLeft=()=>this.duration-this.currentTime,this.reset=()=>{this.pause(),this.currentTime=0},this.loop=r}}}}]);
//# sourceMappingURL=673.e399cd9d.chunk.js.map