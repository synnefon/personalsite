"use strict";(self.webpackChunkpersonalsite=self.webpackChunkpersonalsite||[]).push([[610],{5610:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var r=n(9379),o=n(5043);const s=4,c=15,i=20,l=.3,a=4,u=5,d=5e4,f=100,m=33554432,h=67108864,g=3,v=217,p=166,w=14,x=.1,b=.5,y=1,E=1;var j=n(579);const k=(0,o.memo)((e=>{let{x:t,y:n,filled:r}=e;return(0,j.jsx)("div",{"data-cell-x":t,"data-cell-y":n,className:"gol-board-cell".concat(r?" filled":""),style:r?{backgroundColor:"rgb(".concat(v,", ").concat(p,", ").concat(w,")")}:void 0})}));function A(e){const t=e.trim().split("\n"),n=[];return t.forEach(((e,t)=>{for(let r=0;r<e.length;r++){"*"===e[r]&&n.push([r,t])}})),n}k.displayName="Cell";const M=A("\n****\n*..*\n"),R=A("\n***.***\n*.*.*.*\n***.***\n"),C=A("\n........................*...........\n......................*.*..........*\n............**......**............**\n...........*...*....**..............*\n**........*.....*...**..............*\n**........*...*.**....*.*..........*\n..........*.....*.......*...........\n...........*...*....................\n............**......................\n"),S=A("\n..**......\n*..*......\n**.*.**...\n.*.*..*...\n.*....*.**\n..***.*.**\n.....*....\n....*.....\n....**....\n"),L=[{name:"hollow squares",pattern:R},{name:"gosper glider gun",pattern:C},{name:"acorn",pattern:A("\n.*.....\n...*...\n**..***.\n")},{name:"r-pentomino",pattern:A("\n.**\n**.\n.*.\n")},{name:"lightweight spaceship",pattern:A("\n*..*\n....*\n*...*\n.****\n")},{name:"pentadecathlon",pattern:A("\n.*.\n.*.\n*.*\n.*.\n.*.\n.*.\n.*.\n*.*\n.*.\n.*.\n")},{name:"rabbits",pattern:A("\n..*....*\n**......\n.**.***.\n")},{name:"one two three",pattern:S},{name:"table",pattern:M}];const Y=(e,t)=>(e+m)*h+(t+m),X=e=>[Math.floor(e/h)-m,e%h-m];function N(e){let{liveCellsRef:t,viewportRef:n,ticksPerSec:r,setGeneration:s,setTickCount:c,setRunning:i}=e;const l=(0,o.useRef)(!1),a=(0,o.useRef)(null),u=(0,o.useRef)(0),m=(0,o.useRef)(0),h=(0,o.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now();if(!l.current)return void(a.current=null);if(e-u.current<1e3/r.current)return void(a.current=requestAnimationFrame(h));const o=t.current.size;if(function(e,t,n,r){return!(e<d)&&(t.current=!1,n.current=null,alert("Simulation paused: cell limit reached (".concat(d," cells).")),r((e=>e+1)),!0)}(o,l,a,s))return;const v=function(e){return{minX:Math.floor(e.offset.x)-f,maxX:Math.floor(e.offset.x)+e.dimensions.cols+f,minY:Math.floor(e.offset.y)-f,maxY:Math.floor(e.offset.y)+e.dimensions.rows+f}}(n.current),p=function(e,t,n){let{minX:r,maxX:o,minY:s,maxY:c}=n;const i=new Set;return e.forEach(((e,n)=>{const l=t.has(n);if(e===g||l&&(2===e||3===e)){const[e,t]=X(n);e>=r&&e<=o&&t>=s&&t<=c&&i.add(n)}})),i}(function(e){const t=new Map;return e.forEach((e=>{const[n,r]=X(e);for(let o=-1;o<=1;o++)for(let e=-1;e<=1;e++){if(0===e&&0===o)continue;const s=Y(n+e,r+o);t.set(s,(t.get(s)||0)+1)}})),t}(t.current),t.current,v);if(0===p.size)return l.current=!1,i(!1),a.current=null,t.current=p,void s((e=>e+1));!function(e,t,n){e>1.5*t?(n.current++,n.current>=10&&(console.warn("Exponential growth detected: ".concat(t," \u2192 ").concat(e," cells over 10 generations")),n.current=0)):n.current=0}(p.size,o,m),t.current=p,s((e=>e+1)),c((e=>e+1)),u.current=e,a.current=requestAnimationFrame(h)}),[t,n,r,s,c,i]);return(0,o.useEffect)((()=>()=>{null!==a.current&&cancelAnimationFrame(a.current)}),[]),{runningRef:l,animationFrameRef:a,lastTickTimeRef:u,runTick:h}}function T(){var e;const t=(0,o.useRef)(s),n=Math.ceil(window.innerHeight/(i*y)),d=Math.ceil(window.innerWidth/(i*y)),[{initialLive:f,patternCenterX:m,patternCenterY:h,selectedPattern:g}]=(0,o.useState)((()=>{const e=function(){const e=Math.floor(Math.random()*L.length),t=L[e];return console.log("Starting pattern: ".concat(t.name)),t}(),t=new Set(e.pattern.map((e=>{let[t,n]=e;return Y(t,n)}))),n=Math.min(...e.pattern.map((e=>{let[t]=e;return t}))),r=Math.max(...e.pattern.map((e=>{let[t]=e;return t}))),o=Math.min(...e.pattern.map((e=>{let[,t]=e;return t}))),s=Math.max(...e.pattern.map((e=>{let[,t]=e;return t})));return{selectedPattern:e,initialLive:t,patternCenterX:(n+r)/2,patternCenterY:(o+s)/2}})),[v,p]=(0,o.useState)({zoom:y,offset:{x:m-d/2,y:h-n/2},dimensions:{rows:n,cols:d}}),w=(0,o.useRef)(v);(0,o.useEffect)((()=>{w.current=v}),[v]);const{zoom:A,offset:M,dimensions:R}=v,C=R.rows,S=R.cols;(0,o.useEffect)((()=>{const e=()=>{const e=w.current;p((0,r.A)((0,r.A)({},e),{},{dimensions:{rows:Math.ceil(window.innerHeight/(i*e.zoom)),cols:Math.ceil(window.innerWidth/(i*e.zoom))}}))};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const[X,T]=(0,o.useState)(0),[z,F]=(0,o.useState)(0),D=(0,o.useRef)(0);(0,o.useEffect)((()=>{D.current=z}),[z]);const[q,P]=(0,o.useState)(!0),[H,B]=(0,o.useState)(!1),[W,G]=(0,o.useState)(!1),[V,I]=(0,o.useState)(g),U=(0,o.useRef)(new Set(f)),J=(0,o.useRef)({x:m-d/2,y:h-n/2}),K=(0,o.useRef)(0),[O,Q]=(0,o.useState)(!1),[Z,$]=(0,o.useState)(!1),_=(0,o.useRef)(!1);(0,o.useEffect)((()=>{const e=()=>{Q(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)}),[]),(0,o.useEffect)((()=>{const e=e=>{"Escape"===e.key&&Z&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),$(!1))};if(Z)return document.addEventListener("keydown",e,{capture:!0}),()=>document.removeEventListener("keydown",e,{capture:!0})}),[Z]);const ee=(0,o.useCallback)((()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch((e=>{console.error("Error attempting to enable fullscreen:",e)}))}),[]);(0,o.useEffect)((()=>{const e=setTimeout((()=>{B(!0)}),2e3),t=setTimeout((()=>{P(!1)}),3e3);return()=>{clearTimeout(e),clearTimeout(t)}}),[]);const te=(0,o.useRef)(f),[ne,re]=(0,o.useState)(!1),{runningRef:oe,animationFrameRef:se,lastTickTimeRef:ce,runTick:ie}=N({liveCellsRef:te,viewportRef:w,ticksPerSec:t,setGeneration:T,setTickCount:F,setRunning:re}),le=(0,o.useCallback)(((e,t)=>{if(fe.current)return;const n=Y(e,t),r=te.current;r.has(n)?r.delete(n):r.add(n),T((e=>e+1))}),[]),ae=(0,o.useCallback)((e=>{oe.current=!1,re(!1),null!==se.current&&(cancelAnimationFrame(se.current),se.current=null),F(0);const t=e?new Set(e.pattern.map((e=>{let[t,n]=e;return Y(t,n)}))):new Set;te.current=t;const n=w.current;let o=n.offset;if(e){const t={minX:Math.min(...e.pattern.map((e=>{let[t]=e;return t}))),maxX:Math.max(...e.pattern.map((e=>{let[t]=e;return t}))),minY:Math.min(...e.pattern.map((e=>{let[,t]=e;return t}))),maxY:Math.max(...e.pattern.map((e=>{let[,t]=e;return t})))},s=(t.minX+t.maxX)/2,c=(t.minY+t.maxY)/2;o={x:s-n.dimensions.cols/2,y:c-n.dimensions.rows/2},p((0,r.A)((0,r.A)({},n),{},{offset:o}))}U.current=new Set(t),J.current=o,K.current=0,T((e=>e+1))}),[oe,se,w]),ue=(0,o.useCallback)((()=>{oe.current=!1,re(!1),null!==se.current&&(cancelAnimationFrame(se.current),se.current=null),F(K.current),te.current=new Set(U.current);const e=w.current;p((0,r.A)((0,r.A)({},e),{},{offset:J.current})),T((e=>e+1)),G(!0),setTimeout((()=>{G(!1)}),900)}),[oe,se,w]),de=(0,o.useCallback)((()=>{const e=!oe.current;oe.current=e,re(e),e?(U.current=new Set(te.current),J.current=w.current.offset,K.current=D.current,ce.current=performance.now(),ie()):(null!==se.current&&(cancelAnimationFrame(se.current),se.current=null),T((e=>e+1)))}),[ie,oe,se,ce,w,D]),{isDraggingRef:fe,isDragging:me,isPointerDown:he}=function(e){let{viewportRef:t,setViewport:n,onToggleStart:s,toggleFullscreen:c}=e;const d=(0,o.useRef)(!1),[f,m]=(0,o.useState)(!1),[h,g]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{const e=e=>{switch(e.key){case"ArrowDown":n((e=>(0,r.A)((0,r.A)({},e),{},{offset:(0,r.A)((0,r.A)({},e.offset),{},{y:e.offset.y-1})})));break;case"ArrowUp":n((e=>(0,r.A)((0,r.A)({},e),{},{offset:(0,r.A)((0,r.A)({},e.offset),{},{y:e.offset.y+1})})));break;case"ArrowRight":n((e=>(0,r.A)((0,r.A)({},e),{},{offset:(0,r.A)((0,r.A)({},e.offset),{},{x:e.offset.x-1})})));break;case"ArrowLeft":n((e=>(0,r.A)((0,r.A)({},e),{},{offset:(0,r.A)((0,r.A)({},e.offset),{},{x:e.offset.x+1})})));break;case"Enter":case" ":e.preventDefault(),s();break;case"f":case"F":e.preventDefault(),c()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[s,c,n]),(0,o.useEffect)((()=>{const e=e=>{e.preventDefault();const r=e.currentTarget.getBoundingClientRect(),o=(e.clientX-r.left)/r.width,s=(e.clientY-r.top)/r.height,c=t.current,u=e.deltaY>0?x:-x,d=Math.max(l,Math.min(a,c.zoom+u)),f=Math.ceil(window.innerHeight/(i*d)),m=Math.ceil(window.innerWidth/(i*d)),h={x:c.offset.x-o*(m-c.dimensions.cols),y:c.offset.y-s*(f-c.dimensions.rows)};n({zoom:d,offset:h,dimensions:{rows:f,cols:m}})},r=document.querySelector(".gol-board");if(r){const t=e;return r.addEventListener("wheel",t,{passive:!1}),()=>r.removeEventListener("wheel",t)}}),[t,n]),(0,o.useEffect)((()=>{let e=!1,o=!1,s=0,c=0,i=0,l=0;const a=t=>{t.target.closest(".gol-controls")||(e=!0,o=!1,g(!0),s=t.clientX,c=t.clientY,i=t.clientX,l=t.clientY)},f=a=>{if(!e)return;const f=a.clientX-i,h=a.clientY-l,g=Math.abs(a.clientX-s),v=Math.abs(a.clientY-c);if(!o&&(g>u||v>u)&&(o=!0,d.current=!0,m(!0)),o){const e=t.current,o=document.querySelector(".gol-board"),s=null===o||void 0===o?void 0:o.getBoundingClientRect();if(!s)return;const c=f/s.width*e.dimensions.cols,i=h/s.height*e.dimensions.rows;n((e=>(0,r.A)((0,r.A)({},e),{},{offset:{x:e.offset.x-c,y:e.offset.y-i}})))}i=a.clientX,l=a.clientY},h=()=>{o&&m(!1),e=!1,o=!1,g(!1),setTimeout((()=>{d.current=!1}),0)},v=()=>{e&&(e=!1,o=!1,g(!1),m(!1),d.current=!1)};return window.addEventListener("mousedown",a),window.addEventListener("mousemove",f),window.addEventListener("mouseup",h),window.addEventListener("mouseleave",v),()=>{window.removeEventListener("mousedown",a),window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",h),window.removeEventListener("mouseleave",v)}}),[t,n]),(0,o.useEffect)((()=>{let e=0,o=!1,s=!1,c=0,d=0,f=0,h=0;const g=t=>{if(2===t.touches.length){o=!1,s=!1;const n=t.touches[0].clientX-t.touches[1].clientX,r=t.touches[0].clientY-t.touches[1].clientY;e=Math.sqrt(n*n+r*r)}else 1===t.touches.length&&(o=!0,s=!1,c=t.touches[0].clientX,d=t.touches[0].clientY,f=t.touches[0].clientX,h=t.touches[0].clientY)},v=g=>{if(2===g.touches.length){g.preventDefault(),o=!1,s=!1;const r=g.currentTarget.getBoundingClientRect(),c=(g.touches[0].clientX+g.touches[1].clientX)/2,u=(g.touches[0].clientY+g.touches[1].clientY)/2,d=(c-r.left)/r.width,f=(u-r.top)/r.height,m=t.current,h=g.touches[0].clientX-g.touches[1].clientX,v=g.touches[0].clientY-g.touches[1].clientY,p=1+(Math.sqrt(h*h+v*v)/e-1)*b,w=Math.max(l,Math.min(a,m.zoom*p)),x=Math.ceil(window.innerHeight/(i*w)),y=Math.ceil(window.innerWidth/(i*w)),E={x:m.offset.x-d*(y-m.dimensions.cols),y:m.offset.y-f*(x-m.dimensions.rows)};n({zoom:w,offset:E,dimensions:{rows:x,cols:y}})}else if(1===g.touches.length&&o){const e=g.touches[0].clientX-f,o=g.touches[0].clientY-h,i=Math.abs(g.touches[0].clientX-c),l=Math.abs(g.touches[0].clientY-d);if(!s&&(i>u||l>u)&&(s=!0,m(!0)),s){g.preventDefault();const s=t.current,c=document.querySelector(".gol-board"),i=null===c||void 0===c?void 0:c.getBoundingClientRect();if(!i)return;const l=e/i.width*s.dimensions.cols,a=o/i.height*s.dimensions.rows;n((e=>(0,r.A)((0,r.A)({},e),{},{offset:{x:e.offset.x-l,y:e.offset.y-a}})))}f=g.touches[0].clientX,h=g.touches[0].clientY}},p=()=>{o=!1,m(!1)},w=document.querySelector(".gol-board");if(w){const e=g,t=v,n=p;return w.addEventListener("touchstart",e),w.addEventListener("touchmove",t,{passive:!1}),w.addEventListener("touchend",n),()=>{w.removeEventListener("touchstart",e),w.removeEventListener("touchmove",t),w.removeEventListener("touchend",n)}}}),[t,n]),{isDraggingRef:d,isDragging:f,isPointerDown:h}}({viewportRef:w,setViewport:p,onToggleStart:de,toggleFullscreen:ee});(0,o.useEffect)((()=>{Z?(_.current=oe.current,oe.current&&(oe.current=!1,re(!1),null!==se.current&&(cancelAnimationFrame(se.current),se.current=null))):_.current&&(oe.current=!0,re(!0),ce.current=performance.now(),ie())}),[Z,oe,se,ce,ie]);const ge=Math.floor(M.x),ve=Math.floor(M.y),pe=M.x-ge,we=M.y-ve,xe=(0,o.useCallback)((e=>{const t=e.target;if(!t.classList.contains("gol-board-cell"))return;const n=t.getAttribute("data-cell-x"),r=t.getAttribute("data-cell-y");n&&r&&le(Number(n),Number(r))}),[le]),be=(0,o.useMemo)((()=>{const e=[];for(let t=0;t<C+E;t++){const n=[];for(let e=0;e<S+E;e++){const r=e+ge,o=t+ve,s=te.current.has(Y(r,o));n.push((0,j.jsx)(k,{x:r,y:o,filled:s},"cell-".concat(r,",").concat(o)))}e.push((0,j.jsx)("div",{className:"gol-board-row",children:n},"row-".concat(t+ve)))}return e}),[ge,ve,C,S,X]);return(0,j.jsxs)("div",{id:"game-of-life",className:"gol-container",children:[q&&(0,j.jsx)("div",{className:"gol-splash".concat(H?" fading":""),children:(0,j.jsxs)("div",{className:"gol-splash-text",children:["conway's",(0,j.jsx)("br",{}),"game of life"]})}),(0,j.jsx)("div",{className:"gol-board".concat(he&&!me?" mouse-down":"").concat(me?" dragging":"").concat(ne?" running":"").concat(A>=2?" zoomed-in":""),style:{"--rows":C,"--cols":S,"--zoom":A},children:(0,j.jsx)("div",{className:"gol-board-content",onClick:xe,style:{transform:"translate(".concat(100/S*-pe,"%, ").concat(100/C*-we,"%)")},children:be})}),(0,j.jsxs)("aside",{className:"gol-controls",children:[(0,j.jsx)("div",{className:"gol-control-group",children:(0,j.jsxs)("label",{children:[(0,j.jsx)("div",{children:"pattern"}),(0,j.jsxs)("select",{className:"gol-pattern-select",value:null!==(e=null===V||void 0===V?void 0:V.name)&&void 0!==e?e:"empty",onChange:e=>{const t=e.target.value;if("empty"===t)I(null),ae(null);else{const e=L.find((e=>e.name===t));e&&(I(e),ae(e))}},children:[(0,j.jsx)("option",{value:"empty",children:"empty"}),L.map((e=>(0,j.jsx)("option",{value:e.name,children:e.name},e.name)))]})]})}),(0,j.jsx)("div",{className:"gol-start-button".concat(ne?" running":""),onClick:de,children:ne?"\u23f8":"\u25b6"}),(0,j.jsx)("div",{className:"gol-start-button".concat(W?" clearing":""),onClick:ue,children:"\u27f2"}),(0,j.jsx)("div",{className:"gol-control-group",children:(0,j.jsxs)("label",{children:[(0,j.jsx)("div",{children:"ticks / second"}),(0,j.jsx)("input",{type:"number",min:1,max:c,step:1,value:(ye=t.current,0===ye?"":ye),onChange:e=>{const n=e.target.value;if(""===n)t.current=0;else{const e=Math.max(0,Math.min(c,Number(n)));t.current=e}T((e=>e+1))}})]})})]}),(0,j.jsx)("div",{className:"gol-info-button",onClick:()=>$(!0),title:"Rules",children:"\u2699"}),Z&&(0,j.jsx)("div",{className:"gol-info-overlay",onClick:()=>$(!1),children:(0,j.jsxs)("div",{className:"gol-info-popup",onClick:e=>e.stopPropagation(),children:[(0,j.jsx)("button",{className:"gol-info-close",onClick:()=>$(!1),title:"Close (Esc)",children:"\u2715"}),(0,j.jsx)("h2",{children:"conway's game of life"}),(0,j.jsxs)("div",{className:"gol-info-content",children:[(0,j.jsx)("p",{children:"a cellular automaton in which cells live, die, or reproduce based on simple rules:"}),(0,j.jsxs)("ol",{children:[(0,j.jsxs)("li",{children:[(0,j.jsx)("strong",{children:"underpopulation:"})," a live cell with fewer than 2 live neighbors dies"]}),(0,j.jsxs)("li",{children:[(0,j.jsx)("strong",{children:"survival:"})," a live cell with 2 or 3 live neighbors survives"]}),(0,j.jsxs)("li",{children:[(0,j.jsx)("strong",{children:"reproduction:"})," a dead cell with exactly 3 live neighbors becomes alive"]}),(0,j.jsxs)("li",{children:[(0,j.jsx)("strong",{children:"overpopulation:"})," a live cell with more than 3 live neighbors dies"]})]}),(0,j.jsxs)("p",{className:"gol-info-controls",children:[(0,j.jsx)("strong",{children:"controls:"}),(0,j.jsx)("br",{}),"click cells to toggle \u2022 arrow keys to pan \u2022 scroll to zoom \u2022 drag to pan \u2022 f for fullscreen"]})]})]})}),(0,j.jsx)("div",{className:"gol-tick-counter",children:z}),(0,j.jsx)("div",{className:"gol-fullscreen-button",onClick:ee,title:O?"Exit fullscreen (F)":"Fullscreen (F)",children:(0,j.jsxs)("div",{style:{display:"flex",flexDirection:"column",lineHeight:"".concat(O?1:.3),fontSize:"2.4rem"},children:[(0,j.jsx)("div",{children:O?"\u231f\u231e":"\u231c\u231d"}),(0,j.jsx)("div",{children:O?"\u231d\u231c":"\u231e\u231f"})]})})]});var ye}}}]);
//# sourceMappingURL=610.8e94c2a6.chunk.js.map