{"version":3,"file":"static/js/124.beec9515.chunk.js","mappings":"wJAmCA,MACA,EAAe,IAA0B,0D,aC1B1B,SAASA,EAAgBC,GAKQ,IALP,WACvCC,EAAU,gBACVC,EAAe,SACfC,EAAQ,SACRC,GACsBJ,EACtB,MAAMK,GAAoBC,EAAAA,EAAAA,QAAuB,MAC3CC,GAAsBD,EAAAA,EAAAA,QAAuB,MAC7CE,GAAqBF,EAAAA,EAAAA,QAAuB,OAC3CG,EAAiBC,IAAsBC,EAAAA,EAAAA,WAAS,IAChDC,EAAmBC,IAAwBF,EAAAA,EAAAA,WAAS,IACpDG,EAAkBC,IAAuBJ,EAAAA,EAAAA,WAAS,GAkEzD,IA/DAK,EAAAA,EAAAA,YAAU,KAYR,SAASC,EACPC,EACAC,GAEA,IAAKD,EAAWE,QAAS,OACzB,MAAMC,EAAUH,EAAWE,QAAQE,cACjC,mBAEIC,EAAiBL,EAAWE,QAAQI,YACpCC,EAAgBJ,GAAWA,EAAQK,YAAcH,EAGvD,GAFAJ,IAAiBM,GAEbA,GAAiBJ,EAAS,CAC5B,MAAMM,EAAmCN,EAAQK,YAxBhC,GAyBXE,EAlBD,EAmBLV,EAAWE,QAAQS,MAAMC,YACvB,oBAAoB,GAADC,OAChBJ,EAAQ,MAEbT,EAAWE,QAAQS,MAAMC,YACvB,sBAAsB,GAADC,OAClBH,IAELV,EAAWE,QAAQY,UAAUC,IAAI,cACnC,MACEf,EAAWE,QAAQY,UAAUE,OAAO,cAExC,CAGA,SAASC,IACPlB,EACEZ,EACAK,GAEFO,EACEV,EACAM,GAEFI,EACET,EACAO,EAEJ,CAKA,OAHAoB,IACAC,OAAOC,iBAAiB,SAAUF,GAE3B,IAAMC,OAAOE,oBAAoB,SAAUH,EAAiB,GAClE,CAAClC,EAAYE,KAEXF,EACH,OAAO,KAOT,OACEsC,EAAAA,EAAAA,MAAA,OACEC,UAAS,yBAAAT,OAA2B5B,EAAW,WAAa,aAAcsC,SAAA,EAE1EC,EAAAA,EAAAA,KAAA,UACEC,KAAK,SACLH,UAAU,+BACVI,QAASxC,EACT,aAAYD,EAAW,uBAAyB,qBAAqBsC,SAEpEtC,EAAW,IAAM,OAEpBoC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gCAA+BC,SAAA,EAC5CF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,+BAA8BC,SAAA,EAC3CC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,8BAA6BC,SAAExC,EAAW4C,WACvD5C,EAAW6C,aACXJ,EAAAA,EAAAA,KAAA,OAAKF,UAAU,sBAAqBC,SACjCvC,EAAgB6C,KAAI,CAACC,EAAQC,KAC5BP,EAAAA,EAAAA,KAAA,OAEEF,UAAU,0BACVX,MAAO,CAAE,eAAgBmB,IAFpBC,WAQfV,EAAAA,EAAAA,MAAA,OACEW,IAAK7C,EACLmC,UAAU,6BACVI,QAlCgBO,KACtBf,OAAOgB,KAAK,iCAAkC,SAAU,sBAAsB,EAkCxEvB,MAAO,CAAEwB,OAAQ,kBACjBC,MAAM,cAAab,SAAA,EAEnBC,EAAAA,EAAAA,KAAA,QAAMF,UAAU,iBAAgBC,SAAExC,EAAWsD,OAC5C9C,IACCiC,EAAAA,EAAAA,KAAA,QAAMF,UAAU,wBAAuBC,SAAExC,EAAWsD,WAGtDtD,EAAW6C,aACXP,EAAAA,EAAAA,MAAAiB,EAAAA,SAAA,CAAAf,SAAA,EACEF,EAAAA,EAAAA,MAAA,OACEW,IAAK3C,EACLiC,UAAU,+BAA8BC,SAAA,EAExCC,EAAAA,EAAAA,KAAA,QAAMF,UAAU,iBAAgBC,SAAExC,EAAWwD,SAC5C7C,IACC8B,EAAAA,EAAAA,KAAA,QAAMF,UAAU,wBAAuBC,SACpCxC,EAAWwD,aAIlBlB,EAAAA,EAAAA,MAAA,OACEW,IAAK1C,EACLgC,UAAU,8BAA6BC,SAAA,EAEvCC,EAAAA,EAAAA,KAAA,QAAMF,UAAU,iBAAgBC,SAAExC,EAAWyD,QAC5C5C,IACC4B,EAAAA,EAAAA,KAAA,QAAMF,UAAU,wBAAuBC,SACpCxC,EAAWyD,mBAS9B,C,+GC3HaC,EAAeA,KAC1B,MAAMC,EACJC,UAAUD,WACVC,UAAUC,QACT1B,OAAuC2B,OACxC,GAIIC,EADJ,iEAC6BC,KAAKL,GAE9BM,EAAW,iBAAkB9B,QAAUyB,UAAUM,eAAiB,EAClEC,EAAgBhC,OAAOiC,YAAc,IAE3C,OAAOL,GAAeE,GAAYE,CAAc,EAG5CE,EAAWX,IAOJY,EAAgB,CAC3BC,QAAS,UACTC,KAAM,OACNC,UAAW,eAGAC,EAAY,CACvB,CAACJ,EAAcC,SAAU,KACzB,CAACD,EAAcE,MAAO,yCACtB,CAACF,EAAcG,WAAY,uEAQhBE,EAAM,CACjBC,QAAS,IACTC,cAAe,IACfC,SAAU,IAEVC,eAAgB,KAChBC,eAAgB,MAChBC,gBAAiB,KAEjBC,0BAA2B,GAC3BC,qBAAsB,GACtBC,kBAAmB,MACnBC,uBAAwB,KAsCnB,SAASC,EAAsBC,GACpC,OAAOZ,EAAIQ,qBAAuBI,CACpC,CAUO,MAAMC,EAAS,CACpBC,qBAAsB,GACtBC,UAAW,IAcN,SAASC,EAAmBC,EAAe7C,GAChD,MAAM8C,EAAOD,EAAQ7C,EACrB,OAAO+C,KAAKC,KAAKF,EAAO,QAC1B,CAiBO,MAAMG,EAAS,CACpBC,MAAO,GACPC,YAAa7B,EAAW,GAAK,GAC7B8B,cAAe,IAaV,MAAMC,EAAsB/B,EAAW,MAAU,MAK3CgC,EAAgB,IAGhBC,EAAQ,CACnBC,IAAK,EACLC,IAAK,EACLC,QAAS,IACTC,MAAO,IAKIC,EAAW,IADC,GAEZC,EAAoB,EAGpBC,EAAiB,uBCjNjBC,EAAsB,CACjC,CAACxC,EAAcC,SAAU,CACvBwC,MAAO,qBACPC,IAAKC,EACLC,KAAM,MAER,CAAC5C,EAAcE,MAAO,CACpBuC,MAAO,OACPC,IAAK,4CAEP,CAAC1C,EAAcG,WAAY,CACzBsC,MAAO,cACPC,IAAK,gIAIIG,EAAkBC,ECiBxB,SAASC,EAAaC,GAC3B,GAAIA,GAAO,EAAG,OAAO,EAErB,MAAMC,EAAQjB,EAAMI,MACpB,GAAIY,GAAOC,EAAO,OAAOjB,EAAME,IAE/B,MAAMgB,EAAIF,EAAMC,EAEVE,EAAeC,IAAmCpB,EAAME,IAExDmB,EAAS7B,KAAK8B,IAAIH,GAClBI,EAAS/B,KAAK8B,IAAItB,EAAME,KAG9B,OAAOV,KAAKgC,IAAIH,GAAUE,EAASF,GAAUH,EAC/C,CAkEO,SAASO,EAAUC,EAAgBC,EAAYC,GACpD,OAAOA,EAAKF,EAAEG,KAAOF,CACvB,CCtHO,SAASG,EAASC,GACvB,IAAIC,EAAID,EAGR,MAFa,MAATC,EAAE,KAAYA,EAAIA,EAAEC,MAAM,IAEb,IAAbD,EAAEE,OACG,CACLC,EAAI,GAAKC,EAAgBJ,EAAE,IAAMI,EAAgBJ,EAAE,IACnDN,EAAI,GAAKU,EAAgBJ,EAAE,IAAMI,EAAgBJ,EAAE,IACnDK,EAAI,GAAKD,EAAgBJ,EAAE,IAAMI,EAAgBJ,EAAE,KAItC,IAAbA,EAAEE,OACG,CACLC,EAAG,GAAKC,EAAgBJ,EAAE,IAC1BN,EAAG,GAAKU,EAAgBJ,EAAE,IAC1BK,EAAG,GAAKD,EAAgBJ,EAAE,KAIvB,CAAEG,EAAG,IAAKT,EAAG,IAAKW,EAAG,EAC9B,CAGA,SAASD,EAAgBE,GACvB,MAAMC,EAAOD,EAAEE,WAAW,GAC1B,OAAID,GAAQ,IAAMA,GAAQ,GAAWA,EAAO,GACxCA,GAAQ,IAAMA,GAAQ,GAAWA,EAAO,GACxCA,GAAQ,IAAMA,GAAQ,IAAYA,EAAO,GACtC,CACT,CAGO,SAASE,EAAST,EAAWU,EAAWC,GAE7C,MAAMC,EAAIF,EAAIlD,KAAKqD,IAAIF,EAAG,EAAIA,GAC9B,SAASG,EAAEC,GACT,MAAMC,GAAKD,EAAIf,EAAI,IAAM,GACnBiB,EAAIN,EAAIC,EAAIpD,KAAK0D,IAAI1D,KAAKqD,IAAIG,EAAI,EAAG,EAAIA,EAAG,IAAK,GAEvD,IAAIG,EAAM3D,KAAK4D,MAAM,IAAMH,GAG3B,OAFAE,EAAMA,EAAM,EAAI,EAAIA,EAAM,IAAM,IAAMA,EAQ1C,SAAcJ,GACZ,OAAIA,EAAI,GAAW,IAAMA,EAAEM,SAAS,IAC7BN,EAAEM,SAAS,GACpB,CATWC,CAAKH,EACd,CACA,MAAM,IAAN3H,OAAWsH,EAAE,IAAEtH,OAAGsH,EAAE,IAAEtH,OAAGsH,EAAE,GAC7B,CAQO,SAASS,EAASxB,GAEvB,MAAM,EAAEI,EAAC,EAAET,EAAC,EAAEW,GAAMP,EAASC,GACvByB,EAAS,mBAAJrB,EACLsB,EAAS,mBAAJ/B,EACLgC,EAAS,mBAAJrB,EAELa,EAAMM,EAAKC,EAAMD,EAAKE,EAAKF,EAAKE,EAAOD,EAAKC,EAAKD,EAAKC,EAEtDC,EAAQT,GADFM,EAAKC,EAAMD,EAAKE,EAAKF,EAAKE,EAAOD,EAAKC,EAAKD,EAAKC,GAG5D,GAAIC,EAAQ,KAAM,OAAO,EAEzB,IAAIC,EAWJ,OATEA,EADEV,IAAQM,GACFC,EAAKC,GAAMC,EAAS,EACnBT,IAAQO,GACVC,EAAKF,GAAMG,EAAQ,GAEnBH,EAAKC,GAAME,EAAQ,EAG5BC,EAAMpE,KAAK4D,MAAY,GAANQ,GACbA,EAAM,IAAGA,GAAO,KACbA,CACT,CA8CO,SAASC,EAAS7B,EAAWU,EAAWC,GAC7C,IAAIR,EAAWT,EAAWW,EAE1B,GAAIK,EAAI,KAENP,EAAIT,EAAIW,EAAIM,MACP,CACL,MAAMmB,EAAUA,CAACC,EAAWC,EAAW9C,KACrC,IAAI+C,EAAK/C,EAGT,OAFI+C,EAAK,IAAGA,GAAM,GACdA,EAAK,IAAGA,GAAM,GACdA,EAAK,EAAI,EAAUF,EAAc,GAATC,EAAID,GAASE,EACrCA,EAAK,GAAcD,EACnBC,EAAK,EAAI,EAAUF,GAAKC,EAAID,IAAM,EAAI,EAAIE,GAAM,EAC7CF,CAAC,EAGJC,EAAIrB,EAAI,GAAMA,GAAK,EAAID,GAAKC,EAAID,EAAIC,EAAID,EACxCqB,EAAI,EAAIpB,EAAIqB,EAElB7B,EAAI2B,EAAQC,EAAGC,EAAGhC,EAAI,EAAI,GAC1BN,EAAIoC,EAAQC,EAAGC,EAAGhC,GAClBK,EAAIyB,EAAQC,EAAGC,EAAGhC,EAAI,EAAI,EAC5B,CAEA,MAAO,CACLG,EAAG3C,KAAK4D,MAAU,IAAJjB,GACdT,EAAGlC,KAAK4D,MAAU,IAAJ1B,GACdW,EAAG7C,KAAK4D,MAAU,IAAJf,GAElB,CAGO,SAAS6B,EAASnC,GACvB,MAAM,EAAEI,EAAC,EAAET,EAAC,EAAEW,GAAMP,EAASC,GAC7B,OAtEK,SAAkBI,EAAWT,EAAWW,GAE7C,MAAMmB,EAAKrB,EAAI,IACTsB,EAAK/B,EAAI,IACTgC,EAAKrB,EAAI,IAETa,EAAM1D,KAAK0D,IAAIM,EAAIC,EAAIC,GACvBb,EAAMrD,KAAKqD,IAAIW,EAAIC,EAAIC,GACvBC,EAAQT,EAAML,EAGdF,GAAKO,EAAML,GAAO,EAGxB,GAAIc,EAAQ,KACV,MAAO,CAAE3B,EAAG,EAAGU,EAAG,EAAGC,KAOvB,IAAIX,EASJ,OAPEA,EADEkB,IAAQM,IACJC,EAAKC,GAAMC,GAASF,EAAKC,EAAK,EAAI,IAAM,EACrCR,IAAQO,IACXC,EAAKF,GAAMG,EAAQ,GAAK,IAExBH,EAAKC,GAAME,EAAQ,GAAK,EAGzB,CAAE3B,IAAGU,EAZFC,EAAI,GAAMgB,GAAS,EAAIT,EAAML,GAAOc,GAAST,EAAML,GAY9CF,IACjB,CAsCSwB,CAAShC,EAAGT,EAAGW,EACxB,CC9Ie,SAAS+B,EAAU3K,GAQb,IARc,UACjC4K,EAAS,MACTC,EAAK,cACLC,EAAa,MACb9D,EAAK,YACL+D,EAAW,YACXC,EAAW,cACXC,GACgBjL,EAChB,MAAMkL,EApBR,SAAkB5C,GAChB,MAAM6C,EAAS,4CAA4CC,KAAK9C,GAChE,OAAO6C,EACH,CACEzC,EAAG2C,SAASF,EAAO,GAAI,IACvBlD,EAAGoD,SAASF,EAAO,GAAI,IACvBvC,EAAGyC,SAASF,EAAO,GAAI,KAEzB,CAAEzC,EAAG,EAAGT,EAAG,EAAGW,EAAG,EACvB,CAWcP,CAASwC,GACfS,EAAaL,IAAkBL,EAgBrC,OACErI,EAAAA,EAAAA,MAAA,OACEV,MAAO,CACL0J,QAAS,OACTC,cAAe,SACfC,WAAY,SACZC,IAAK,OACLjJ,SAAA,EAEFF,EAAAA,EAAAA,MAAA,OACE,aAAYqI,EACZ/I,MAAO,CACL8J,SAAU,WACV9F,MAAO,OACP7C,OAAQ,OACRK,OAAQ0H,EACJ,qBACAO,EACE,kBACA,iBACNM,QAASb,EAAc,GAAM,GAE/BnI,QApCeiJ,IACnB,GAAId,GAAeE,EAAe,OAClC,MAAMa,EAAOD,EAAEE,cAAcC,wBACvBC,EAAUH,EAAKjG,MAAQ,EACvBqG,EAAUJ,EAAK9I,OAAS,EACxBwG,EAAIqC,EAAEM,QAAUL,EAAKM,KAAOH,EAC5BI,EAAIR,EAAES,QAAUR,EAAKS,IAAML,EAE3B/B,GADQpE,KAAKyG,MAAMH,EAAG7C,IACL,EAAIzD,KAAK0G,IAAO,EAAI,GAAK,GAC1C,EAAE/D,EAAC,EAAET,EAAC,EAAEW,GAAMwB,EAASD,EAAK,EAAK,IACjC7B,EAAG,IAAAvG,OAAO2G,EAAEkB,SAAS,IAAI8C,SAAS,EAAG,MAAI3K,OAAGkG,EAAE2B,SAAS,IAAI8C,SAAS,EAAG,MAAI3K,OAAG6G,EAAEgB,SAAS,IAAI8C,SAAS,EAAG,MAC/G5B,EAAcxC,EAAI,EA0Bd0C,YAAca,IACRd,GACJC,GAAa,EACbvI,SAAA,EAEFC,EAAAA,EAAAA,KAAA,OACEb,MAAO,CACLgE,MAAO,OACP7C,OAAQ,OACR2J,aAAc,MACdC,WACE,0EACFC,WAAY,sDACZC,KAAM,0DAGVpK,EAAAA,EAAAA,KAAA,OACEb,MAAO,CACL8J,SAAU,WACVS,KAAK,GAADrK,OAAK,GAAK,GAAKgE,KAAKgH,IAAwB,EAApBtC,EAASI,GAAOtC,EAAQxC,KAAK0G,IAAG,KAC5DF,IAAI,GAADxK,OAAK,GAAK,GAAKgE,KAAKiH,IAAwB,EAApBvC,EAASI,GAAOtC,EAAQxC,KAAK0G,IAAG,KAC3D5G,MAAO,OACP7C,OAAQ,OACR2J,aAAc,MACdM,gBAAiBpC,EACjBqC,OAAQ,kBACRC,UAAW,0BACXC,UAAW,+BAIjB1K,EAAAA,EAAAA,KAAA,OAAKb,MAAO,CAAEwL,SAAU,QAAS5K,SAAEuE,KACnCzE,EAAAA,EAAAA,MAAA,OAAKV,MAAO,CAAEwL,SAAU,OAAQzB,QAAS,GAAK0B,WAAY,aAAc7K,SAAA,CACrE8K,OAAOrC,EAAIxC,GAAGgE,SAAS,EAAG,KAAK,MAAIa,OAAOrC,EAAIjD,GAAGyE,SAAS,EAAG,KAAK,MAAIa,OAAOrC,EAAItC,GAAG8D,SAAS,EAAG,UAIzG,CCjFe,SAASc,EAAYxN,GAkBC,IAlBA,SACnCyN,EAAQ,YACRC,EAAW,OACXC,EAAM,UACNC,EAAS,YACTC,EAAW,eACXC,EAAc,aACdC,EAAY,gBACZC,EAAe,cACfC,EAAa,iBACbC,EAAgB,YAChBnD,EAAW,eACXoD,EAAc,aACdC,EAAY,gBACZC,EAAe,aACfC,EAAY,iBACZC,EAAgB,SAChBjK,GACkBtE,EAClB,MAAOwO,EAAUC,IAAe9N,EAAAA,EAAAA,WAAS,GACnC+N,GAAaC,EAAAA,EAAAA,cAAY,IAAMF,GAAaG,IAAOA,KAAI,IACvDC,GAAUvO,EAAAA,EAAAA,QAAuB,OAGvCU,EAAAA,EAAAA,YAAU,KACR,IAAKwN,EAAU,OACf,MAAMM,EAAWjD,IACXgD,EAAQzN,UAAYyN,EAAQzN,QAAQ2N,SAASlD,EAAEmD,SACjDP,GAAY,EAAM,EAGtB,OADAQ,SAAS5M,iBAAiB,YAAayM,GAChC,IAAMG,SAAS3M,oBAAoB,YAAawM,EAAQ,GAC9D,CAACN,IAEJ,MAAMU,EAAe3I,EAAMI,MAAQ,GAG5BsE,EAAekE,IAAoBxO,EAAAA,EAAAA,UAAgC,MAGpEyO,GAAuB9O,EAAAA,EAAAA,QAAe,GAEtC+O,GAAkBV,EAAAA,EAAAA,cAAY,CAAC9C,EAAejB,EAA2B0E,KAC7E,MAAMxD,EAAOwD,EAAatD,wBACpBC,EAAUH,EAAKM,KAAON,EAAKjG,MAAQ,EACnCqG,EAAUJ,EAAKS,IAAMT,EAAK9I,OAAS,EACnCwG,EAAIqC,EAAEM,QAAUF,EAChBI,EAAIR,EAAES,QAAUJ,EAEhB/B,GADQpE,KAAKyG,MAAMH,EAAG7C,IACL,EAAIzD,KAAK0G,IAAO,EAAI,GAAK,GAC1C,EAAE/D,EAAC,EAAET,EAAC,EAAEW,GAAMwB,EAASD,EAAK,EAAK,IACjC7B,EAAG,IAAAvG,OAAO2G,EAAEkB,SAAS,IAAI8C,SAAS,EAAG,MAAI3K,OAAGkG,EAAE2B,SAAS,IAAI8C,SAAS,EAAG,MAAI3K,OAAG6G,EAAEgB,SAAS,IAAI8C,SAAS,EAAG,MAE7F,QAAd9B,EACFsD,EAAiB5F,GAEjB0F,EAAgB1F,GAElB6F,GAAe,EAAM,GACpB,CAACD,EAAkBF,EAAiBG,KAEvCnN,EAAAA,EAAAA,YAAU,KACR,IAAKiK,EAAe,OAGpBgE,SAASM,KAAK1N,MAAMwB,OAAS,kBAE7B,MAAMmM,EAAmB3D,IACvB,MAAMyD,EAAeL,SAAS3N,cAAc,gBAADS,OAAiBkJ,EAAa,OACrEqE,GACFD,EAAgBxD,EAAGZ,EAAeqE,EACpC,EAGIG,EAAgBA,KACpBN,EAAiB,KAAK,EAMxB,OAHAF,SAAS5M,iBAAiB,YAAamN,GACvCP,SAAS5M,iBAAiB,UAAWoN,GAE9B,KACLR,SAAS3M,oBAAoB,YAAakN,GAC1CP,SAAS3M,oBAAoB,UAAWmN,GAExCR,SAASM,KAAK1N,MAAMwB,OAAS,EAAE,CAChC,GACA,CAAC4H,EAAeoE,IAGnB,MAAMK,GAAkBC,EAAAA,EAAAA,UAAQ,KAC9B,MAAMC,EAAkB,GAExB,IAAKxB,EAEH,MAAM,6BAANrM,OAAoCkM,EAAa,MAAAlM,OAAKgM,EAAY,KAIpE,MAAM8B,EAAQpF,EAASsD,GAGvB,IAAI+B,EAFUrF,EAASwD,GAER1F,EACXwH,EAAKF,EAAMtH,EAGf,GAAqC,IAAjC6G,EAAqBhO,QAAe,CAEtC,MAAM4O,EAAOD,EAAKD,EACZG,EAAcD,EAAO,EAAIA,EAAO,EAAIA,EAAO,EACjDZ,EAAqBhO,QAAU2E,KAAKmK,IAAIF,GAAQjK,KAAKmK,IAAID,GAAe,GAAK,CAC/E,EAGsC,IAAlCb,EAAqBhO,UAEnB2O,EAAKD,EACPA,GAAM,EAENC,GAAM,GAKV,IAAK,IAAI9M,EAAI,EAAGA,GAAK,GAAIA,IAAK,CAC5B,MAAMwE,EAAIxE,EAAI,GACd,IAAIsF,EAAIuH,GAAMC,EAAKD,GAAMrI,EACzB,KAAOc,EAAI,GAAGA,GAAK,EACnB,KAAOA,EAAI,GAAGA,GAAK,EAGnB,MAAMU,EAAI,EACJC,EAAI,IAEJ,EAAER,EAAC,EAAET,EAAC,EAAEW,GAAMwB,EAAS7B,EAAGU,EAAGC,GAC7BZ,EAAG,IAAAvG,OAAO2G,EAAEkB,SAAS,IAAI8C,SAAS,EAAG,MAAI3K,OAAGkG,EAAE2B,SAAS,IAAI8C,SAAS,EAAG,MAAI3K,OAAG6G,EAAEgB,SAAS,IAAI8C,SAAS,EAAG,MAC/GkD,EAAMO,KAAK,GAADpO,OAAIuG,EAAG,KAAAvG,OAAQ,IAAJ0F,EAAO,KAC9B,CAEA,MAAM,6BAAN1F,OAAoC6N,EAAMQ,KAAK,MAAK,OACnD,CAACrC,EAAcE,EAAeG,IAEjC,OACE7L,EAAAA,EAAAA,MAAA,OAAKC,UAAU,qBAAqBU,IAAK2L,EAAQpM,SAAA,EAC/CC,EAAAA,EAAAA,KAAA,UACEC,KAAK,SACLH,UAAU,wBACVI,QAAS8L,EACT,aAAYF,EAAW,YAAc,YACrC,eAAcA,EAAS/L,SAEtB+L,EAAW,SAAM,WAEnBA,IACCjM,EAAAA,EAAAA,MAAA,OAAKC,UAAU,iBAAiBX,MAAO,CAAEwO,UAAW,OAAQC,UAAW,QAAS7N,SAAA,EAE9EF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0BAAyBC,SAAA,EACtCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2BAA0BC,UACvCF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0BAAyBC,SAAA,CAAC,UAAQgL,QAEnD/K,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wBAAuBC,UACpCC,EAAAA,EAAAA,KAAA,SACEF,UAAU,mBACVG,KAAK,QACLyG,IAAK,EACLK,IAAKyF,EACLqB,KAAM,EACNC,MAAO/C,EACPgD,SAAW5E,IACT6B,UHtKOkB,GGsKe/C,EAAEmD,OAAOwB,MHtKDE,EGsKWxB,EHrKlDN,GAD2B+B,EGsKoB,GHrKtCA,EAAK/B,EAAI8B,EAAKA,EAAK9B,IAD9B,IAAkBA,EAAW+B,EAAYD,CGuK/B,EACD,aAAW,2BAKfpM,IACA5B,EAAAA,EAAAA,KAAA,OAAKF,UAAU,0BAAyBC,UACtCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wBAAuBC,UACpCF,EAAAA,EAAAA,MAAA,SACEV,MAAO,CACL0J,QAAS,OACTE,WAAY,SACZC,IAAK,EACLrI,OAAQ,kBACRZ,SAAA,EAEFC,EAAAA,EAAAA,KAAA,SACEC,KAAK,WACLH,UAAU,qBACVoO,QAAStC,EACTmC,SAAUlC,KAEZ7L,EAAAA,EAAAA,KAAA,QAAMb,MAAO,CAAEwL,SAAU,GAAIzB,QAAS,IAAMnJ,SAAC,4BAQrDF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0BAAyBC,SAAA,EAEtCC,EAAAA,EAAAA,KAAA,OACEF,UAAU,wBACVX,MAAO,CAAEgP,aAAc,IAAKpO,UAE5BF,EAAAA,EAAAA,MAAA,SACEV,MAAO,CACL0J,QAAS,OACTE,WAAY,SACZC,IAAK,EACLrI,OAAQ,kBACRZ,SAAA,EAEFC,EAAAA,EAAAA,KAAA,SACEC,KAAK,WACLH,UAAU,qBACVoO,QAAS7F,EACT0F,SAAW5E,GAAMsC,EAAetC,EAAEmD,OAAO4B,YAE3ClO,EAAAA,EAAAA,KAAA,QAAMb,MAAO,CAAEwL,SAAU,GAAIzB,QAAS,IAAMnJ,SAAC,6BAMjDC,EAAAA,EAAAA,KAAA,OACEF,UAAU,wBACVX,MAAO,CAAEgP,aAAc,IAAKpO,UAE5BF,EAAAA,EAAAA,MAAA,SACEV,MAAO,CACL0J,QAAS,OACTE,WAAY,SACZC,IAAK,EACLrI,OAAQ,kBACRZ,SAAA,EAEFC,EAAAA,EAAAA,KAAA,SACEC,KAAK,WACLH,UAAU,qBACVoO,QAASxC,EACTqC,SAAW5E,GAAMwC,EAAgBxC,EAAEmD,OAAO4B,YAE5ClO,EAAAA,EAAAA,KAAA,QAAMb,MAAO,CAAEwL,SAAU,GAAIzB,QAAS,IAAMnJ,SAAC,wBAKjDF,EAAAA,EAAAA,MAAA,OAAKV,MAAO,CAAE0J,QAAS,OAAQuF,eAAgB,eAAgBpF,IAAK,OAAQmF,aAAc,OAAQpO,SAAA,EAChGC,EAAAA,EAAAA,KAACiI,EAAU,CACTC,UAAU,MACVC,MAAOoD,EACPnD,cAAgBxC,IACd4F,EAAiB5F,GACjB6F,GAAe,EAAM,EAEvBnH,MAAM,MACN+D,YAAaA,EACbC,YAAaA,IAAMmE,EAAiB,OACpClE,cAAeA,KAEjBvI,EAAAA,EAAAA,KAACiI,EAAU,CACTC,UAAU,OACVC,MAAOkD,EACPjD,cAAgBxC,IACd0F,EAAgB1F,GAChB6F,GAAe,EAAM,EAEvBnH,MAAM,OACN+D,YAAaA,EACbC,YAAaA,IAAMmE,EAAiB,QACpClE,cAAeA,QAGnBvI,EAAAA,EAAAA,KAAA,OAAKb,MAAO,CAAEkP,UAAW,OAAQtO,UAC/BC,EAAAA,EAAAA,KAAA,OACEb,MAAO,CACLgE,MAAO,OACP7C,OAAQ,OACR4J,WAAY8C,EACZ/C,aAAc,OAEhBrJ,MAAM,iCAKZf,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0BAAyBC,SAAA,EACtCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2BAA0BC,UACvCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,0BAAyBC,SAAC,oBAE3CC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wBAAuBC,UACpCC,EAAAA,EAAAA,KAAA,UACEF,UAAU,mBACVgO,MAAO3C,EACP4C,SAAW5E,GAAMiC,EAAejC,EAAEmD,OAAOwB,OACzC,aAAW,eAAc/N,SAExBuO,OAAOC,QAAQlK,GAAqBhE,KAAImO,IAAA,IAAE3H,EAAGV,GAAEqI,EAAA,OAC9CxO,EAAAA,EAAAA,KAAA,UAAgB8N,MAAOjH,EAAE9G,SACtBoG,EAAE7B,OADQuC,EAEJ,SAIf7G,EAAAA,EAAAA,KAAA,OAAKF,UAAU,2BAA2BX,MAAO,CAAEkP,UAAW,IAAKtO,UACjEF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0BAAyBC,SAAA,CAAC,WAC9BsD,KAAK4D,MAAe,IAATgE,GAAc,UAGtCjL,EAAAA,EAAAA,KAAA,OAAKF,UAAU,wBAAuBC,UACpCC,EAAAA,EAAAA,KAAA,SACEF,UAAU,mBACVG,KAAK,QACLyG,IAAK,EACLK,IAAK,EACL8G,KAAM,IACNC,MAAO7C,EACP8C,SAAW5E,GAAM+B,GAAW/B,EAAEmD,OAAOwB,OACrC,aAAW,uBAKjB9N,EAAAA,EAAAA,KAAA,OAAKF,UAAU,0BAAyBC,UACtCF,EAAAA,EAAAA,MAAA,UACEI,KAAK,SACLH,UAAU,sBACVI,QAASA,IAAMR,OAAO+O,SAASC,SAC/B,aAAW,YAAW3O,SAAA,EAEtBC,EAAAA,EAAAA,KAAA,OACE2O,IAAKC,EACLC,IAAI,YACJ/O,UAAU,8BAEZE,EAAAA,EAAAA,KAAA,QAAAD,SAAM,wBAOpB,C,cCjXO,MAAM+O,EAAuBC,WAAAA,GAAA,KAC1BC,aAAoC,KAAK,KACzCC,SAAgC,KAAK,KACrCC,UAA+B,KAAK,KACpCC,WAAY,CAAM,CAM1BC,OAAAA,CAAQC,GACN,GAAIC,KAAKH,UAAW,OAAO,EAE3B,IAEE,MAAMI,EAAoB7P,OAAO8P,cAAgB9P,OAAO+P,mBAExD,IAAKF,EAEH,OADAG,QAAQC,KAAK,gDACN,EAGTL,KAAKN,aAAe,IAAIO,EACxBD,KAAKL,SAAWK,KAAKN,aAAaY,iBAClCN,KAAKL,SAASY,QAAU,IACxBP,KAAKL,SAASa,sBAAwB,IAatC,OAXeR,KAAKN,aAAae,yBAAyBV,GACnDD,QAAQE,KAAKL,UAAUG,QAAQE,KAAKN,aAAagB,aAExDV,KAAKJ,UAAY,IAAIe,WAAWX,KAAKL,SAASiB,mBAC9CZ,KAAKH,WAAY,EAGe,cAA5BG,KAAKN,aAAamB,OACpBb,KAAKN,aAAaoB,UAGb,CACT,CAAE,MAAOC,GAEP,OADAX,QAAQC,KAAK,+CAAgDU,IACtD,CACT,CACF,CAMAC,YAAAA,GACE,IAAKhB,KAAKL,WAAaK,KAAKJ,UAAW,OAAO,EAE9C,IAEEI,KAAKL,SAASsB,sBAAsBjB,KAAKJ,WAGzC,IAAIsB,EAAM,EACV,IAAK,IAAIjQ,EAAI,EAAGA,EAAI+O,KAAKJ,UAAUnJ,OAAQxF,IAAK,CAC9C,MAAMkQ,GAAcnB,KAAKJ,UAAU3O,GAAK,KAAO,IAC/CiQ,GAAOC,EAAaA,CACtB,CAEA,MAAMC,EAAMrN,KAAKC,KAAKkN,EAAMlB,KAAKJ,UAAUnJ,QAG3C,OAAO1C,KAAKqD,IAAI,EAAS,EAANgK,EACrB,CAAE,MAAOL,GAEP,OADAX,QAAQC,KAAK,4CAA6CU,GACnD,CACT,CACF,CAMAM,eAAAA,CAAgBC,GACd,IAAKtB,KAAKL,WAAaK,KAAKJ,UAC1B,OAAO,IAAI2B,MAAMD,GAAUE,KAAK,GAGlC,IAEExB,KAAKL,SAASsB,sBAAsBjB,KAAKJ,WAEzC,MAAM6B,EAAiB,GACjBlD,EAAOxK,KAAK2N,MAAM1B,KAAKJ,UAAUnJ,OAAS6K,GAEhD,IAAK,IAAIrQ,EAAI,EAAGA,EAAIqQ,EAAUrQ,IAAK,CACjC,MAAM0Q,EAAQ1Q,EAAIsN,EAEZ4C,EAAapN,KAAKmK,KAAK8B,KAAKJ,UAAU+B,GAAS,KAAO,KAE5DF,EAAKtD,KAAKpK,KAAKqD,IAAI,EAAgB,IAAb+J,GACxB,CAEA,OAAOM,CACT,CAAE,MAAOV,GAEP,OADAX,QAAQC,KAAK,2CAA4CU,GAClD,IAAIQ,MAAMD,GAAUE,KAAK,EAClC,CACF,CAKAV,MAAAA,GACMd,KAAKN,cAA4C,cAA5BM,KAAKN,aAAamB,OACzCb,KAAKN,aAAaoB,SAASc,OAAOb,IAChCX,QAAQC,KAAK,mDAAoDU,EAAI,GAG3E,CAKAc,UAAAA,GACM7B,KAAKN,eACPM,KAAKN,aAAaoC,QAAQF,OAAM,SAGhC5B,KAAKN,aAAe,MAEtBM,KAAKL,SAAW,KAChBK,KAAKJ,UAAY,KACjBI,KAAKH,WAAY,CACnB,CAEAkC,WAAAA,GACE,OAAO/B,KAAKH,SACd,EC9HK,SAASmC,EAAmBC,GACjC,MAAOpG,EAAaC,IAAkBnN,EAAAA,EAAAA,UACpC4D,EAAcE,OAETkJ,EAAQC,IAAajN,EAAAA,EAAAA,UAAS,GAG/BuT,GAAYvE,EAAAA,EAAAA,UAAQ,KACxB,MAAMwE,EAAQ,IAAIC,EAAAA,EAChBrN,EAAoBxC,EAAcE,MAAMwC,KACxC,GAGF,OADAkN,EAAME,QAAU,OACTF,CAAK,GACX,IAEGG,GAAa3E,EAAAA,EAAAA,UACjB,IAAM,IAAIyE,EAAAA,EAAchN,GAAiB,IACzC,IAIImN,GAAuBjU,EAAAA,EAAAA,QAAsC,MAC7DkU,GAAqBlU,EAAAA,EAAAA,QAAiBiT,MAAM,IAAIC,KAAK,KACpDtT,EAAiBuU,IAAsB9T,EAAAA,EAAAA,UAC5C4S,MAAM,IAAIC,KAAK,IAEXkB,GAA2BpU,EAAAA,EAAAA,QAAO,IAGxCU,EAAAA,EAAAA,YAAU,KACRkT,EAAUvG,OAASA,CAAM,GACxB,CAACA,EAAQuG,IAGZ,MAAMS,GAAgBrU,EAAAA,EAAAA,SAAO,IAC7BU,EAAAA,EAAAA,YAAU,KACR,GAAI2T,EAAcvT,QAEhB,YADAuT,EAAcvT,SAAU,GAI1B,MAAMwT,EAAS7N,EAAoB8G,GAE7BgH,GAAqBX,EAAUY,OAGrCZ,EAAUa,UAAUH,EAAO3N,IAAK,CAAE+N,SAAUH,IAAqBjB,OAAM,QAAU,GAChF,CAAC/F,EAAaqG,IAIjB,MAAMe,GAAoBtG,EAAAA,EAAAA,cAAY,KAAO,IAADuG,GL1CvC,SAAoCC,GACzC,IACE,IAAKC,OAAOC,SAASF,IAAYA,EAAU,EAAG,OAC9CG,aAAaC,QAAQzO,EAAgByG,OAAO4H,GAC9C,CAAE,MAAAK,GAAO,CACX,CKsCIC,CAAgD,QAAtBP,EAAChB,EAAUwB,mBAAW,IAAAR,EAAAA,EAAI,EAAE,GACrD,CAAChB,KAEJlT,EAAAA,EAAAA,YAAU,KACR,IAAKiT,EAAY,OACjB,MAAM0B,EAAKvT,OAAOwT,YAAYX,EAAmB,KAC3CY,EAAaA,IAAMZ,IACnBa,EAAeA,KACc,WAA7B7G,SAAS8G,iBAA8Bd,GAAmB,EAIhE,OAFA7S,OAAOC,iBAAiB,WAAYwT,GACpC5G,SAAS5M,iBAAiB,mBAAoByT,GACvC,KACLE,cAAcL,GACdvT,OAAOE,oBAAoB,WAAYuT,GACvC5G,SAAS3M,oBAAoB,mBAAoBwT,EAAa,CAC/D,GACA,CAAC7B,EAAYgB,KAGhBjU,EAAAA,EAAAA,YACE,IAAM,KAAO,IAADiV,EACVhB,IACAf,EAAUgC,QACVhC,EAAUvG,OAAS,EACnBuG,EAAUiC,QACV7B,EAAW4B,QACX5B,EAAW3G,OAAS,EACpB2G,EAAW6B,QACiB,QAA5BF,EAAA1B,EAAqBnT,eAAO,IAAA6U,GAA5BA,EAA8BpC,aAC9BU,EAAqBnT,QAAU,IAAI,GAErC,CAAC8S,EAAWI,EAAYW,IAI1B,MAAMmB,GAAYzH,EAAAA,EAAAA,cAAY,KAC5B,IACE2F,EAAW3G,OAAS,EACpB2G,EAAWoB,YAAc,EACzBpB,EAAW6B,QACX7B,EAAW+B,MACb,CAAE,MAAAC,GAAQ,IACT,CAAChC,IAEEiC,GAA2B5H,EAAAA,EAAAA,cAAY,KAC3C,MAAMlH,ELpGH,WACL,IACE,MAAM+O,EAAMlB,aAAamB,QAAQ3P,GACjC,IAAK0P,EAAK,OAAO,EACjB,MAAM5H,EAAIwG,OAAOoB,GACjB,OAAOpB,OAAOC,SAASzG,IAAMA,GAAK,EAAIA,EAAI,CAC5C,CAAE,MAAA0H,GACA,OAAO,CACT,CACF,CK2FcI,GACV,IACE,MAAMC,EAAOzC,EAAkBvS,SAC/BuS,EAAUwB,YACO,kBAARiB,GAAoBvB,OAAOC,SAASsB,IAAQA,EAAM,EACrDlP,EAAIkP,EACJlP,CACR,CAAE,MAAA+N,GAAQ,IACT,CAACtB,IAEE0C,GAAiBjI,EAAAA,EAAAA,cAAY,KAC7B4F,EAAqBnT,UACvBoT,EAAmBpT,QACjBmT,EAAqBnT,QAAQiS,gBAAgB,MACzCqB,EAAyBtT,SAAW,IACxCqT,EAAmBD,EAAmBpT,SACtCsT,EAAyBtT,QAAU,GAEvC,GACC,IAEGyV,GAA8BlI,EAAAA,EAAAA,cAAY,KAC9C,IAAK4F,EAAqBnT,QAAS,CACjC,MAAM0V,EAAW,IAAItF,EAErB,GADkBsF,EAAShF,QAAQoC,GAEjCK,EAAqBnT,QAAU0V,MAC1B,CAEL,MAAMC,EAAYA,MACXxC,EAAqBnT,SAAW0V,EAAShF,QAAQoC,KACpDK,EAAqBnT,QAAU0V,GAEjC5C,EAAU5R,oBAAoB,UAAWyU,EAAU,EAErD7C,EAAU7R,iBAAiB,UAAW0U,EAAW,CAAEC,MAAM,GAC3D,CACF,IACC,CAAC9C,IAEE+C,GAA0BtI,EAAAA,EAAAA,cAAY,KAAO,IAADuI,EACpB,QAA5BA,EAAA3C,EAAqBnT,eAAO,IAAA8V,GAA5BA,EAA8BpE,QAAQ,GACrC,IAYH,OATA9R,EAAAA,EAAAA,YAAU,KACR,IAAKiT,EAAY,OACjB,MAAMkD,EAAaA,KAAO,IAADC,EACK,QAA5BA,EAAA7C,EAAqBnT,eAAO,IAAAgW,GAA5BA,EAA8BtE,QAAQ,EAGxC,OADAoB,EAAU7R,iBAAiB,OAAQ8U,GAC5B,IAAMjD,EAAU5R,oBAAoB,OAAQ6U,EAAW,GAC7D,CAAClD,EAAYC,IAET,CACLrG,cACAC,iBACAH,SACAC,YACAsG,YACAI,aACApU,kBACAqU,uBACA6B,YACAG,2BACAK,iBACAC,8BACAI,0BAEJ,CCpJA,SAASI,EACPC,EACAC,EACAC,EACAC,GAEA,MAAMC,EAAM,IAAIC,YAAY,KAE5B,IAAKF,EAAa,CAEhB,MAAMG,EAASvP,EAASiP,GAClBO,EAAUxP,EAASkP,GAEzB,IAAK,IAAItU,EAAI,EAAGA,EAAI,MAAOA,EAAG,CAC5B,MAAMwE,EAAIxE,EAAI,IACRyF,EAAI3C,KAAK4D,MAAMiO,EAAOlP,GAAKmP,EAAQnP,EAAIkP,EAAOlP,GAAKjB,GACnDQ,EAAIlC,KAAK4D,MAAMiO,EAAO3P,GAAK4P,EAAQ5P,EAAI2P,EAAO3P,GAAKR,GACnDmB,EAAI7C,KAAK4D,MAAMiO,EAAOhP,GAAKiP,EAAQjP,EAAIgP,EAAOhP,GAAKnB,GACzDiQ,EAAIzU,IAAO,KAAO,GAAO2F,GAAK,GAAOX,GAAK,EAAKS,KAAO,CACxD,CACA,OAAOgP,CACT,CAGA,MAAM7H,EAAQpF,EAAS6M,GACjBQ,EAAQrN,EAAS8M,GAEvB,IAAIzH,EAAKD,EAAMtH,EACXwH,EAAK+H,EAAMvP,EAGf,GAA6B,IAAzBiP,EAAapW,QAAe,CAC9B,MAAM4O,EAAOD,EAAKD,EACZG,EAAcD,EAAO,EAAIA,EAAO,EAAIA,EAAO,EACjDwH,EAAapW,QAAU2E,KAAKmK,IAAIF,GAAQjK,KAAKmK,IAAID,GAAe,GAAK,CACvE,EAG8B,IAA1BuH,EAAapW,UACX2O,EAAKD,EACPA,GAAM,EAENC,GAAM,GAIV,IAAK,IAAI9M,EAAI,EAAGA,EAAI,MAAOA,EAAG,CAE5B,IAAIsF,EAAIuH,GAAMC,EAAKD,IADT7M,EAAI,KAEd,KAAOsF,EAAI,GAAGA,GAAK,EACnB,KAAOA,EAAI,GAAGA,GAAK,EAGnB,MAAMU,EAAI,EACJC,EAAI,IAEJ,EAAER,EAAC,EAAET,EAAC,EAAEW,GAAMwB,EAAS7B,EAAGU,EAAGC,GACnCwO,EAAIzU,IAAO,KAAO,GAAO2F,GAAK,GAAOX,GAAK,EAAKS,KAAO,CACxD,CACA,OAAOgP,CACT,CAEA,SAASrP,EAASC,GAChB,MAAM6C,EAAS,4CAA4CC,KAAK9C,GAChE,OAAO6C,EACH,CACEzC,EAAG2C,SAASF,EAAO,GAAI,IACvBlD,EAAGoD,SAASF,EAAO,GAAI,IACvBvC,EAAGyC,SAASF,EAAO,GAAI,KAEzB,CAAEzC,EAAG,EAAGT,EAAG,EAAGW,EAAG,EACvB,CAEA,MAAMmP,EA/FN,WACE,MAAMC,EAAOjS,KAAKkS,SASZC,GAAQF,GANQ,IAE0B,GAAbjS,KAAKkS,WAGtBlS,KAAKkS,SAAW,GAAM,GAAK,GACC,GAAK,EAE7CE,EAAS/N,EAAS4N,EAAM,EAAK,IAC7BI,EAAShO,EAAS8N,EAAM,EAAK,IAKnC,MAAO,CAAEG,IAHC,IAAAtW,OAAOoW,EAAOzP,EAAEkB,SAAS,IAAI8C,SAAS,EAAG,MAAI3K,OAAGoW,EAAOlQ,EAAE2B,SAAS,IAAI8C,SAAS,EAAG,MAAI3K,OAAGoW,EAAOvP,EAAEgB,SAAS,IAAI8C,SAAS,EAAG,MAGjH4L,KAFV,IAAAvW,OAAOqW,EAAO1P,EAAEkB,SAAS,IAAI8C,SAAS,EAAG,MAAI3K,OAAGqW,EAAOnQ,EAAE2B,SAAS,IAAI8C,SAAS,EAAG,MAAI3K,OAAGqW,EAAOxP,EAAEgB,SAAS,IAAI8C,SAAS,EAAG,MAGvI,CA4EsB6L,GAChBC,EAAsBzS,KAAKkS,SAAW,ICnFrC,SAASQ,EAAQ7J,GACtB,OAAOA,EAAI,EAAI,EAAIA,EAAI,EAAI,EAAIA,CACjC,CAMO,SAAS8J,EAAaC,GAC3B,MAAMC,EAAQ7S,KAAKkS,SAAWlS,KAAK0G,GAAK,EAClC/D,EAAI3C,KAAKkS,SAAWU,EAC1B,MAAO,CAAEnP,EAAGzD,KAAKgH,IAAI6L,GAASlQ,EAAG2D,EAAGtG,KAAKiH,IAAI4L,GAASlQ,EACxD,CAGO,SAASmQ,EACdvO,EACAzE,EACA7C,GAEIsH,EAAEd,EAAI,GACRc,EAAEd,EAAI,EACNc,EAAEwO,KAAO,IACAxO,EAAEd,EAAI3D,IACfyE,EAAEd,EAAI3D,EACNyE,EAAEwO,KAAO,IAGPxO,EAAE+B,EAAI,GACR/B,EAAE+B,EAAI,EACN/B,EAAEyO,KAAO,IACAzO,EAAE+B,EAAIrJ,IACfsH,EAAE+B,EAAIrJ,EACNsH,EAAEyO,KAAO,GAEb,CAEO,SAASC,EACdC,EACApT,EACA7C,GAEA,IAAK,IAAIC,EAAI,EAAGA,EAAIgW,EAAUxQ,OAAQxF,IACpC4V,EAAeI,EAAUhW,GAAI4C,EAAO7C,EAExC,CAaO,SAASkW,EACdrT,EACA7C,EACAmW,EACA3T,GAEA,MAAMyT,EAAwB,GACxBG,EAAoBrT,KAAK2N,MAAMyF,EAAQlT,EAAOC,OAC9CmT,EToGD,SAA4B7T,GACjC,OAAOS,EAAOE,YAAcX,CAC9B,CStGsB8T,CAAmB9T,GAEvC,IAAK,IAAIvC,EAAI,EAAGA,EAAIgD,EAAOC,MAAOjD,IAAK,CACrC,MAAMgJ,EAAUlG,KAAKkS,SAAWpS,EAC1BqG,EACJnG,KAAKkS,SAAWhS,EAAOG,cACnBL,KAAKkS,SAAWjV,EAAS,GAChB,GAATA,EAAe+C,KAAKkS,SAAWjV,EAAS,GAExCuW,EAAYxT,KAAKkS,SACvB,IAAK,IAAIuB,EAAI,EAAGA,EAAIJ,EAAmBI,IAAK,CAC1C,MAAMC,EAASf,EAAaW,GAC5BJ,EAAU9I,KAAK,CACb3G,EAAGyC,EAAUwN,EAAOjQ,EACpB6C,EAAGH,EAAUuN,EAAOpN,EACpByM,GAAI,EACJC,GAAI,EACJW,KAAMH,GAEV,CACF,CAEA,KAAON,EAAUxQ,OAAS0Q,GACxBF,EAAU9I,KAAK,CACb3G,EAAGzD,KAAKkS,SAAWpS,EACnBwG,EAAGtG,KAAKkS,SAAWjV,EACnB8V,GAAI,EACJC,GAAI,EACJW,KAAM,IAIV,OAAOT,CACT,CAGO,SAASU,EAAwBrP,EAAasP,EAAYC,GAC/D,MAAMC,EAAgBxP,EAAEoP,KAAOpP,EAAEoP,KAAOG,EACxCvP,EAAEyO,KAAOnU,EAAIC,QAAUiV,GAAiBF,CAC1C,CAEO,SAASG,EAAczP,EAAasP,GACzC,MAAMvQ,EAAItD,KAAKiU,IAAIpV,EAAIG,SAAU6U,GACjCtP,EAAEwO,IAAMzP,EACRiB,EAAEyO,IAAM1P,CACV,CAEO,SAAS4Q,EAAU3P,EAAasP,GACrCtP,EAAEd,GAAKc,EAAEwO,GAAKc,EACdtP,EAAE+B,GAAK/B,EAAEyO,GAAKa,CAChB,CAEO,SAASM,EACd5P,EACA6P,EACAP,EACApU,EACA4U,GAEO,IADPC,EAAgBC,UAAA7R,OAAA,QAAA8R,IAAAD,UAAA,IAAAA,UAAA,GAEhB,MAAME,EAAKlQ,EAAEd,EAAI2Q,EAAW3Q,EACtBiR,EAAKnQ,EAAE+B,EAAI8N,EAAW9N,EACtBqO,EAAKF,EAAKA,EAAKC,EAAKA,EACpB/R,ETbD,SAAgClD,GACrC,OAAOZ,EAAIU,uBAAyBE,CACtC,CSWYmV,CAAuBnV,GAGjC,GAAIkV,EAFOhS,EAAIA,EAEF,CACX,MAEMkS,EAAwB,GAAXR,GADD,EADRrU,KAAKC,KAAK0U,IACO,EAAIhS,IACgBkR,EAC/CtP,EAAEoP,MAAQW,GAAWO,EAAaA,CACpC,CACF,CAEO,SAASC,EACdC,EACAC,EACAP,EACAC,EACAO,EACApB,EACAqB,GAEA,MAAMC,EAAQtW,EAAIS,mBAAqB,EAAI2V,GAAK,EAAIC,IAC9CE,EAAO,EAAIH,EACXI,EAAKZ,EAAKW,EAAOD,EAAQtB,EACzByB,EAAKZ,EAAKU,EAAOD,EAAQtB,EAE/BkB,EAAGhC,IAAMsC,EACTN,EAAG/B,IAAMsC,EACTN,EAAGjC,IAAMsC,EACTL,EAAGhC,IAAMsC,CACX,CAEO,SAASC,EACdR,EACAC,EACAnB,GAEA,MACM2B,GADWT,EAAGpB,KAAOqB,EAAGrB,MACA9U,EAAIM,gBAAkB0U,EACpDkB,EAAGpB,MAAQ6B,EACXR,EAAGrB,MAAQ6B,CACb,CAEO,SAASC,GACdlR,EACAtH,EACAyY,EACA7B,EACApU,EACA4U,GAEA,MAAMsB,EAAqB1Y,EAASsH,EAAE+B,EAChCsP,ET9ED,SAAmCnW,GACxC,OAAOZ,EAAIO,0BAA4BK,CACzC,CS4E6BoW,CAA0BpW,GAErD,GAAIkW,EAAqBC,EAAoB,CAC3C,MAAME,EAAY,EAAIH,GAAsB,EAAIC,GAEhD,YADArR,EAAEoP,MAAQU,EAAWyB,EAAYjC,EAEnC,CAEA,MAEMkC,EAAc,GADFL,EADG,EAC4BA,EAD5B,KAIfM,ETlGD,SAAyBvW,GAC9B,OAAOZ,EAAIK,eAAiBO,CAC9B,CSgGmBwW,CAAgBxW,GACjC8E,EAAEoP,MAAQqC,GAAY,GAAoB,GAAdD,GAAqBlC,CACnD,CAGO,SAASqC,GACdhD,EACApT,EACA7C,EACAkZ,EACA/B,EACAgC,EACAC,EACAC,GAEO,IADPC,EAAuBhC,UAAA7R,OAAA,QAAA8R,IAAAD,UAAA,IAAAA,UAAA,GAEvB,MAAMV,EAAK7T,KAAK0D,IAAI,EAAG1D,KAAKqD,IAAI,EAAKgT,IAC/B5W,EAAcI,EAAmBC,EAAO7C,GACxCiY,EAAiB1V,EAAsBC,GACvCqU,ETrID,SAAyBrU,GAC9B,OAAOZ,EAAIE,cAAgBU,CAC7B,CSmImB+W,CAAgB/W,GAC3B4U,ET9HD,SAAyB5U,GAC9B,OAAOZ,EAAII,eAAiBQ,CAC9B,CS4HmBgX,CAAgBhX,GAGjC,IAAK,IAAIvC,EAAI,EAAGA,EAAIgW,EAAUxQ,OAAQxF,IAAK,CACzC,MAAMqH,EAAI2O,EAAUhW,GAEpB0W,EAAwBrP,EAAGsP,EAAIC,GAC/BE,EAAczP,EAAGsP,GACjBK,EAAU3P,EAAGsP,GAETsC,GAAahC,EAAiB5P,EAAG6P,EAAYP,EAAIpU,EAAa4U,EAAUkC,GAE5EH,EAAelZ,GAAK,EACpB4V,EAAevO,EAAGzE,EAAO7C,EAC3B,CAGA,GAAW,IAAP4W,EAAU,CACZ,IAAK,IAAI3W,EAAI,EAAGA,EAAIgW,EAAUxQ,OAAQxF,IACpCgW,EAAUhW,GAAGyW,KAAOjB,EAAQQ,EAAUhW,GAAGyW,MAG3C,YADAV,EAAiBC,EAAWpT,EAAO7C,EAErC,CAGAqZ,EAAKI,MAAMjJ,MAAM,GACjB,MAAMkJ,EAAU,EAAIL,EAAKM,SAEzB,IAAK,IAAI1Z,EAAI,EAAGA,EAAIgW,EAAUxQ,OAAQxF,IAAK,CACzC,MAAMqH,EAAI2O,EAAUhW,GAEpB,IAAIiF,EAAMoC,EAAEd,EAAIkT,EAAW,EACvBvU,EAAMmC,EAAE+B,EAAIqQ,EAAW,EAEvBxU,EAAK,EAAGA,EAAK,EACRA,GAAMmU,EAAKjU,OAAMF,EAAKmU,EAAKjU,KAAO,GAEvCD,EAAK,EAAGA,EAAK,EACRA,GAAMkU,EAAKO,OAAMzU,EAAKkU,EAAKO,KAAO,GAE3C,MAAMC,EAAO7U,EAAUqU,EAAMnU,EAAIC,GACjCkU,EAAKS,KAAK7Z,GAAKoZ,EAAKI,MAAMI,GAC1BR,EAAKI,MAAMI,GAAQ5Z,CACrB,CAGA,MACM8Z,EADI9B,IAGV,IAAK,IAAIhY,EAAI,EAAGA,EAAIgW,EAAUxQ,OAAQxF,IAAK,CACzC,MAAM6X,EAAK7B,EAAUhW,GAErB,IAAIiF,EAAM4S,EAAGtR,EAAIkT,EAAW,EACxBvU,EAAM2S,EAAGzO,EAAIqQ,EAAW,EAExBxU,EAAK,EAAGA,EAAK,EACRA,GAAMmU,EAAKjU,OAAMF,EAAKmU,EAAKjU,KAAO,GAEvCD,EAAK,EAAGA,EAAK,EACRA,GAAMkU,EAAKO,OAAMzU,EAAKkU,EAAKO,KAAO,GAE3C,MAAMI,EAAK9U,EAAK,EAAIA,EAAK,EAAIA,EACvB+U,EAAK/U,EAAK,EAAImU,EAAKjU,KAAOF,EAAK,EAAIA,EACnCgV,EAAK/U,EAAK,EAAIA,EAAK,EAAIA,EACvBgV,EAAKhV,EAAK,EAAIkU,EAAKO,KAAOzU,EAAK,EAAIA,EAEzC,IAAK,IAAIiV,EAAKF,EAAIE,GAAMD,EAAIC,IAC1B,IAAK,IAAIC,EAAKL,EAAIK,GAAMJ,EAAII,IAAM,CAChC,IAAI7D,EAAI6C,EAAKI,MAAMzU,EAAUqU,EAAMgB,EAAID,IACvC,MAAc,IAAP5D,GAAU,CACf,GAAIA,EAAIvW,EAAG,CACT,MAAM8X,EAAK9B,EAAUO,GACfgB,EAAKO,EAAGvR,EAAIsR,EAAGtR,EACfiR,EAAKM,EAAG1O,EAAIyO,EAAGzO,EACfqO,EAAKF,EAAKA,EAAKC,EAAKA,EAE1B,GAAIC,EAAK,GAAKA,EAAKqC,EAAI,CACrBZ,EAAelZ,KACfkZ,EAAe3C,KAGfqB,EAAqBC,EAAIC,EAAIP,EAAIC,EADvB1U,KAAKC,KAAK0U,GACoBd,EAAIqB,GAC5CK,EAAoBR,EAAIC,EAAInB,EAC9B,CACF,CACAJ,EAAI6C,EAAKS,KAAKtD,EAChB,CACF,CAEJ,CAGA,IAAK,IAAIvW,EAAI,EAAGA,EAAIgW,EAAUxQ,OAAQxF,IAAK,CACzC,MAAMqH,EAAI2O,EAAUhW,GACpBuY,GAA4BlR,EAAGtH,EAAQmZ,EAAelZ,GAAI2W,EAAIpU,EAAa4U,GAC3E9P,EAAEoP,KAAOjB,EAAQnO,EAAEoP,KACrB,CAEAV,EAAiBC,EAAWpT,EAAO7C,EACrC,CCpUA,MAAMsa,IAA+B,KPiKrB,GOjKkB,GPiKN,GOjKG,GPiKS,EOjKZ,KPiKwB,EO3IpD,SAASC,GACPC,EACAhU,EACA6C,EACAoR,EACAC,EACAnV,EACAoV,GAEA,MAAMC,EAAO7X,KAAKqD,IAAIiD,EAAIoR,EAAIlV,GACxBsV,EAAO9X,KAAKqD,IAAII,EAAIiU,EAAIC,GAC9B,IAAK,IAAII,EAAKzR,EAAGyR,EAAKF,EAAME,IAAM,CAChC,IAAIvW,EAAMuW,EAAKJ,EAAIlU,EACnB,IAAK,IAAIuU,EAAKvU,EAAGuU,EAAKF,EAAME,IAC1BP,EAAOjW,KAASoW,CAEpB,CACF,CAKO,SAASK,GACdC,EACAhF,EACAiF,EACAC,EACAC,EACAC,GAEA,MAAMC,EAAY7Y,EAAOE,UAEnB4Y,EVuFD,SAA+B/Y,GACpC,OAAOC,EAAOC,qBAAuBF,CACvC,CUzFyBgZ,CADH5Y,EAAmBsY,EAAaC,IAE9CM,EAAwBF,EAAiBA,EACzCf,EAAS,IAAI7F,YAAYsG,EAAUS,KAAKC,QAG9CnB,EAAOhK,KAAK8J,IAEZ,MAAMzX,EAAQqY,EACRlb,EAASmb,EAEf,IAAK,IAAI9R,EAAI,EAAGA,EAAIrJ,EAAQqJ,GAAKgS,EAC/B,IAAK,IAAI7U,EAAI,EAAGA,EAAI3D,EAAO2D,GAAK6U,EAAW,CACzC,IAAIO,EAAe,EACfC,EAAU,EAGd,IAAK,IAAI5b,EAAI,EAAGA,EAAIgW,EAAUxQ,SAAUxF,EAAG,CACzC,MAAMqH,EAAI2O,EAAUhW,GACduX,EAAKhR,EAAIc,EAAEd,EACXiR,EAAKpO,EAAI/B,EAAE+B,EAEXyS,EAAYL,GADMjE,EAAKA,EAAKC,EAAKA,EACsB,GAE7DmE,GAAgBE,EAChBD,GAAWC,EAAYxU,EAAEoP,IAC3B,CAGA,GAAIkF,GAAgBN,EAAW,SAG/B,MAAM5E,EAAOmF,EAAUD,EAIvBrB,GAAmBC,EAAQhU,EAAG6C,EAAGgS,EAAWxY,EAAO7C,EAFjCob,EADH1E,GAAQ,EAAI,EAAIA,GAAQ,EAAI,IAAc,IAAPA,EAAc,GAIlE,CAEJ,CAKO,SAASqF,GACdC,EACAC,EACAhG,EACAiG,EACAd,GAEA,MAAMH,EAnGD,SACLe,EACAE,EACArZ,EACA7C,GAEA,MAAMmc,EAAMD,EAAS9d,QAIrB,OAHK+d,GAAOA,EAAItZ,QAAUA,GAASsZ,EAAInc,SAAWA,IAChDkc,EAAS9d,QAAU4d,EAAII,gBAAgBvZ,EAAO7C,IAEzCkc,EAAS9d,OAClB,CAwFoBie,CAAgBL,EAAKE,EAAUD,EAAOpZ,MAAOoZ,EAAOjc,QAChEqb,EVqDD,SACLxY,EACA7C,GAGA,MACMsc,GAHehF,UAAA7R,OAAA,QAAA8R,IAAAD,UAAA,GAAAA,UAAA,GAAG,GAEJ1U,EAAmBC,EAAO7C,GAE9C,OAAO+C,KAAK0D,IAAI,EAAG1D,KAAKqD,IAAI,GAAIrD,KAAK4D,MAAM2V,IAC7C,CU7DoBC,CAAiBN,EAAOpZ,MAAOoZ,EAAOjc,QAExDgb,GACEC,EACAhF,EACAgG,EAAOpZ,MACPoZ,EAAOjc,OACPob,EACAC,GAGFW,EAAIQ,aAAavB,EAAW,EAAG,EACjC,CCzGO,SAASwB,GAAazf,GASJ,IATK,UAC5B0f,EAAS,OACTC,EAAM,eACNC,EAAc,kBACdC,EAAiB,cACjBC,EAAa,SACbC,EAAQ,WACRC,EAAU,eACVpJ,GACoB5W,EACpB,MAAMigB,GAAe3f,EAAAA,EAAAA,QAAmB,IAClC4e,GAAW5e,EAAAA,EAAAA,QAAyB,MACpC4f,GAAoB5f,EAAAA,EAAAA,QAAoB,IAAI6f,YAAY,IACxDC,GAAmB9f,EAAAA,EAAAA,QAAsB,MACzC+f,GAAU/f,EAAAA,EAAAA,QAA2B,MACrCggB,GAAUhgB,EAAAA,EAAAA,QAAiC,CAAEod,EAAG,EAAGnV,EAAG,IACtDgY,GAASjgB,EAAAA,EAAAA,QAAsB,MAC/BkgB,GAAWlgB,EAAAA,EAAAA,QAAsC,CAAEmgB,KAAM,EAAGC,IAAK,KAGvE1f,EAAAA,EAAAA,YAAU,KACR,MAAMie,EAASS,EAAUte,QACzB,IAAK6d,EAAQ,OACb,MAAMvB,EAAItb,OAAOiC,WACfkE,EAAInG,OAAOue,YACbL,EAAQlf,QAAU,CAAEsc,IAAGnV,KACvB0W,EAAOpZ,MAAQ6X,EACfuB,EAAOjc,OAASuF,EAChBoX,EAAOve,QAAU6d,EAAO2B,WAAW,MACnC1B,EAAS9d,QAAU,IAAI,GACtB,CAACse,EAAWC,IAGf,MAAMkB,GAA0BlS,EAAAA,EAAAA,cAAY,KAC1C,MAAM,EAAE+O,EAAC,EAAEnV,GAAM+X,EAAQlf,QACQ,OAA7Bgf,EAAiBhf,UACnBgf,EAAiBhf,QFYhB,SAA8ByE,EAAe7C,GAClD,MAAM8C,EAAOD,EAAQ7C,EACfwC,EAAcI,EAAmBC,EAAO7C,GAGxC8d,EAAU/a,KAAK4D,MAAO7D,EAAOO,GAAwBb,EAAcA,IACzE,OAAOO,KAAKqD,IAAI0X,EAASxa,EAC3B,CEnBiCya,CAAqBrD,EAAGnV,IACrD,MAAM4Q,EAAQiH,EAAiBhf,QACzBoE,EAAcI,EAAmB8X,EAAGnV,GAC1C0X,EAAa7e,QAAU8X,EAAgBwE,EAAGnV,EAAG4Q,EAAO3T,GACpD0a,EAAkB9e,QAAU,IAAI+e,YAAYhH,GAC5C,MAAM8B,EAAiB1V,EAAsBC,ITyB1C,SACL6a,EACAxa,EACA7C,EACAmW,EACAwD,GAEA,MAAMvU,EAAOrC,KAAK0D,IAAI,EAAG1D,KAAKib,KAAKnb,EAAQ8W,IACrCC,EAAO7W,KAAK0D,IAAI,EAAG1D,KAAKib,KAAKhe,EAAS2Z,IACtCsE,EAAQ7Y,EAAOwU,EAEf3U,EAAIoY,EAAQjf,QAEf6G,GACDA,EAAEG,OAASA,GACXH,EAAE2U,OAASA,GACX3U,EAAE0U,WAAaA,GACf1U,EAAE6U,KAAKrU,SAAW0Q,GAClBlR,EAAEwU,MAAMhU,SAAWwY,IAEnBZ,EAAQjf,QAAU,CAChBub,WACAvU,OACAwU,OACAH,MAAO,IAAIyE,WAAWD,GACtBnE,KAAM,IAAIoE,WAAW/H,IAG3B,CSpDIgI,CAAWd,EAAS3C,EAAGnV,EAAG4Q,EAAO8B,EAAe,GAC/C,IAGGmG,GAAazS,EAAAA,EAAAA,cAAY,KAC7B,MAAM1G,EAAIoY,EAAQjf,SAChB,EAAEsc,EAAC,EAAEnV,GAAM+X,EAAQlf,QAChB6G,GACLgU,GACEgE,EAAa7e,QACbsc,EACAnV,EACAqX,EAAexe,QACf0e,EAAc1e,QACd8e,EAAkB9e,QAClB2e,EAAS3e,QACT6G,EACA4X,EAAkBze,QACnB,GACA,CAACwe,EAAgBE,EAAeC,EAAUF,IAGvCwB,GAAO1S,EAAAA,EAAAA,cAAY,KACvB,MAAMsQ,EAASS,EAAUte,QACvB4d,EAAMW,EAAOve,QACV6d,GAAWD,GAChBD,GACEC,EACAC,EACAgB,EAAa7e,QACb8d,EACAc,EAAW5e,QACZ,GACA,CAACse,EAAWC,EAAQK,IAGjBsB,GAAU3S,EAAAA,EAAAA,cACb4S,IACC,MAAMC,EAAQhB,EAASpf,QAClBogB,EAAMf,OAAMe,EAAMf,KAAOc,GAC9B,IAAIrX,EAAQqX,EAAMC,EAAMf,KACxBe,EAAMf,KAAOc,EACbC,EAAMd,KAAO3a,KAAKqD,IAAI,IAAKrD,KAAK0D,IAAI,EAAGS,IACvC,IAAI1C,EAAQ,EACZ,KAAOga,EAAMd,KAAO9Z,GAAYY,EAAQX,GACtCua,IACAI,EAAMd,KAAO9Z,EACbY,IAEEga,EAAMd,KAAO9Z,IAAU4a,EAAMd,IAAM,GAEvC9J,IACAyK,IACAd,EAAOnf,QAAUqgB,sBAAsBH,EAAQ,GAEjD,CAACD,EAAMD,EAAYxK,IAIf8K,GAAkB/S,EAAAA,EAAAA,cAAY,KAClCkS,IACAL,EAASpf,QAAU,CAAEqf,KAAM,EAAGC,IAAK,GACnCe,uBAAsB,IAAMJ,MAC5Bd,EAAOnf,QAAUqgB,sBAAsBH,EAAQ,GAC9C,CAACT,EAAyBQ,EAAMC,IAUnC,OAPAtgB,EAAAA,EAAAA,YACE,IAAM,KACmB,OAAnBuf,EAAOnf,SAAkBugB,qBAAqBpB,EAAOnf,QAAQ,GAEnE,IAGK,CACL6e,eACAK,UACApB,WACAwC,kBAEJ,CC3He,SAASE,KACtB,MAAMtd,EAAWX,IAGX+b,GAAYpf,EAAAA,EAAAA,QAA0B,MACtCqf,GAASrf,EAAAA,EAAAA,QAAwC,OAGhD2T,EAAY4N,IAAiBlhB,EAAAA,EAAAA,WAAS,IAItC8M,EAAUC,IAAe/M,EAAAA,EAAAA,UADR,GAElBof,GAAWzf,EAAAA,EAAAA,QAAegH,EAFR,KAIxBtG,EAAAA,EAAAA,YAAU,KACR+e,EAAS3e,QAAUkG,EAAamG,EAAS,GACxC,CAACA,IAGJ,MAAM,YACJI,EAAW,eACXC,EAAc,OACdH,EAAM,UACNC,EAAS,UACTsG,EAAS,gBACThU,EAAe,UACfkW,EAAS,yBACTG,EAAwB,eACxBK,EAAc,4BACdC,EAA2B,wBAC3BI,GACEjD,EAAmBC,IAGjB,aACJlG,EAAY,gBACZC,EAAe,cACfC,EAAa,iBACbC,EAAgB,YAChBnD,EAAW,eACXoD,EAAc,aACdC,EAAY,gBACZC,EAAe,WACf2R,GJ0CG,SAA4BD,GACjC,MAAOhS,EAAcC,IAAmBrN,EAAAA,EAAAA,UAASoX,EAAcM,MACxDpK,EAAeC,IAAoBvN,EAAAA,EAAAA,UAASoX,EAAcO,OAC1DvN,EAAaoD,IAAkBxN,EAAAA,EAAAA,WAAS,IACxCyN,EAAcC,IAAmB1N,EAAAA,EAAAA,UAAS6X,GAE3CpJ,GAAuB9O,EAAAA,EAAAA,QAAe,GACtC0f,GAAa1f,EAAAA,EAAAA,QACjB+W,EAAsBU,EAAcM,IAAKN,EAAcO,KAAMlJ,EAAsBoJ,IAE/EsJ,GAAkBxhB,EAAAA,EAAAA,QAAOyX,EAAcM,KACvC0J,GAAmBzhB,EAAAA,EAAAA,QAAOyX,EAAcO,OAG9CtX,EAAAA,EAAAA,YAAU,KACR8gB,EAAgB1gB,QAAU2M,EAC1BgU,EAAiB3gB,QAAU6M,EAC3B+R,EAAW5e,QAAUiW,EAAsBtJ,EAAcE,EAAemB,EAAsBhB,EAAa,GAC1G,CAACL,EAAcE,EAAeG,IAGjC,MAAM4T,GAAmB1hB,EAAAA,EAAAA,QAAO,GAC1B2hB,GAAoB3hB,EAAAA,EAAAA,QAAO,GAC3B4hB,GAAqB5hB,EAAAA,EAAAA,QAAO,GAC5B6hB,GAAsB7hB,EAAAA,EAAAA,QAAO,KAC7B8hB,GAAc9hB,EAAAA,EAAAA,SAAO,GA6E3B,OA3EAU,EAAAA,EAAAA,YAAU,KACR,GAAI+J,IAAgBqX,EAAYhhB,QAAS,CAEvC4gB,EAAiB5gB,QAAU0I,EAASiE,GACpCkU,EAAkB7gB,QAAU0I,EAASmE,GAErC,MAAMoU,EAAW,GAAsB,IAAhBtc,KAAKkS,SACtBqK,EAAY,GAAsB,IAAhBvc,KAAKkS,SACvBsK,EAAexc,KAAKkS,SAAW,GAAM,GAAK,EAC1CuK,EAAgBzc,KAAKkS,SAAW,GAAM,GAAK,EACjDiK,EAAmB9gB,QAAUihB,EAAWE,EACxCJ,EAAoB/gB,QAAUkhB,EAAYE,CAC5C,CACAJ,EAAYhhB,QAAU2J,CAAW,GAChC,CAACA,EAAagD,EAAcE,KAE/BjN,EAAAA,EAAAA,YAAU,KACR,IAAK+J,EAAa,OAClB,IAAI4K,EACF8M,EAAQC,YAAYnB,MACtB,MAAMoB,EAAQpB,IACZ,MAAM3H,EAAK2H,EAAMkB,EACjBA,EAAQlB,EACR,MAAMtY,EAAI8W,EAAS3e,QACjBwhB,EAAOhJ,EAAK,MAEdoI,EAAiB5gB,SACd4gB,EAAiB5gB,QAFX,IAE4B6H,EAAI2Z,EAAOV,EAAmB9gB,SAAW,IAC9E6gB,EAAkB7gB,SACf6gB,EAAkB7gB,QAJZ,IAI6B6H,EAAI2Z,EAAOT,EAAoB/gB,SAAW,IAGhF,MAAMyhB,EAASb,EAAiB5gB,QAE1B4O,EADUiS,EAAkB7gB,QACXyhB,EACjB5S,EAAcD,EAAO,EAAIA,EAAO,IAAMA,EAAO,IAG7C8S,EAAiB/c,KAAKmK,IAAIF,GAAQjK,KAAKmK,IAAID,GAAeD,EAAOC,EAGvE,GAFwBlK,KAAKmK,IAAI4S,GAEX,GAAI,CACxB,MAAMT,EAAWH,EAAmB9gB,QAC9BkhB,EAAYH,EAAoB/gB,QAGhC2hB,EAAsBD,EAAiB,EACvCE,EAAuBF,EAAiB,EAG9C,GAAIC,GAAuBV,EAAW,EAAG,CACvC,MAAMY,EAAW,GAAsB,IAAhBld,KAAKkS,SAC5BiK,EAAmB9gB,SAAW6hB,CAChC,MAAO,IAAKF,GAAuBV,EAAW,EAAG,CAC/C,MAAMY,EAAW,GAAsB,IAAhBld,KAAKkS,SAC5BiK,EAAmB9gB,QAAU6hB,CAC/B,CAEA,GAAID,GAAwBV,EAAY,EAAG,CACzC,MAAMW,EAAW,GAAsB,IAAhBld,KAAKkS,SAC5BkK,EAAoB/gB,QAAU6hB,CAChC,MAAO,IAAKD,GAAwBV,EAAY,EAAG,CACjD,MAAMW,EAAW,GAAsB,IAAhBld,KAAKkS,SAC5BkK,EAAoB/gB,SAAW6hB,CACjC,CACF,CAEAjV,EAAgBhF,EAASgZ,EAAiB5gB,QAAS,EAAG,KACtD8M,EAAiBlF,EAASiZ,EAAkB7gB,QAAS,EAAG,KACxDuU,EAAK8L,sBAAsBkB,EAAK,EAGlC,OADAhN,EAAK8L,sBAAsBkB,GACpB,IAAMhB,qBAAqBhM,EAAG,GACpC,CAAC5K,EAAagV,IAEV,CACLhS,eACAC,kBACAC,gBACAC,mBACAnD,cACAoD,iBACAC,eACAC,kBACA2R,aAEJ,CI1JMkD,CAAmBnD,IAGjB,eAAEH,EAAc,kBAAEC,EAAiB,cAAEC,GClEtC,SAA4BJ,GACjC,MAAME,GAAiBtf,EAAAA,EAAAA,SAAO,GACxBuf,GAAoBvf,EAAAA,EAAAA,SAAO,GAC3Bwf,GAAgBxf,EAAAA,EAAAA,QAAa,CAAEkJ,EAAG,EAAG6C,EAAG,IAuC9C,OArCArL,EAAAA,EAAAA,YAAU,KACR,MAAM6H,EAAI6W,EAAUte,QACpB,IAAKyH,EAAG,OAER,MAAMsa,EAAWtX,IACf,MAAMC,EAAOjD,EAAEmD,wBACf,MAAO,CAAExC,EAAGqC,EAAEM,QAAUL,EAAKM,KAAMC,EAAGR,EAAES,QAAUR,EAAKS,IAAK,EAGxD6W,EAAUvX,IACd+T,EAAexe,SAAU,EACzBye,EAAkBze,QACH,IAAbyK,EAAEwX,QAA8B,IAAbxX,EAAEwX,QAAgBxX,EAAEyX,QACzCxD,EAAc1e,QAAU+hB,EAAQtX,EAAE,EAG9B0X,EAAU1X,GAAqBiU,EAAc1e,QAAU+hB,EAAQtX,GAE/D2X,EAAOA,KACX5D,EAAexe,SAAU,EACzBye,EAAkBze,SAAU,CAAK,EASnC,OANAyH,EAAExG,iBAAiB,cAAe+gB,GAClCva,EAAExG,iBAAiB,eAAgBwJ,GAAMA,EAAE4X,mBAC3CrhB,OAAOC,iBAAiB,cAAekhB,GACvCnhB,OAAOC,iBAAiB,YAAamhB,GACrCphB,OAAOC,iBAAiB,gBAAiBmhB,GAElC,KACL3a,EAAEvG,oBAAoB,cAAe8gB,GACrChhB,OAAOE,oBAAoB,cAAeihB,GAC1CnhB,OAAOE,oBAAoB,YAAakhB,GACxCphB,OAAOE,oBAAoB,gBAAiBkhB,EAAK,CAClD,GACA,CAAC9D,IAEG,CACLE,iBACAC,oBACAC,gBAEJ,CDoBI4D,CAAmBhE,IAGf,aAAEO,EAAY,QAAEK,EAAO,SAAEpB,EAAQ,gBAAEwC,GAAoBjC,GAAc,CACzEC,YACAC,SACAC,iBACAC,oBACAC,gBACAC,WACAC,aACApJ,oBAII,aAAEtI,EAAY,iBAAEC,GE1EjB,SAAsBvO,GAKJ,IALK,UAC5B0f,EAAS,aACTO,EAAY,QACZK,EAAO,SACPpB,GACoBlf,EACpB,MAAOsO,EAAcqV,IAAmBhjB,EAAAA,EAAAA,WAAS,GAqCjD,OAnCAK,EAAAA,EAAAA,YAAU,KACR,MAAM8N,EAAUA,KACd6U,IAAkB1U,SAAS2U,mBAC3B3U,SAASM,KAAKvN,UAAU6hB,OACtB,yBACE5U,SAAS2U,mBAIb,MAAM3E,EAASS,EAAUte,QACzB,GAAI6d,EAAQ,CACV,MAAMvB,EAAItb,OAAOiC,WACfkE,EAAInG,OAAOue,YACb1B,EAAOpZ,MAAQ6X,EACfuB,EAAOjc,OAASuF,EAChB+X,EAAQlf,QAAU,CAAEsc,IAAGnV,KACvB2W,EAAS9d,QAAU,KACnB6e,EAAa7e,SAAW4X,EAAiBiH,EAAa7e,QAASsc,EAAGnV,EACpE,GAGF,OADA0G,SAAS5M,iBAAiB,mBAAoByM,GACvC,KACLG,SAAS3M,oBAAoB,mBAAoBwM,GACjDG,SAASM,KAAKvN,UAAUE,OAAO,uBAAuB,CACvD,GACA,CAACwd,EAAWO,EAAcK,EAASpB,IAU/B,CACL5Q,eACAC,kBAVuBI,EAAAA,EAAAA,cAAY,KAG3B,IAADmV,EAAAC,EAF0BC,EAAAC,EAA5BhV,SAAS2U,kBAGW,QAAvBE,GAAAC,EAAA9U,UAASiV,sBAAc,IAAAJ,GAAvBA,EAAAK,KAAAJ,GAF0C,QAA1CC,GAAAC,EAAAhV,SAASmV,iBAAgBC,yBAAiB,IAAAL,GAA1CA,EAAAG,KAAAF,GAA+CrQ,OAAM,QAGvD,GACC,IAML,CF2B6C0Q,CAAc,CACvD5E,YACAO,eACAK,UACApB,cAII,WAAEjf,EAAU,mBAAEskB,GAAkB,sBAAEC,IGzFnC,SAAuBvQ,EAAqBpG,GACjD,MAAO5N,EAAYwkB,IAAiB9jB,EAAAA,EAAAA,UAAgC,OAC7D4jB,EAAoBC,IAAyB7jB,EAAAA,EAAAA,WAAS,GA0C7D,OAxCAK,EAAAA,EAAAA,YAAU,KACR,IAAKiT,GAAcpG,IAAgBtJ,EAAcC,QAE/C,YADAigB,EAAc,MAGhB,IAAIC,EACJ,MAAMC,EAAkBC,UACtB,MAAMC,EAAUlgB,EAAUkJ,GAC1B,IAAK,IAADiX,EACF,MAAM3d,QAAa4d,MAAMF,GACnBnG,QAAavX,EAAK6d,OACxB5S,QAAQvK,IAAI6W,GACZ,MAAMrI,EAAmB,QAAfyO,EAAGpG,EAAKuG,eAAO,IAAAH,OAAA,EAAZA,EAAe,GAC5B,IAAKzO,EAAM,OACY,aAAnBA,EAAK6O,UACPT,EAAc,CACZlhB,KAAM,WACNE,OAAQ,GACRC,MAAO,GACPZ,YAAY,EACZD,QAASgL,IAEe,cAAnBwI,EAAK6O,WACZT,EAAc,CACZlhB,MAAO8S,EAAK9S,MAAQ,iBAAiB4hB,cACrC1hB,QAAS4S,EAAK5S,QAAU,kBAAkB0hB,cAC1CzhB,OAAQ2S,EAAK3S,OAAS,IAAIyhB,cAC1BriB,YAAY,EACZD,QAASgL,GAEf,CAAE,MAAOhC,GACPuG,QAAQgT,MAAM,6BAA8BvZ,EAC9C,GAKF,OAFA8Y,IACAD,EAAQtiB,OAAOwT,YAAY+O,EAAiB,KACrC,IAAM3O,cAAc0O,EAAM,GAChC,CAACzQ,EAAYpG,IAET,CACL5N,aACAskB,qBACAC,wBAEJ,CHyCIa,CAAcpR,EAAYpG,IAG5B7M,EAAAA,EAAAA,YAAU,KACJf,IAAeA,EAAW6C,WAC5BmM,SAAS3L,MAAK,GAAAvB,OAAM9B,EAAWsD,KAAI,OAAAxB,OAAM9B,EAAWwD,QAEpDwL,SAAS3L,MAAQ,wBACnB,GACC,CAACrD,IAGJ,MAAMqlB,IAAY3W,EAAAA,EAAAA,cAAYiW,UAU5B,GATAxO,IACKnC,IACH4N,GAAc,GACdH,IACA7K,KAEFI,IACIpJ,IAAgBtJ,EAAcE,MAAM8R,IACxCrC,EAAUvG,OAAS,EACfuG,EAAUqR,WAAa,EAAG,CAC5BrR,EAAUsR,OACV,MAAMC,EAAYb,UAChB,UACQ1Q,EAAUmC,MAClB,CAAE,MAAAC,GAAO,CACTpC,EAAU5R,oBAAoB,iBAAkBmjB,EAAU,EAE5DvR,EAAU7R,iBAAiB,iBAAkBojB,EAAW,CAAEzO,MAAM,GAClE,MACE,UACQ9C,EAAUmC,MAClB,CAAE,MAAAb,GAAO,CACX,GACC,CACDY,EACAnC,EACAyN,EACA7K,EACAI,EACApJ,EACA0I,EACArC,IAIIwR,IAAoB/V,EAAAA,EAAAA,UACxB,MACE+N,EAAGtb,OAAOiC,WACVkE,EAAGnG,OAAOue,eAEZ,IAGF,OACEpe,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sBAAqBC,SAAA,EAClCC,EAAAA,EAAAA,KAAA,UACEQ,IAAKwc,EACLld,UAAU,mBACVqD,MAAO6f,GAAkBhI,EACzB1a,OAAQ0iB,GAAkBnd,KAE5B7F,EAAAA,EAAAA,KAAC3C,EAAgB,CACfE,WAAYA,EACZC,gBAAiBA,EACjBC,SAAUokB,GACVnkB,SAAUA,IAAMokB,IAAuB5V,IAAOA,MAE9CqF,GAYAvR,EAAAA,EAAAA,KAAC8K,EAAY,CACXC,SAAUA,EACVC,YAAaA,EACbC,OAAQA,EACRC,UAAWA,EACXC,YAAaA,EACbC,eAAgBA,EAChBC,aAAcA,EACdC,gBAAiBA,EACjBC,cAAeA,EACfC,iBAAkBA,EAClBnD,YAAaA,EACboD,eAAgBA,EAChBC,aAAcA,EACdC,gBAAiBA,EACjBC,aAAcA,EACdC,iBAAkBA,EAClBjK,SAAUA,KA5BZ5B,EAAAA,EAAAA,KAAA,OAAKF,UAAU,0BAAyBC,UACtCC,EAAAA,EAAAA,KAAA,UACEC,KAAK,SACLH,UAAU,kBACVI,QAAS0iB,GACT,aAAW,wBAAuB7iB,UAElCC,EAAAA,EAAAA,KAAA,OAAK2O,IAAKC,EAAWC,IAAI,QAAQ/O,UAAU,+BA0BvD,C,gDIpMO,MAAM4R,UAAsBuR,MACjClU,WAAAA,CAAYJ,GAAoB,IAAfuU,EAAItL,UAAA7R,OAAA,QAAA8R,IAAAD,UAAA,IAAAA,UAAA,GACnBuL,QAAQ,KAqHVC,aAAgBC,IAAc,IAADC,EAE3B,OADyB,QAAlBA,EAAGhU,KAAKiU,kBAAU,IAAAD,EAAAA,EAAI,IACpBE,SAASH,IAAa/T,KAAKmU,WAAW,EAC/C,KAEFA,UAAY,IACVnU,KAAK0D,YAAc,IAAM1D,KAAK8C,SAAW9C,KAAKoU,OAASpU,KAAKuT,WAAa,EAAE,KAE7Ec,SAAW,IAAMrU,KAAKrQ,SAAWqQ,KAAK0D,YAAY,KAElDS,MAAQ,KACNnE,KAAKkE,QACL,IACElE,KAAK0D,YAAc,CACrB,CAAE,MAAAY,GAAO,GACT,KAEFgQ,QAAU,KACRtU,KAAKmE,QACLnE,KAAKuU,aACLvU,KAAKwU,gBAAgB,OACrBxU,KAAKwT,MAAM,EAzIXxT,KAAKyU,YAAc,YACnBzU,KAAK4T,KAAOA,EAEZ5T,KAAK0U,KAAO,KACZ1U,KAAK2U,YAAc,KAGnB3U,KAAK4U,cAAgB,EAEjBvV,GAAKW,KAAK+C,UAAU1D,EAAK,CAAE2D,UAAU,EAAO4Q,QAClD,CAEA,cAAIK,GAAc,IAADY,EACf,OAAuB,QAAvBA,EAAO7U,KAAK2U,mBAAW,IAAAE,EAAAA,EAAI7U,KAAKX,GAClC,CAEA,eAAM0D,CAAU1D,GAAmD,IAA9C,SAAE2D,GAAW,EAAK,KAAE4Q,EAAO5T,KAAK4T,MAAMtL,UAAA7R,OAAA,QAAA8R,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAC,EAE7D,MAAMwM,IAAQ9U,KAAK4U,cAEnB5U,KAAK4T,KAAOA,EACZ5T,KAAKyU,YAAc,YAGnB,MAAMM,EAAiB/R,IAAahD,KAAK8C,OAEzC9C,KAAKkE,QAELlE,KAAKuU,aACLvU,KAAK2U,YAActV,EAEnB,MAAM2V,EAAQ,kBAAkB/iB,KAAKoN,GAG/B4V,EACJD,GAA+D,KAAtDhV,KAAKkV,YAAY,iCAG5B,IAAKF,GAASC,EAOZ,OANAjV,KAAKX,IAAMA,EACXW,KAAKwT,YACDuB,UACI/U,KAAKmV,qBACCnV,KAAK4U,gBAMrB,IAAKQ,EAAAA,GAAAA,cACH,MAAM,IAAIC,MAAM,+CAGlB,MAAMC,EAAM,IAAIF,EAAAA,GAChBpV,KAAK0U,KAAOY,EAEZA,EAAIC,YAAYvV,MAChBsV,EAAIE,WAAWnW,GAEfiW,EAAIG,GAAGL,EAAAA,GAAAA,OAAWM,OAAO,CAACC,EAAMjJ,KAC9BtM,QAAQgT,MAAM,eAAgB1G,GACzBA,EAAKkJ,QAENlJ,EAAK/b,OAASykB,EAAAA,GAAAA,WAAeS,eAAeP,EAAIQ,YAChDpJ,EAAK/b,OAASykB,EAAAA,GAAAA,WAAeW,aAAaT,EAAIU,oBAAmB,IAGlEjB,UAEC,IAAIkB,SAAQ,CAACC,EAASC,KAC1B,MAAMC,EAAWA,KACfd,EAAIe,IAAIjB,EAAAA,GAAAA,OAAWkB,gBAAiBF,GACpCF,GAAS,EAELK,EAAQA,CAACZ,EAAMjJ,KACdA,EAAKkJ,QACVN,EAAIe,IAAIjB,EAAAA,GAAAA,OAAWM,MAAOa,GAC1BJ,EAAO,IAAId,MAAM,oBAADtlB,OAAqB2c,EAAK/b,KAAI,OAAAZ,OAAM2c,EAAK8J,WAAW,EAEtElB,EAAIG,GAAGL,EAAAA,GAAAA,OAAWkB,gBAAiBF,GACnCd,EAAIG,GAAGL,EAAAA,GAAAA,OAAWM,MAAOa,EAAM,IAG7BzB,IAAQ9U,KAAK4U,qBACX5U,KAAKyW,YACb,CAEAlC,UAAAA,GACE,GAAKvU,KAAK0U,KACV,IACE1U,KAAK0U,KAAKJ,SACZ,CAAC,QACCtU,KAAK0U,KAAO,IACd,CACF,CAEA,wBAAMS,GACJ,GAAInV,KAAKuT,YAAc,EAAG,OAAOvT,KAAKyW,kBAEhC,IAAIR,SAASC,IAEjBlW,KAAK3P,iBAAiB,WADJojB,IAAMyC,KACoB,CAAElR,MAAM,IACpDhF,KAAK3P,iBAAiB,SAAS,IAAM6lB,KAAW,CAAElR,MAAM,GAAO,UAG3DhF,KAAKyW,WACb,CAEA,eAAMA,GACJ,UACQzW,KAAKqE,MACb,CAAE,MAAAb,GACA,CAEJ,E","sources":["assets/lavaLamp/power.svg","lava_lamp/NowPlayingWidget.tsx","lava_lamp/config.ts","lava_lamp/audioConfig.ts","lava_lamp/helpers.ts","lava_lamp/colors.ts","lava_lamp/components/ColorWheel.tsx","lava_lamp/components/ControlsMenu.tsx","util/audioAmplitude.ts","lava_lamp/hooks/useAudioManagement.ts","lava_lamp/hooks/useColorManagement.ts","lava_lamp/physics.ts","lava_lamp/rendering.ts","lava_lamp/hooks/useSimulation.ts","lava_lamp/LavaLamp.tsx","lava_lamp/hooks/usePointerHandling.ts","lava_lamp/hooks/useFullscreen.ts","lava_lamp/hooks/useNowPlaying.ts","util/Audio.js"],"sourcesContent":["var _g;\nconst _excluded = [\"title\", \"titleId\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var s = Object.getOwnPropertySymbols(e); for (r = 0; r < s.length; r++) o = s[r], t.includes(o) || {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (e.includes(n)) continue; t[n] = r[n]; } return t; }\nimport * as React from \"react\";\nfunction SvgPower(_ref, svgRef) {\n  let {\n      title,\n      titleId\n    } = _ref,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    id: \"Capa_1\",\n    x: \"0px\",\n    y: \"0px\",\n    viewBox: \"0 0 512.292 512.292\",\n    style: {\n      enableBackground: \"new 0 0 512.292 512.292\"\n    },\n    xmlSpace: \"preserve\",\n    width: 512,\n    height: 512,\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M256.061,0L256.061,0c17.673,0,32,14.327,32,32v106.667c0,17.673-14.327,32-32,32l0,0c-17.673,0-32-14.327-32-32V32   C224.061,14.327,238.387,0,256.061,0z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M330.727,105.387L330.727,105.387c-0.157,10.742,5.259,20.8,14.315,26.581c80.432,49.143,105.796,154.185,56.652,234.616   S247.51,472.38,167.078,423.237S61.282,269.052,110.426,188.62c14.042-22.982,33.324-42.315,56.269-56.418   c9.211-5.781,14.773-15.92,14.699-26.795l0,0c0.049-17.673-14.238-32.039-31.911-32.088c-6.07-0.017-12.02,1.693-17.155,4.931   C22.233,146.634-11.58,291.318,56.803,401.412s213.067,143.907,323.161,75.524s143.907-213.067,75.524-323.161   c-19.035-30.645-44.879-56.489-75.524-75.524c-14.997-9.461-34.824-4.973-44.285,10.024   C332.447,93.397,330.731,99.33,330.727,105.387z\"\n  }))));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgPower);\nexport default __webpack_public_path__ + \"static/media/power.632cc1e66922cf3fa35d93370ea84178.svg\";\nexport { ForwardRef as ReactComponent };","import React, { type ReactElement, useEffect, useRef, useState } from \"react\";\nimport { NowPlayingInfo } from \"./config\";\n\ninterface NowPlayingWidgetProps {\n  nowPlaying: NowPlayingInfo | null;\n  displayWaveform: number[];\n  expanded: boolean;\n  onToggle: () => void;\n}\n\nexport default function NowPlayingWidget({\n  nowPlaying,\n  displayWaveform,\n  expanded,\n  onToggle,\n}: NowPlayingWidgetProps): ReactElement | null {\n  const nowPlayingSongRef = useRef<HTMLDivElement>(null);\n  const nowPlayingArtistRef = useRef<HTMLDivElement>(null);\n  const nowPlayingAlbumRef = useRef<HTMLDivElement>(null);\n  const [songOverflowing, setSongOverflowing] = useState(false);\n  const [artistOverflowing, setArtistOverflowing] = useState(false);\n  const [albumOverflowing, setAlbumOverflowing] = useState(false);\n\n  // Check for text overflow and apply scrolling class\n  useEffect(() => {\n    const SCROLL_SPEED = 30; // pixels per second (slower = more readable)\n\n    const calculateScrollDuration = (textWidth: number): number => {\n      return textWidth / SCROLL_SPEED;\n    };\n\n    const calculateSecondCopyDelay = (): number => {\n      return 1.0;\n    };\n\n    // Helper for checking overflow on a single ref, calling the correct setter\n    function handleOverflowCheck(\n      elementRef: React.RefObject<HTMLDivElement>,\n      setOverflowing: React.Dispatch<React.SetStateAction<boolean>>\n    ) {\n      if (!elementRef.current) return;\n      const wrapper = elementRef.current.querySelector(\n        \".scroll-wrapper\"\n      ) as HTMLElement;\n      const containerWidth = elementRef.current.clientWidth;\n      const isOverflowing = wrapper && wrapper.scrollWidth > containerWidth;\n      setOverflowing(!!isOverflowing);\n\n      if (isOverflowing && wrapper) {\n        const duration = calculateScrollDuration(wrapper.scrollWidth);\n        const delayFraction = calculateSecondCopyDelay();\n        elementRef.current.style.setProperty(\n          \"--scroll-duration\",\n          `${duration}s`\n        );\n        elementRef.current.style.setProperty(\n          \"--second-copy-delay\",\n          `${delayFraction}`\n        );\n        elementRef.current.classList.add(\"overflowing\");\n      } else {\n        elementRef.current.classList.remove(\"overflowing\");\n      }\n    }\n\n    // Check all overflow states in a single pass\n    function checkAllOverflow() {\n      handleOverflowCheck(\n        nowPlayingSongRef as React.RefObject<HTMLDivElement>,\n        setSongOverflowing\n      );\n      handleOverflowCheck(\n        nowPlayingArtistRef as React.RefObject<HTMLDivElement>,\n        setArtistOverflowing\n      );\n      handleOverflowCheck(\n        nowPlayingAlbumRef as React.RefObject<HTMLDivElement>,\n        setAlbumOverflowing\n      );\n    }\n\n    checkAllOverflow();\n    window.addEventListener(\"resize\", checkAllOverflow);\n\n    return () => window.removeEventListener(\"resize\", checkAllOverflow);\n  }, [nowPlaying, expanded]);\n\n  if (!nowPlaying) {\n    return null;\n  }\n\n  const handleSongClick = () => {\n    window.open(\"https://www.kexp.org/playlist/\", '_blank', 'noopener,noreferrer');\n  };\n\n  return (\n    <div\n      className={`lava-lamp-now-playing ${expanded ? \"expanded\" : \"collapsed\"}`}\n    >\n      <button\n        type=\"button\"\n        className=\"lava-lamp-now-playing-toggle\"\n        onClick={onToggle}\n        aria-label={expanded ? \"Collapse now playing\" : \"Expand now playing\"}\n      >\n        {expanded ? \">\" : \"<\"}\n      </button>\n      <div className=\"lava-lamp-now-playing-content\">\n        <div className=\"lava-lamp-now-playing-header\">\n          <div className=\"lava-lamp-now-playing-label\">{nowPlaying.station}</div>\n          {!nowPlaying.isAirbreak && (\n            <div className=\"lava-lamp-soundwave\">\n              {displayWaveform.map((height, i) => (\n                <div\n                  key={i}\n                  className=\"lava-lamp-soundwave-bar\"\n                  style={{ \"--bar-height\": height } as React.CSSProperties}\n                />\n              ))}\n            </div>\n          )}\n        </div>\n        <div\n          ref={nowPlayingSongRef}\n          className=\"lava-lamp-now-playing-song\"\n          onClick={handleSongClick}\n          style={{ cursor: 'var(--pointer)' }}\n          title=\"see on kexp\"\n        >\n          <span className=\"scroll-wrapper\">{nowPlaying.song}</span>\n          {songOverflowing && (\n            <span className=\"scroll-wrapper second\">{nowPlaying.song}</span>\n          )}\n        </div>\n        {!nowPlaying.isAirbreak && (\n          <>\n            <div\n              ref={nowPlayingArtistRef}\n              className=\"lava-lamp-now-playing-artist\"\n            >\n              <span className=\"scroll-wrapper\">{nowPlaying.artist}</span>\n              {artistOverflowing && (\n                <span className=\"scroll-wrapper second\">\n                  {nowPlaying.artist}\n                </span>\n              )}\n            </div>\n            <div\n              ref={nowPlayingAlbumRef}\n              className=\"lava-lamp-now-playing-album\"\n            >\n              <span className=\"scroll-wrapper\">{nowPlaying.album}</span>\n              {albumOverflowing && (\n                <span className=\"scroll-wrapper second\">\n                  {nowPlaying.album}\n                </span>\n              )}\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n","/**\n * Configuration constants and type definitions for the Lava Lamp simulation\n */\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface Particle {\n  x: number;\n  y: number;\n  vx: number;\n  vy: number;\n  heat: number; // [0..1]\n}\n\nexport type Vec2 = { x: number; y: number };\n\nexport interface SpatialGrid {\n  cellSize: number;\n  cols: number;\n  rows: number;\n  heads: Int32Array; // head index or -1\n  next: Int32Array; // next index or -1\n}\n\nexport type AudioSource = \"redwood\" | \"kexp\";\n\nexport interface NowPlayingInfo {\n  song: string;\n  artist: string;\n  album: string;\n  isAirbreak: boolean;\n  station: string;\n}\n\n// ============================================================================\n// Device Detection (inline to avoid separate file)\n// ============================================================================\n\nexport const detectMobile = (): boolean => {\n  const userAgent =\n    navigator.userAgent ||\n    navigator.vendor ||\n    (window as Window & { opera?: string }).opera ||\n    \"\";\n\n  const mobileRegex =\n    /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;\n  const isMobileUA = mobileRegex.test(userAgent);\n\n  const hasTouch = \"ontouchstart\" in window || navigator.maxTouchPoints > 0;\n  const isSmallScreen = window.innerWidth <= 500;\n\n  return isMobileUA || (hasTouch && isSmallScreen);\n};\n\nconst isMobile = detectMobile();\n\n// ============================================================================\n// Constants\n// ============================================================================\n\n// Audio source configuration\nexport const AUDIO_SOURCES = {\n  REDWOOD: \"redwood\",\n  KEXP: \"kexp\",\n  BBC6MUSIC: \"bbc 6 music\",\n} as const;\n\nexport const INFO_URLS = {\n  [AUDIO_SOURCES.REDWOOD]: null,\n  [AUDIO_SOURCES.KEXP]: \"https://api.kexp.org/v2/plays/?limit=5\",\n  [AUDIO_SOURCES.BBC6MUSIC]: \"https://bbc-now-playing.connor-j-hopkins.workers.dev/bbc/6music/now\",\n}\n\n// Default color configuration\nexport const DEFAULT_HIGH = \"#ffdd00\";\nexport const DEFAULT_LOW = \"#ff5500\";\n\n// Physics simulation constants\nexport const SIM = {\n  GRAVITY: 0.01,\n  BUOYANCY_BASE: 0.04,\n  FRICTION: 0.98,\n\n  HEAT_RATE_BASE: 0.005,\n  COOL_RATE_BASE: 0.0017,\n  HEAT_CONDUCTION: 0.002,\n\n  HEAT_SOURCE_DISTANCE_BASE: 45,\n  COHESION_RADIUS_BASE: 25,\n  COHESION_STRENGTH: 0.0035,\n  MOUSE_HEAT_RADIUS_BASE: 100,\n} as const;\n\n/**\n * Calculate buoyancy force based on screen scale factor\n * Scales so particles can travel longer distances on bigger screens\n */\nexport function computeBuoyancy(scaleFactor: number): number {\n  return SIM.BUOYANCY_BASE * scaleFactor;\n}\n\n/**\n * Calculate heat rate based on screen scale factor\n * Scales so particles heat up faster relative to distance traveled\n */\nexport function computeHeatRate(scaleFactor: number): number {\n  return SIM.HEAT_RATE_BASE * scaleFactor;\n}\n\n/**\n * Calculate cooling rate based on screen scale factor\n * Scales cooling rate proportionally to maintain consistent behavior\n */\nexport function computeCoolRate(scaleFactor: number): number {\n  return SIM.COOL_RATE_BASE * scaleFactor;\n}\n\n/**\n * Calculate heat source distance (bottom heater zone) based on screen scale factor\n * Scales proportionally to maintain consistent heating behavior\n */\nexport function computeHeatSourceDistance(scaleFactor: number): number {\n  return SIM.HEAT_SOURCE_DISTANCE_BASE * scaleFactor;\n}\n\n/**\n * Calculate cohesion radius (particle interaction distance) based on screen scale factor\n */\nexport function computeCohesionRadius(scaleFactor: number): number {\n  return SIM.COHESION_RADIUS_BASE * scaleFactor;\n}\n\n/**\n * Calculate mouse heat radius (user interaction distance) based on screen scale factor\n */\nexport function computeMouseHeatRadius(scaleFactor: number): number {\n  return SIM.MOUSE_HEAT_RADIUS_BASE * scaleFactor;\n}\n\n// Rendering constants\nexport const RENDER = {\n  PARTICLE_RADIUS_BASE: 10,\n  THRESHOLD: 0.8,\n} as const;\n\n/**\n * Calculate particle radius (metaball size) based on screen scale factor\n */\nexport function computeParticleRadius(scaleFactor: number): number {\n  return RENDER.PARTICLE_RADIUS_BASE * scaleFactor;\n}\n\n/**\n * Calculate the scale factor based on screen dimensions\n * Used to scale both rendering and physics consistently\n */\nexport function computeScaleFactor(width: number, height: number): number {\n  const area = width * height;\n  return Math.sqrt(area / 1_288_920);\n}\n\n/**\n * Calculate adaptive pixel size based on screen dimensions\n * Target: ~14ms render time for 60fps\n */\nexport function computePixelSize(\n  width: number,\n  height: number,\n  basePixelSize: number = 8\n): number {\n  const scaleFactor = computeScaleFactor(width, height);\n  const adaptivePixelSize = basePixelSize * scaleFactor;\n  return Math.max(4, Math.min(24, Math.round(adaptivePixelSize)));\n}\n\n// Particle clustering configuration\nexport const CLUMPS = {\n  COUNT: 15,\n  RADIUS_BASE: isMobile ? 30 : 50,\n  TOP_HALF_PROB: 0.3,\n} as const;\n\n/**\n * Calculate clump radius (initial particle clustering) based on screen scale factor\n */\nexport function computeClumpRadius(scaleFactor: number): number {\n  return CLUMPS.RADIUS_BASE * scaleFactor;\n}\n\n/**\n * The density of the lava lamp simulation (particles per pixel).\n */\nexport const PARTICLES_PER_PIXEL = isMobile ? 0.00054 : 0.00061;\n\n/**\n * Maximum number of particles regardless of screen size.\n */\nexport const MAX_PARTICLES = 2000;\n\n// Speed control configuration\nexport const SPEED = {\n  MIN: 0.0,\n  MAX: 5,\n  DEFAULT: 0.25,\n  STEPS: 10,\n} as const;\n\n// Fixed update rate\nexport const FIXED_FPS = 60;\nexport const FIXED_MS = 1000 / FIXED_FPS;\nexport const MAX_CATCHUP_STEPS = 5;\n\n// LocalStorage keys\nexport const MUSIC_TIME_KEY = \"lava-lamp-music-time\";\n","// @ts-expect-error - Asset import\nimport musicAudioNoise from \"../assets/lavaLamp/guitar.mp3\";\n// @ts-expect-error - Asset import\nimport clickAudioNoise from \"../assets/lavaLamp/click.mp3\";\nimport { AUDIO_SOURCES } from \"./config.ts\";\nimport type { AudioSource } from \"./config.ts\";\n\nexport const AUDIO_SOURCE_CONFIG = {\n  [AUDIO_SOURCES.REDWOOD]: {\n    label: \"redwood meditation\",\n    url: musicAudioNoise,\n    info: null,\n  },\n  [AUDIO_SOURCES.KEXP]: {\n    label: \"kexp\",\n    url: \"https://kexp.streamguys1.com/kexp160.aac\",\n  },\n  [AUDIO_SOURCES.BBC6MUSIC]: {\n    label: \"bbc 6 music\",\n    url: \"http://as-hls-ww-live.akamaized.net/pool_81827798/live/ww/bbc_6music/bbc_6music.isml/bbc_6music-audio%3d96000.norewind.m3u8\",\n  }\n} as const;\n\nexport const CLICK_AUDIO_URL = clickAudioNoise;\n\nexport type AudioSourceConfig = typeof AUDIO_SOURCE_CONFIG;\nexport type { AudioSource };\n","/**\n * Helper utilities for the Lava Lamp simulation\n */\n\nimport { MUSIC_TIME_KEY, SPEED, type SpatialGrid } from \"./config.ts\";\n\n// ============================================================================\n// LocalStorage utilities\n// ============================================================================\n\nexport function readSavedMusicTimeSeconds(): number {\n  try {\n    const raw = localStorage.getItem(MUSIC_TIME_KEY);\n    if (!raw) return 0;\n    const v = Number(raw);\n    return Number.isFinite(v) && v >= 0 ? v : 0;\n  } catch {\n    return 0;\n  }\n}\n\nexport function writeSavedMusicTimeSeconds(seconds: number): void {\n  try {\n    if (!Number.isFinite(seconds) || seconds < 0) return;\n    localStorage.setItem(MUSIC_TIME_KEY, String(seconds));\n  } catch {}\n}\n\n// ============================================================================\n// Speed control utilities\n// ============================================================================\n\nexport function clampInt(v: number, lo: number, hi: number): number {\n  return v < lo ? lo : v > hi ? hi : v;\n}\n\n/**\n * Convert slider index to simulation speed value\n * Note: MIN=0 is special; idx 0 => frozen. idx 1..(STEPS-1) => (0..MAX] in log space.\n */\nexport function indexToSpeed(idx: number): number {\n  if (idx <= 0) return 0;\n\n  const steps = SPEED.STEPS;\n  if (idx >= steps) return SPEED.MAX;\n\n  const t = idx / steps;\n  const targetMidSpeed = 0.5;\n  const minPositive = (targetMidSpeed * targetMidSpeed) / SPEED.MAX;\n\n  const minLog = Math.log(minPositive);\n  const maxLog = Math.log(SPEED.MAX);\n\n  // lerp inline to avoid circular dependency\n  return Math.exp(minLog + (maxLog - minLog) * t);\n}\n\n/**\n * Find the slider index closest to the given speed value\n */\nexport function speedToNearestIndex(speed: number): number {\n  if (speed <= 0) return 0;\n\n  const steps = SPEED.STEPS;\n  const last = steps - 1;\n\n  let best = 1;\n  let bestErr = Infinity;\n  const target = Math.log(speed);\n\n  for (let i = 1; i <= last; i++) {\n    const s = indexToSpeed(i);\n    const err = Math.abs(Math.log(s) - target);\n    if (err < bestErr) {\n      bestErr = err;\n      best = i;\n    }\n  }\n  return best;\n}\n\n// ============================================================================\n// Spatial grid utilities\n// ============================================================================\n\n/**\n * Ensures the spatial grid is initialized to match the given parameters\n */\nexport function ensureGrid(\n  gridRef: React.MutableRefObject<SpatialGrid | null>,\n  width: number,\n  height: number,\n  count: number,\n  cellSize: number\n): void {\n  const cols = Math.max(1, Math.ceil(width / cellSize));\n  const rows = Math.max(1, Math.ceil(height / cellSize));\n  const cells = cols * rows;\n\n  const g = gridRef.current;\n  if (\n    !g ||\n    g.cols !== cols ||\n    g.rows !== rows ||\n    g.cellSize !== cellSize ||\n    g.next.length !== count ||\n    g.heads.length !== cells\n  ) {\n    gridRef.current = {\n      cellSize,\n      cols,\n      rows,\n      heads: new Int32Array(cells),\n      next: new Int32Array(count),\n    };\n  }\n}\n\n/**\n * Get the grid index from cell coordinates\n */\nexport function gridIndex(g: SpatialGrid, cx: number, cy: number): number {\n  return cy * g.cols + cx;\n}\n","/**\n * Optimized color manipulation and conversion utilities\n */\n\n// Fast hex -> rgb, avoids parseInt for fixed-length common cases\nexport function hexToRgb(hex: string): { r: number; g: number; b: number } {\n  let h = hex;\n  if (h[0] === \"#\") h = h.slice(1);\n  // Common 6-char HEX, skip parseInt loops for common case\n  if (h.length === 6) {\n    return {\n      r: (16 * hexCharToNibble(h[0]) + hexCharToNibble(h[1])),\n      g: (16 * hexCharToNibble(h[2]) + hexCharToNibble(h[3])),\n      b: (16 * hexCharToNibble(h[4]) + hexCharToNibble(h[5])),\n    };\n  }\n  // 3-character shorthand e.g. #fc1\n  if (h.length === 3) {\n    return {\n      r: 17 * hexCharToNibble(h[0]),\n      g: 17 * hexCharToNibble(h[1]),\n      b: 17 * hexCharToNibble(h[2]),\n    };\n  }\n  // fallback\n  return { r: 255, g: 221, b: 0 };\n}\n\n// Much faster than parseInt for single hex digit\nfunction hexCharToNibble(c: string): number {\n  const code = c.charCodeAt(0);\n  if (code >= 48 && code <= 57) return code - 48;\n  if (code >= 65 && code <= 70) return code - 55;\n  if (code >= 97 && code <= 102) return code - 87;\n  return 0;\n}\n\n// h, s, l in [0,1] for s/l\nexport function hslToHex(h: number, s: number, l: number): string {\n  // Fast HSL to RGB, inline float ops; avoid Math.min inside loop\n  const a = s * Math.min(l, 1 - l);\n  function f(n: number) {\n    const k = (n + h / 30) % 12;\n    const x = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);\n    // Clamp, no toString(16) padStart call if possible:\n    let val = Math.round(255 * x);\n    val = val < 0 ? 0 : val > 255 ? 255 : val;\n    // Branch-free 2-digit HEX\n    return hex2(val);\n  }\n  return `#${f(0)}${f(8)}${f(4)}`;\n}\n\n// Fast int->2 digit lowercase hex string\nfunction hex2(n: number): string {\n  if (n < 16) return \"0\" + n.toString(16);\n  return n.toString(16);\n}\n\nexport function hexToHue(hex: string): number {\n  // Use inlined logic for rgb decomposition; slightly reduces allocations\n  const { r, g, b } = hexToRgb(hex);\n  const rf = r * 0.00392156862745098; // 1/255\n  const gf = g * 0.00392156862745098;\n  const bf = b * 0.00392156862745098;\n\n  const max = rf > gf ? (rf > bf ? rf : bf) : (gf > bf ? gf : bf);\n  const min = rf < gf ? (rf < bf ? rf : bf) : (gf < bf ? gf : bf);\n  const delta = max - min;\n\n  if (delta < 1e-6) return 0; // Faster float compare\n\n  let hue: number;\n  if (max === rf) {\n    hue = ((gf - bf) / delta) % 6;\n  } else if (max === gf) {\n    hue = (bf - rf) / delta + 2;\n  } else {\n    hue = (rf - gf) / delta + 4;\n  }\n\n  hue = Math.round(hue * 60);\n  if (hue < 0) hue += 360;\n  return hue;\n}\n\n// Remove double clamp and branch, use Math.round directly, keep tight\nexport function lerpInt(a: number, b: number, t: number): number {\n  // (b-a)*t is fast, sometimes t=0 or t=1 exactly, so avoid floating error\n  const v = a + (b - a) * t;\n  // Clamp in a single pass\n  return v <= 0 ? 0 : v >= 255 ? 255 : (0.5 + v) | 0;\n}\n\n// RGB to HSL conversion\nexport function rgbToHsl(r: number, g: number, b: number): { h: number; s: number; l: number } {\n  // Normalize to [0, 1]\n  const rf = r / 255;\n  const gf = g / 255;\n  const bf = b / 255;\n\n  const max = Math.max(rf, gf, bf);\n  const min = Math.min(rf, gf, bf);\n  const delta = max - min;\n\n  // Lightness\n  const l = (max + min) / 2;\n\n  // Achromatic (gray)\n  if (delta < 0.00001) {\n    return { h: 0, s: 0, l };\n  }\n\n  // Saturation\n  const s = l > 0.5 ? delta / (2 - max - min) : delta / (max + min);\n\n  // Hue\n  let h: number;\n  if (max === rf) {\n    h = ((gf - bf) / delta + (gf < bf ? 6 : 0)) / 6;\n  } else if (max === gf) {\n    h = ((bf - rf) / delta + 2) / 6;\n  } else {\n    h = ((rf - gf) / delta + 4) / 6;\n  }\n\n  return { h, s, l };\n}\n\n// HSL to RGB conversion\nexport function hslToRgb(h: number, s: number, l: number): { r: number; g: number; b: number } {\n  let r: number, g: number, b: number;\n\n  if (s < 0.00001) {\n    // Achromatic\n    r = g = b = l;\n  } else {\n    const hue2rgb = (p: number, q: number, t: number): number => {\n      let tt = t;\n      if (tt < 0) tt += 1;\n      if (tt > 1) tt -= 1;\n      if (tt < 1 / 6) return p + (q - p) * 6 * tt;\n      if (tt < 1 / 2) return q;\n      if (tt < 2 / 3) return p + (q - p) * (2 / 3 - tt) * 6;\n      return p;\n    };\n\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n\n  return {\n    r: Math.round(r * 255),\n    g: Math.round(g * 255),\n    b: Math.round(b * 255),\n  };\n}\n\n// Hex to HSL (returns h in [0,1], s and l in [0,1])\nexport function hexToHsl(hex: string): { h: number; s: number; l: number } {\n  const { r, g, b } = hexToRgb(hex);\n  return rgbToHsl(r, g, b);\n}\n\n// Use unsigned right shift for fast Uint32 RGBA\nexport function packRgba(r: number, g: number, b: number, a: number): number {\n  // >>> 0 forces Uint32, improves perf in some engines\n  return ((a << 24) | (b << 16) | (g << 8) | r) >>> 0;\n}\n\nexport function buildHeatLut256(lowHex: string, highHex: string): Uint32Array {\n  // Convert to HSL for better color interpolation\n  const loHsl = hexToHsl(lowHex); // h, s, l in [0,1]\n  const hiHsl = hexToHsl(highHex);\n\n  const lut = new Uint32Array(256);\n\n  for (let i = 0; i < 256; ++i) {\n    const t = i * 0.00392156862745098; // i / 255\n\n    // Interpolate in HSL space\n    // Handle hue wrapping for shortest path\n    let h0 = loHsl.h;\n    let h1 = hiHsl.h;\n    if (Math.abs(h1 - h0) > 0.5) {\n      if (h1 > h0) {\n        h0 += 1;\n      } else {\n        h1 += 1;\n      }\n    }\n    let h = h0 + (h1 - h0) * t;\n    if (h > 1) h -= 1;\n\n    const s = loHsl.s + (hiHsl.s - loHsl.s) * t;\n    const l = loHsl.l + (hiHsl.l - loHsl.l) * t;\n\n    // Convert back to RGB using hslToRgb\n    const { r, g, b } = hslToRgb(h, s, l);\n    lut[i] = ((255 << 24) | (b << 16) | (g << 8) | r) >>> 0;\n  }\n  return lut;\n}\n","import React from \"react\";\nimport { hexToHsl, hslToRgb } from \"../colors.ts\";\n\ninterface ColorWheelProps {\n  wheelType: \"hot\" | \"cool\";\n  color: string;\n  onColorChange: (color: string) => void;\n  label: string;\n  rainbowMode: boolean;\n  onMouseDown: () => void;\n  draggingWheel: \"hot\" | \"cool\" | null;\n}\n\nfunction hexToRgb(hex: string): { r: number; g: number; b: number } {\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result\n    ? {\n        r: parseInt(result[1], 16),\n        g: parseInt(result[2], 16),\n        b: parseInt(result[3], 16),\n      }\n    : { r: 0, g: 0, b: 0 };\n}\n\nexport default function ColorWheel({\n  wheelType,\n  color,\n  onColorChange,\n  label,\n  rainbowMode,\n  onMouseDown,\n  draggingWheel,\n}: ColorWheelProps) {\n  const rgb = hexToRgb(color);\n  const isDragging = draggingWheel === wheelType;\n\n  const handleClick = (e: React.MouseEvent<HTMLDivElement>) => {\n    if (rainbowMode || draggingWheel) return;\n    const rect = e.currentTarget.getBoundingClientRect();\n    const centerX = rect.width / 2;\n    const centerY = rect.height / 2;\n    const x = e.clientX - rect.left - centerX;\n    const y = e.clientY - rect.top - centerY;\n    const angle = Math.atan2(y, x);\n    const hue = ((angle / (2 * Math.PI)) % 1 + 1) % 1;\n    const { r, g, b } = hslToRgb(hue, 1.0, 0.5);\n    const hex = `#${r.toString(16).padStart(2, \"0\")}${g.toString(16).padStart(2, \"0\")}${b.toString(16).padStart(2, \"0\")}`;\n    onColorChange(hex);\n  };\n\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        gap: \"8px\",\n      }}\n    >\n      <div\n        data-wheel={wheelType}\n        style={{\n          position: \"relative\",\n          width: \"80px\",\n          height: \"80px\",\n          cursor: rainbowMode\n            ? \"var(--not-allowed)\"\n            : isDragging\n              ? \"var(--grabbing)\"\n              : \"var(--pointer)\",\n          opacity: rainbowMode ? 0.5 : 1,\n        }}\n        onClick={handleClick}\n        onMouseDown={(e) => {\n          if (rainbowMode) return;\n          onMouseDown();\n        }}\n      >\n        <div\n          style={{\n            width: \"100%\",\n            height: \"100%\",\n            borderRadius: \"50%\",\n            background:\n              \"conic-gradient(from 90deg, red, yellow, lime, cyan, blue, magenta, red)\",\n            WebkitMask: \"radial-gradient(circle, transparent 35%, black 35%)\",\n            mask: \"radial-gradient(circle, transparent 35%, black 35%)\",\n          }}\n        />\n        <div\n          style={{\n            position: \"absolute\",\n            left: `${50 + 37 * Math.cos(hexToHsl(color).h * 2 * Math.PI)}%`,\n            top: `${50 + 37 * Math.sin(hexToHsl(color).h * 2 * Math.PI)}%`,\n            width: \"18px\",\n            height: \"18px\",\n            borderRadius: \"50%\",\n            backgroundColor: color,\n            border: \"2px solid white\",\n            boxShadow: \"0 0 4px rgba(0,0,0,0.5)\",\n            transform: \"translate(-50%, -50%)\",\n          }}\n        />\n      </div>\n      <div style={{ fontSize: \"13px\" }}>{label}</div>\n      <div style={{ fontSize: \"11px\", opacity: 0.7, fontFamily: \"monospace\" }}>\n        {String(rgb.r).padStart(3, \"0\")} / {String(rgb.g).padStart(3, \"0\")} / {String(rgb.b).padStart(3, \"0\")}\n      </div>\n    </div>\n  );\n}\n","import React, { ReactElement, useCallback, useEffect, useRef, useState, useMemo } from \"react\";\nimport powerIcon from \"../../assets/lavaLamp/power.svg\";\nimport { AUDIO_SOURCE_CONFIG } from \"../audioConfig.ts\";\nimport { SPEED } from \"../config.ts\";\nimport { clampInt } from \"../helpers.ts\";\nimport { hexToHsl, hslToRgb } from \"../colors.ts\";\nimport type { AudioSource } from \"../config.ts\";\nimport ColorWheel from \"./ColorWheel.tsx\";\n\ninterface ControlsMenuProps {\n  speedIdx: number;\n  setSpeedIdx: (idx: number) => void;\n  volume: number;\n  setVolume: (vol: number) => void;\n  audioSource: AudioSource;\n  setAudioSource: (source: AudioSource) => void;\n  lavaLowColor: string;\n  setLavaLowColor: (color: string) => void;\n  lavaHighColor: string;\n  setLavaHighColor: (color: string) => void;\n  rainbowMode: boolean;\n  setRainbowMode: (mode: boolean) => void;\n  spectrumMode: boolean;\n  setSpectrumMode: (mode: boolean) => void;\n  isFullscreen: boolean;\n  toggleFullscreen: () => void;\n  isMobile: boolean;\n}\n\nexport default function ControlsMenu({\n  speedIdx,\n  setSpeedIdx,\n  volume,\n  setVolume,\n  audioSource,\n  setAudioSource,\n  lavaLowColor,\n  setLavaLowColor,\n  lavaHighColor,\n  setLavaHighColor,\n  rainbowMode,\n  setRainbowMode,\n  spectrumMode,\n  setSpectrumMode,\n  isFullscreen,\n  toggleFullscreen,\n  isMobile,\n}: ControlsMenuProps): ReactElement {\n  const [menuOpen, setMenuOpen] = useState(false);\n  const toggleMenu = useCallback(() => setMenuOpen((v) => !v), []);\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  // Close menu when clicking outside\n  useEffect(() => {\n    if (!menuOpen) return;\n    const handler = (e: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(e.target as Node))\n        setMenuOpen(false);\n    };\n    document.addEventListener(\"mousedown\", handler);\n    return () => document.removeEventListener(\"mousedown\", handler);\n  }, [menuOpen]);\n\n  const lastSpeedIdx = SPEED.STEPS - 1;\n\n  // Drag state for color wheels\n  const [draggingWheel, setDraggingWheel] = useState<'hot' | 'cool' | null>(null);\n\n  // Track gradient direction to avoid flipping\n  const gradientDirectionRef = useRef<number>(0); // +1 = forward, -1 = backward, 0 = uninitialized\n\n  const handleWheelDrag = useCallback((e: MouseEvent, wheelType: 'hot' | 'cool', wheelElement: HTMLDivElement) => {\n    const rect = wheelElement.getBoundingClientRect();\n    const centerX = rect.left + rect.width / 2;\n    const centerY = rect.top + rect.height / 2;\n    const x = e.clientX - centerX;\n    const y = e.clientY - centerY;\n    const angle = Math.atan2(y, x);\n    const hue = ((angle / (2 * Math.PI)) % 1 + 1) % 1;\n    const { r, g, b } = hslToRgb(hue, 1.0, 0.5);\n    const hex = `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;\n\n    if (wheelType === 'hot') {\n      setLavaHighColor(hex);\n    } else {\n      setLavaLowColor(hex);\n    }\n    setRainbowMode(false);\n  }, [setLavaHighColor, setLavaLowColor, setRainbowMode]);\n\n  useEffect(() => {\n    if (!draggingWheel) return;\n\n    // Set drag cursor on body while dragging\n    document.body.style.cursor = \"var(--grabbing)\";\n\n    const handleMouseMove = (e: MouseEvent) => {\n      const wheelElement = document.querySelector(`[data-wheel=\"${draggingWheel}\"]`) as HTMLDivElement;\n      if (wheelElement) {\n        handleWheelDrag(e, draggingWheel, wheelElement);\n      }\n    };\n\n    const handleMouseUp = () => {\n      setDraggingWheel(null);\n    };\n\n    document.addEventListener('mousemove', handleMouseMove);\n    document.addEventListener('mouseup', handleMouseUp);\n\n    return () => {\n      document.removeEventListener('mousemove', handleMouseMove);\n      document.removeEventListener('mouseup', handleMouseUp);\n      // Reset cursor\n      document.body.style.cursor = '';\n    };\n  }, [draggingWheel, handleWheelDrag]);\n\n  // Generate gradient preview (hot to cool)\n  const gradientPreview = useMemo(() => {\n    const stops: string[] = [];\n\n    if (!spectrumMode) {\n      // Gradient mode: simple RGB interpolation\n      return `linear-gradient(to right, ${lavaHighColor}, ${lavaLowColor})`;\n    }\n\n    // Spectrum mode: HSL interpolation with stable direction\n    const loHsl = hexToHsl(lavaLowColor);\n    const hiHsl = hexToHsl(lavaHighColor);\n\n    let h0 = hiHsl.h;\n    let h1 = loHsl.h;\n\n    // Initialize or maintain direction to avoid flipping\n    if (gradientDirectionRef.current === 0) {\n      // First time: choose shorter path\n      const diff = h1 - h0;\n      const wrappedDiff = diff > 0 ? diff - 1 : diff + 1;\n      gradientDirectionRef.current = Math.abs(diff) < Math.abs(wrappedDiff) ? 1 : -1;\n    }\n\n    // Apply consistent direction\n    if (gradientDirectionRef.current === -1) {\n      // Go the \"long way\" around the wheel\n      if (h1 > h0) {\n        h0 += 1;\n      } else {\n        h1 += 1;\n      }\n    }\n    // else use direct path (gradientDirectionRef.current === 1)\n\n    for (let i = 0; i <= 10; i++) {\n      const t = i / 10;\n      let h = h0 + (h1 - h0) * t;\n      while (h > 1) h -= 1;\n      while (h < 0) h += 1;\n\n      // Always use full saturation and medium lightness for vibrant colors\n      const s = 1.0;\n      const l = 0.5;\n\n      const { r, g, b } = hslToRgb(h, s, l);\n      const hex = `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;\n      stops.push(`${hex} ${t * 100}%`);\n    }\n\n    return `linear-gradient(to right, ${stops.join(', ')})`;\n  }, [lavaLowColor, lavaHighColor, spectrumMode]);\n\n  return (\n    <div className=\"lava-lamp-controls\" ref={menuRef}>\n      <button\n        type=\"button\"\n        className=\"lava-lamp-menu-toggle\"\n        onClick={toggleMenu}\n        aria-label={menuOpen ? \"Hide menu\" : \"Show menu\"}\n        aria-pressed={menuOpen}\n      >\n        {menuOpen ? \"\" : \"\"}\n      </button>\n      {menuOpen && (\n        <div className=\"lava-lamp-menu\" style={{ maxHeight: \"65vh\", overflowY: \"auto\" }}>\n          {/* Speed */}\n          <div className=\"lava-lamp-control-block\">\n            <div className=\"lava-lamp-control-header\">\n              <div className=\"lava-lamp-control-title\">speed: {speedIdx}</div>\n            </div>\n            <div className=\"lava-lamp-slider-wrap\">\n              <input\n                className=\"lava-lamp-slider\"\n                type=\"range\"\n                min={0}\n                max={lastSpeedIdx}\n                step={1}\n                value={speedIdx}\n                onChange={(e) =>\n                  setSpeedIdx(clampInt(+e.target.value, 0, lastSpeedIdx))\n                }\n                aria-label=\"Simulation speed\"\n              />\n            </div>\n          </div>\n          {/* Fullscreen */}\n          {!isMobile && (\n            <div className=\"lava-lamp-control-block\">\n              <div className=\"lava-lamp-slider-wrap\">\n                <label\n                  style={{\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    gap: 8,\n                    cursor: \"var(--pointer)\",\n                  }}\n                >\n                  <input\n                    type=\"checkbox\"\n                    className=\"lava-lamp-checkbox\"\n                    checked={isFullscreen}\n                    onChange={toggleFullscreen}\n                  />\n                  <span style={{ fontSize: 13, opacity: 0.9 }}>\n                    fullscreen mode\n                  </span>\n                </label>\n              </div>\n            </div>\n          )}\n          {/* Lava colors */}\n          <div className=\"lava-lamp-control-block\">\n            {/* Rainbow mode toggle */}\n            <div\n              className=\"lava-lamp-slider-wrap\"\n              style={{ marginBottom: 12 }}\n            >\n              <label\n                style={{\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  gap: 8,\n                  cursor: \"var(--pointer)\",\n                }}\n              >\n                <input\n                  type=\"checkbox\"\n                  className=\"lava-lamp-checkbox\"\n                  checked={rainbowMode}\n                  onChange={(e) => setRainbowMode(e.target.checked)}\n                />\n                <span style={{ fontSize: 13, opacity: 0.9 }}>\n                  rainbow drift mode\n                </span>\n              </label>\n            </div>\n            {/* Spectrum/Gradient mode toggle */}\n            <div\n              className=\"lava-lamp-slider-wrap\"\n              style={{ marginBottom: 12 }}\n            >\n              <label\n                style={{\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  gap: 8,\n                  cursor: \"var(--pointer)\",\n                }}\n              >\n                <input\n                  type=\"checkbox\"\n                  className=\"lava-lamp-checkbox\"\n                  checked={spectrumMode}\n                  onChange={(e) => setSpectrumMode(e.target.checked)}\n                />\n                <span style={{ fontSize: 13, opacity: 0.9 }}>\n                  spectrum mode\n                </span>\n              </label>\n            </div>\n            <div style={{ display: \"flex\", justifyContent: \"space-around\", gap: \"16px\", marginBottom: \"8px\" }}>\n              <ColorWheel\n                wheelType=\"hot\"\n                color={lavaHighColor}\n                onColorChange={(hex) => {\n                  setLavaHighColor(hex);\n                  setRainbowMode(false);\n                }}\n                label=\"hot\"\n                rainbowMode={rainbowMode}\n                onMouseDown={() => setDraggingWheel('hot')}\n                draggingWheel={draggingWheel}\n              />\n              <ColorWheel\n                wheelType=\"cool\"\n                color={lavaLowColor}\n                onColorChange={(hex) => {\n                  setLavaLowColor(hex);\n                  setRainbowMode(false);\n                }}\n                label=\"cool\"\n                rainbowMode={rainbowMode}\n                onMouseDown={() => setDraggingWheel('cool')}\n                draggingWheel={draggingWheel}\n              />\n            </div>\n            <div style={{ marginTop: \"8px\" }}>\n              <div\n                style={{\n                  width: \"100%\",\n                  height: \"24px\",\n                  background: gradientPreview,\n                  borderRadius: \"4px\",\n                }}\n                title=\"Color gradient preview\"\n              />\n            </div>\n          </div>\n          {/* Audio Source & Volume */}\n          <div className=\"lava-lamp-control-block\">\n            <div className=\"lava-lamp-control-header\">\n              <div className=\"lava-lamp-control-title\">audio source</div>\n            </div>\n            <div className=\"lava-lamp-slider-wrap\">\n              <select\n                className=\"lava-lamp-slider\"\n                value={audioSource}\n                onChange={(e) => setAudioSource(e.target.value as AudioSource)}\n                aria-label=\"Audio source\"\n              >\n                {Object.entries(AUDIO_SOURCE_CONFIG).map(([k, c]) => (\n                  <option key={k} value={k}>\n                    {c.label}\n                  </option>\n                ))}\n              </select>\n            </div>\n            <div className=\"lava-lamp-control-header\" style={{ marginTop: 12 }}>\n              <div className=\"lava-lamp-control-title\">\n                volume: {Math.round(volume * 100)}%\n              </div>\n            </div>\n            <div className=\"lava-lamp-slider-wrap\">\n              <input\n                className=\"lava-lamp-slider\"\n                type=\"range\"\n                min={0}\n                max={1}\n                step={0.01}\n                value={volume}\n                onChange={(e) => setVolume(+e.target.value)}\n                aria-label=\"Music volume\"\n              />\n            </div>\n          </div>\n          {/* Power off */}\n          <div className=\"lava-lamp-control-block\">\n            <button\n              type=\"button\"\n              className=\"lava-lamp-power-off\"\n              onClick={() => window.location.reload()}\n              aria-label=\"Power off\"\n            >\n              <img\n                src={powerIcon}\n                alt=\"Power off\"\n                className=\"lava-lamp-power-off-icon\"\n              />\n              <span>power off</span>\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","/**\n * Audio amplitude analysis for visualizing music playback.\n * Uses Web Audio API's AnalyserNode to extract real-time amplitude data.\n */\n\nexport class AudioAmplitudeAnalyzer {\n  private audioContext: AudioContext | null = null;\n  private analyser: AnalyserNode | null = null;\n  private dataArray: Uint8Array | null = null;\n  private connected = false;\n\n  /**\n   * Initialize and connect the analyser to an audio element.\n   * Must be called after user interaction to avoid autoplay restrictions.\n   */\n  connect(audioElement: HTMLAudioElement): boolean {\n    if (this.connected) return true;\n\n    try {\n      // @ts-ignore - Some browsers use webkitAudioContext\n      const AudioContextClass = window.AudioContext || window.webkitAudioContext;\n\n      if (!AudioContextClass) {\n        console.warn('[AudioAmplitude] AudioContext not supported');\n        return false;\n      }\n\n      this.audioContext = new AudioContextClass();\n      this.analyser = this.audioContext.createAnalyser();\n      this.analyser.fftSize = 256; // Small size for performance\n      this.analyser.smoothingTimeConstant = 0.95; // Higher = smoother (0-1 range)\n\n      const source = this.audioContext.createMediaElementSource(audioElement);\n      source.connect(this.analyser).connect(this.audioContext.destination);\n\n      this.dataArray = new Uint8Array(this.analyser.frequencyBinCount);\n      this.connected = true;\n\n      // Immediately try to resume if suspended\n      if (this.audioContext.state === 'suspended') {\n        this.audioContext.resume();\n      }\n\n      return true;\n    } catch (err) {\n      console.warn('[AudioAmplitude] Failed to connect analyser:', err);\n      return false;\n    }\n  }\n\n  /**\n   * Get current amplitude as a value between 0 and 1.\n   * Uses RMS (root mean square) for smooth, accurate amplitude measurement.\n   */\n  getAmplitude(): number {\n    if (!this.analyser || !this.dataArray) return 0;\n\n    try {\n      // Get time domain data (waveform)\n      this.analyser.getByteTimeDomainData(this.dataArray);\n\n      // Calculate RMS amplitude\n      let sum = 0;\n      for (let i = 0; i < this.dataArray.length; i++) {\n        const normalized = (this.dataArray[i] - 128) / 128;\n        sum += normalized * normalized;\n      }\n\n      const rms = Math.sqrt(sum / this.dataArray.length);\n\n      // Boost the signal for better visualization (typical music is quiet)\n      return Math.min(1, rms * 3);\n    } catch (err) {\n      console.warn('[AudioAmplitude] Error reading amplitude:', err);\n      return 0;\n    }\n  }\n\n  /**\n   * Get waveform values for multiple bars (e.g., 4 bars for visualization).\n   * Samples different points in the waveform and returns normalized values [0-1].\n   */\n  getWaveformBars(barCount: number): number[] {\n    if (!this.analyser || !this.dataArray) {\n      return new Array(barCount).fill(0);\n    }\n\n    try {\n      // Get time domain data (waveform)\n      this.analyser.getByteTimeDomainData(this.dataArray);\n\n      const bars: number[] = [];\n      const step = Math.floor(this.dataArray.length / barCount);\n\n      for (let i = 0; i < barCount; i++) {\n        const index = i * step;\n        // Convert byte value (0-255, centered at 128) to 0-1 range\n        const normalized = Math.abs((this.dataArray[index] - 128) / 128);\n        // Very gentle boost for smooth, calm visualization\n        bars.push(Math.min(1, normalized * 1.2));\n      }\n\n      return bars;\n    } catch (err) {\n      console.warn('[AudioAmplitude] Error reading waveform:', err);\n      return new Array(barCount).fill(0);\n    }\n  }\n\n  /**\n   * Resume audio context if suspended (required on some browsers after page load).\n   */\n  resume(): void {\n    if (this.audioContext && this.audioContext.state === 'suspended') {\n      this.audioContext.resume().catch((err) => {\n        console.warn('[AudioAmplitude] Failed to resume audio context:', err);\n      });\n    }\n  }\n\n  /**\n   * Clean up resources.\n   */\n  disconnect(): void {\n    if (this.audioContext) {\n      this.audioContext.close().catch(() => {\n        // ignore\n      });\n      this.audioContext = null;\n    }\n    this.analyser = null;\n    this.dataArray = null;\n    this.connected = false;\n  }\n\n  isConnected(): boolean {\n    return this.connected;\n  }\n}\n","import { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { PersonalAudio } from \"../../util/Audio\";\nimport { AudioAmplitudeAnalyzer } from \"../../util/audioAmplitude.ts\";\nimport { AUDIO_SOURCES } from \"../config.ts\";\nimport {\n  readSavedMusicTimeSeconds,\n  writeSavedMusicTimeSeconds,\n} from \"../helpers.ts\";\nimport { AUDIO_SOURCE_CONFIG, CLICK_AUDIO_URL } from \"../audioConfig.ts\";\nimport type { AudioSource } from \"../config.ts\";\n\nexport function useAudioManagement(hasStarted: boolean) {\n  const [audioSource, setAudioSource] = useState<AudioSource>(\n    AUDIO_SOURCES.KEXP\n  );\n  const [volume, setVolume] = useState(1.0);\n\n  // Audio instances\n  const gameMusic = useMemo(() => {\n    const audio = new PersonalAudio(\n      AUDIO_SOURCE_CONFIG[AUDIO_SOURCES.KEXP].url,\n      true\n    );\n    audio.preload = \"auto\";\n    return audio;\n  }, []);\n\n  const clickSound = useMemo(\n    () => new PersonalAudio(CLICK_AUDIO_URL, false),\n    []\n  );\n\n  // Amplitude analyzer\n  const amplitudeAnalyzerRef = useRef<AudioAmplitudeAnalyzer | null>(null);\n  const currentWaveformRef = useRef<number[]>(Array(10).fill(0));\n  const [displayWaveform, setDisplayWaveform] = useState<number[]>(\n    Array(10).fill(0)\n  );\n  const waveformUpdateCounterRef = useRef(0);\n\n  // Volume effect\n  useEffect(() => {\n    gameMusic.volume = volume;\n  }, [volume, gameMusic]);\n\n  // Audio source change handler\n  const isFirstRender = useRef(true);\n  useEffect(() => {\n    if (isFirstRender.current) {\n      isFirstRender.current = false;\n      return;\n    }\n\n    const config = AUDIO_SOURCE_CONFIG[audioSource];\n    // preserve current play state\n    const shouldKeepPlaying = !gameMusic.paused;\n\n    // one call handles mp3/aac/m3u8\n    gameMusic.setSource(config.url, { autoplay: shouldKeepPlaying }).catch(() => { });\n  }, [audioSource, gameMusic]);\n\n\n  // Music position saving\n  const saveMusicPosition = useCallback(() => {\n    writeSavedMusicTimeSeconds(gameMusic.currentTime ?? 0);\n  }, [gameMusic]);\n\n  useEffect(() => {\n    if (!hasStarted) return;\n    const id = window.setInterval(saveMusicPosition, 1000);\n    const onPageHide = () => saveMusicPosition();\n    const onVisibility = () => {\n      if (document.visibilityState === \"hidden\") saveMusicPosition();\n    };\n    window.addEventListener(\"pagehide\", onPageHide);\n    document.addEventListener(\"visibilitychange\", onVisibility);\n    return () => {\n      clearInterval(id);\n      window.removeEventListener(\"pagehide\", onPageHide);\n      document.removeEventListener(\"visibilitychange\", onVisibility);\n    };\n  }, [hasStarted, saveMusicPosition]);\n\n  // Global cleanup on unmount\n  useEffect(\n    () => () => {\n      saveMusicPosition();\n      gameMusic.pause();\n      gameMusic.volume = 0;\n      gameMusic.reset();\n      clickSound.pause();\n      clickSound.volume = 0;\n      clickSound.reset();\n      amplitudeAnalyzerRef.current?.disconnect();\n      amplitudeAnalyzerRef.current = null;\n    },\n    [gameMusic, clickSound, saveMusicPosition]\n  );\n\n  // Utility functions\n  const playClick = useCallback(() => {\n    try {\n      clickSound.volume = 1;\n      clickSound.currentTime = 0;\n      clickSound.reset();\n      clickSound.play();\n    } catch { }\n  }, [clickSound]);\n\n  const resumeMusicFromSavedTime = useCallback(() => {\n    const t = readSavedMusicTimeSeconds();\n    try {\n      const dur = (gameMusic as any).duration;\n      gameMusic.currentTime =\n        typeof dur === \"number\" && Number.isFinite(dur) && dur > 0\n          ? t % dur\n          : t;\n    } catch { }\n  }, [gameMusic]);\n\n  const updateWaveform = useCallback(() => {\n    if (amplitudeAnalyzerRef.current) {\n      currentWaveformRef.current =\n        amplitudeAnalyzerRef.current.getWaveformBars(10);\n      if (++waveformUpdateCounterRef.current >= 5) {\n        setDisplayWaveform(currentWaveformRef.current);\n        waveformUpdateCounterRef.current = 0;\n      }\n    }\n  }, []);\n\n  const initializeAmplitudeAnalyzer = useCallback(() => {\n    if (!amplitudeAnalyzerRef.current) {\n      const analyzer = new AudioAmplitudeAnalyzer();\n      const connected = analyzer.connect(gameMusic);\n      if (connected) {\n        amplitudeAnalyzerRef.current = analyzer;\n      } else {\n        // Retry connection once audio starts playing\n        const onPlaying = () => {\n          if (!amplitudeAnalyzerRef.current && analyzer.connect(gameMusic)) {\n            amplitudeAnalyzerRef.current = analyzer;\n          }\n          gameMusic.removeEventListener('playing', onPlaying);\n        };\n        gameMusic.addEventListener('playing', onPlaying, { once: true });\n      }\n    }\n  }, [gameMusic]);\n\n  const resumeAmplitudeAnalyzer = useCallback(() => {\n    amplitudeAnalyzerRef.current?.resume();\n  }, []);\n\n  // Ensure AudioContext resumes when audio plays (important for mobile)\n  useEffect(() => {\n    if (!hasStarted) return;\n    const handlePlay = () => {\n      amplitudeAnalyzerRef.current?.resume();\n    };\n    gameMusic.addEventListener('play', handlePlay);\n    return () => gameMusic.removeEventListener('play', handlePlay);\n  }, [hasStarted, gameMusic]);\n\n  return {\n    audioSource,\n    setAudioSource,\n    volume,\n    setVolume,\n    gameMusic,\n    clickSound,\n    displayWaveform,\n    amplitudeAnalyzerRef,\n    playClick,\n    resumeMusicFromSavedTime,\n    updateWaveform,\n    initializeAmplitudeAnalyzer,\n    resumeAmplitudeAnalyzer,\n  };\n}\n","import { useEffect, useRef, useState } from \"react\";\nimport {\n  hexToHue,\n  hslToHex,\n  hslToRgb,\n  hexToHsl,\n} from \"../colors.ts\";\n\n// Generate random starting colors between 90 and 270 degrees apart\nfunction generateRandomColors(): { low: string; high: string } {\n  const hue1 = Math.random();\n\n  // Generate separation between 90 and 270 degrees\n  const minSeparation = 90 / 360;\n  const maxSeparation = 270 / 360;\n  const separation = minSeparation + Math.random() * (maxSeparation - minSeparation);\n\n  // Randomly choose direction\n  const direction = Math.random() < 0.5 ? 1 : -1;\n  const hue2 = (hue1 + separation * direction + 1) % 1;\n\n  const color1 = hslToRgb(hue1, 1.0, 0.5);\n  const color2 = hslToRgb(hue2, 1.0, 0.5);\n\n  const hex1 = `#${color1.r.toString(16).padStart(2, '0')}${color1.g.toString(16).padStart(2, '0')}${color1.b.toString(16).padStart(2, '0')}`;\n  const hex2 = `#${color2.r.toString(16).padStart(2, '0')}${color2.g.toString(16).padStart(2, '0')}${color2.b.toString(16).padStart(2, '0')}`;\n\n  return { low: hex1, high: hex2 };\n}\n\n// Build heat LUT with stable direction (spectrum mode)\nfunction buildStableHeatLut256(\n  lowHex: string,\n  highHex: string,\n  directionRef: React.MutableRefObject<number>,\n  useSpectrum: boolean\n): Uint32Array {\n  const lut = new Uint32Array(256);\n\n  if (!useSpectrum) {\n    // Gradient mode: simple RGB interpolation\n    const lowRgb = hexToRgb(lowHex);\n    const highRgb = hexToRgb(highHex);\n\n    for (let i = 0; i < 256; ++i) {\n      const t = i / 255;\n      const r = Math.round(lowRgb.r + (highRgb.r - lowRgb.r) * t);\n      const g = Math.round(lowRgb.g + (highRgb.g - lowRgb.g) * t);\n      const b = Math.round(lowRgb.b + (highRgb.b - lowRgb.b) * t);\n      lut[i] = ((255 << 24) | (b << 16) | (g << 8) | r) >>> 0;\n    }\n    return lut;\n  }\n\n  // Spectrum mode: HSL interpolation with stable direction\n  const loHsl = hexToHsl(lowHex);\n  const hiHsl = hexToHsl(highHex);\n\n  let h0 = loHsl.h;\n  let h1 = hiHsl.h;\n\n  // Initialize or maintain direction\n  if (directionRef.current === 0) {\n    const diff = h1 - h0;\n    const wrappedDiff = diff > 0 ? diff - 1 : diff + 1;\n    directionRef.current = Math.abs(diff) < Math.abs(wrappedDiff) ? 1 : -1;\n  }\n\n  // Apply consistent direction\n  if (directionRef.current === -1) {\n    if (h1 > h0) {\n      h0 += 1;\n    } else {\n      h1 += 1;\n    }\n  }\n\n  for (let i = 0; i < 256; ++i) {\n    const t = i / 255;\n    let h = h0 + (h1 - h0) * t;\n    while (h > 1) h -= 1;\n    while (h < 0) h += 1;\n\n    // Always use full saturation and medium lightness for vibrant colors\n    const s = 1.0;\n    const l = 0.5;\n\n    const { r, g, b } = hslToRgb(h, s, l);\n    lut[i] = ((255 << 24) | (b << 16) | (g << 8) | r) >>> 0;\n  }\n  return lut;\n}\n\nfunction hexToRgb(hex: string): { r: number; g: number; b: number } {\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result\n    ? {\n        r: parseInt(result[1], 16),\n        g: parseInt(result[2], 16),\n        b: parseInt(result[3], 16),\n      }\n    : { r: 0, g: 0, b: 0 };\n}\n\nconst initialColors = generateRandomColors();\nconst initialSpectrumMode = Math.random() < 0.25;\n\nexport function useColorManagement(speedRef: React.MutableRefObject<number>) {\n  const [lavaLowColor, setLavaLowColor] = useState(initialColors.low);\n  const [lavaHighColor, setLavaHighColor] = useState(initialColors.high);\n  const [rainbowMode, setRainbowMode] = useState(false);\n  const [spectrumMode, setSpectrumMode] = useState(initialSpectrumMode);\n\n  const gradientDirectionRef = useRef<number>(0);\n  const heatLutRef = useRef<Uint32Array>(\n    buildStableHeatLut256(initialColors.low, initialColors.high, gradientDirectionRef, initialSpectrumMode)\n  );\n  const lavaLowColorRef = useRef(initialColors.low);\n  const lavaHighColorRef = useRef(initialColors.high);\n\n  // Update heat LUT when colors or mode change\n  useEffect(() => {\n    lavaLowColorRef.current = lavaLowColor;\n    lavaHighColorRef.current = lavaHighColor;\n    heatLutRef.current = buildStableHeatLut256(lavaLowColor, lavaHighColor, gradientDirectionRef, spectrumMode);\n  }, [lavaLowColor, lavaHighColor, spectrumMode]);\n\n  // Rainbow mode: drift hues over time\n  const rainbowLowHueRef = useRef(0);\n  const rainbowHighHueRef = useRef(0);\n  const rainbowLowSpeedRef = useRef(1);\n  const rainbowHighSpeedRef = useRef(1.3);\n  const prevRainbow = useRef(false);\n\n  useEffect(() => {\n    if (rainbowMode && !prevRainbow.current) {\n      // Start from current colors\n      rainbowLowHueRef.current = hexToHue(lavaLowColor);\n      rainbowHighHueRef.current = hexToHue(lavaHighColor);\n      // Random drift speeds: 0.5x to 2x base rate, random direction\n      const lowSpeed = 0.5 + Math.random() * 1.5;\n      const highSpeed = 0.5 + Math.random() * 1.5;\n      const lowDirection = Math.random() < 0.5 ? 1 : -1;\n      const highDirection = Math.random() < 0.5 ? 1 : -1;\n      rainbowLowSpeedRef.current = lowSpeed * lowDirection;\n      rainbowHighSpeedRef.current = highSpeed * highDirection;\n    }\n    prevRainbow.current = rainbowMode;\n  }, [rainbowMode, lavaLowColor, lavaHighColor]);\n\n  useEffect(() => {\n    if (!rainbowMode) return;\n    let id: number,\n      lastT = performance.now();\n    const tick = (now: number) => {\n      const dt = now - lastT;\n      lastT = now;\n      const s = speedRef.current,\n        norm = dt / 16.67,\n        base = 0.02;\n      rainbowLowHueRef.current =\n        (rainbowLowHueRef.current + base * s * norm * rainbowLowSpeedRef.current) % 360;\n      rainbowHighHueRef.current =\n        (rainbowHighHueRef.current + base * s * norm * rainbowHighSpeedRef.current) % 360;\n\n      // If within 45 degrees, ensure they're moving apart as fast as possible\n      const lowHue = rainbowLowHueRef.current;\n      const highHue = rainbowHighHueRef.current;\n      const diff = highHue - lowHue;\n      const wrappedDiff = diff > 0 ? diff - 360 : diff + 360;\n\n      // Use signed distance to determine which way is shorter\n      const signedDistance = Math.abs(diff) < Math.abs(wrappedDiff) ? diff : wrappedDiff;\n      const angularDistance = Math.abs(signedDistance);\n\n      if (angularDistance < 45) {\n        const lowSpeed = rainbowLowSpeedRef.current;\n        const highSpeed = rainbowHighSpeedRef.current;\n\n        // Determine correct directions to maximize separation\n        const lowShouldBeNegative = signedDistance > 0;\n        const highShouldBePositive = signedDistance > 0;\n\n        // Fix directions if they're wrong, with new random speeds\n        if (lowShouldBeNegative && lowSpeed > 0) {\n          const newSpeed = 0.5 + Math.random() * 1.5;\n          rainbowLowSpeedRef.current = -newSpeed;\n        } else if (!lowShouldBeNegative && lowSpeed < 0) {\n          const newSpeed = 0.5 + Math.random() * 1.5;\n          rainbowLowSpeedRef.current = newSpeed;\n        }\n\n        if (highShouldBePositive && highSpeed < 0) {\n          const newSpeed = 0.5 + Math.random() * 1.5;\n          rainbowHighSpeedRef.current = newSpeed;\n        } else if (!highShouldBePositive && highSpeed > 0) {\n          const newSpeed = 0.5 + Math.random() * 1.5;\n          rainbowHighSpeedRef.current = -newSpeed;\n        }\n      }\n\n      setLavaLowColor(hslToHex(rainbowLowHueRef.current, 1, 0.5));\n      setLavaHighColor(hslToHex(rainbowHighHueRef.current, 1, 0.5));\n      id = requestAnimationFrame(tick);\n    };\n    id = requestAnimationFrame(tick);\n    return () => cancelAnimationFrame(id);\n  }, [rainbowMode, speedRef]);\n\n  return {\n    lavaLowColor,\n    setLavaLowColor,\n    lavaHighColor,\n    setLavaHighColor,\n    rainbowMode,\n    setRainbowMode,\n    spectrumMode,\n    setSpectrumMode,\n    heatLutRef,\n  };\n}\n","/**\n * Physics simulation and particle behavior\n */\n\nimport type { Particle, Vec2, SpatialGrid } from \"./config.ts\";\nimport {\n  SIM,\n  CLUMPS,\n  PARTICLES_PER_PIXEL,\n  MAX_PARTICLES,\n  computeBuoyancy,\n  computeHeatRate,\n  computeCoolRate,\n  computeHeatSourceDistance,\n  computeScaleFactor,\n  computeCohesionRadius,\n  computeMouseHeatRadius,\n  computeClumpRadius\n} from \"./config.ts\";\nimport { gridIndex } from \"./helpers.ts\";\n\n// Math utilities\nexport function clamp01(v: number): number {\n  return v < 0 ? 0 : v > 1 ? 1 : v;\n}\n\nexport function lerp(a: number, b: number, t: number): number {\n  return a + (b - a) * t;\n}\n\nexport function randInCircle(radius: number): Vec2 {\n  const angle = Math.random() * Math.PI * 2;\n  const r = Math.random() * radius;\n  return { x: Math.cos(angle) * r, y: Math.sin(angle) * r };\n}\n\n// Particle bounds checking\nexport function bounceInBounds(\n  p: Particle,\n  width: number,\n  height: number\n): void {\n  if (p.x < 0) {\n    p.x = 0;\n    p.vx *= -0.5;\n  } else if (p.x > width) {\n    p.x = width;\n    p.vx *= -0.5;\n  }\n\n  if (p.y < 0) {\n    p.y = 0;\n    p.vy *= -0.5;\n  } else if (p.y > height) {\n    p.y = height;\n    p.vy *= -0.5;\n  }\n}\n\nexport function clampAllToBounds(\n  particles: Particle[],\n  width: number,\n  height: number\n): void {\n  for (let i = 0; i < particles.length; i++) {\n    bounceInBounds(particles[i], width, height);\n  }\n}\n\n// Particle count calculation\nexport function computeParticleCount(width: number, height: number): number {\n  const area = width * height;\n  const scaleFactor = computeScaleFactor(width, height);\n  // Compensate for particle radius scaling: divide by scaleFactor\n  // This keeps visual density constant across screen sizes\n  const desired = Math.round((area * PARTICLES_PER_PIXEL) / (scaleFactor * scaleFactor));\n  return Math.min(desired, MAX_PARTICLES);\n}\n\n// Particle creation\nexport function createParticles(\n  width: number,\n  height: number,\n  count: number,\n  scaleFactor: number\n): Particle[] {\n  const particles: Particle[] = [];\n  const particlesPerClump = Math.floor(count / CLUMPS.COUNT);\n  const clumpRadius = computeClumpRadius(scaleFactor);\n\n  for (let i = 0; i < CLUMPS.COUNT; i++) {\n    const centerX = Math.random() * width;\n    const centerY =\n      Math.random() < CLUMPS.TOP_HALF_PROB\n        ? Math.random() * height * 0.5\n        : height * 0.5 + Math.random() * height * 0.5;\n\n    const clumpHeat = Math.random();\n    for (let j = 0; j < particlesPerClump; j++) {\n      const offset = randInCircle(clumpRadius);\n      particles.push({\n        x: centerX + offset.x,\n        y: centerY + offset.y,\n        vx: 0,\n        vy: 0,\n        heat: clumpHeat,\n      });\n    }\n  }\n\n  while (particles.length < count) {\n    particles.push({\n      x: Math.random() * width,\n      y: Math.random() * height,\n      vx: 0,\n      vy: 0,\n      heat: 0,\n    });\n  }\n\n  return particles;\n}\n\n// Physics forces\nexport function applyBuoyancyAndGravity(p: Particle, dt: number, buoyancy: number): void {\n  const buoyancyForce = p.heat * p.heat * buoyancy;\n  p.vy += (SIM.GRAVITY - buoyancyForce) * dt;\n}\n\nexport function applyFriction(p: Particle, dt: number): void {\n  const f = Math.pow(SIM.FRICTION, dt);\n  p.vx *= f;\n  p.vy *= f;\n}\n\nexport function integrate(p: Particle, dt: number): void {\n  p.x += p.vx * dt;\n  p.y += p.vy * dt;\n}\n\nexport function applyPointerHeat(\n  p: Particle,\n  pointerPos: Vec2,\n  dt: number,\n  scaleFactor: number,\n  heatRate: number,\n  cooling: boolean = false\n): void {\n  const dx = p.x - pointerPos.x;\n  const dy = p.y - pointerPos.y;\n  const d2 = dx * dx + dy * dy;\n  const r = computeMouseHeatRadius(scaleFactor);\n  const r2 = r * r;\n\n  if (d2 < r2) {\n    const d = Math.sqrt(d2);\n    const intensity = 1 - d * (1 / r);\n    const heatChange = heatRate * 10 * intensity * dt;\n    p.heat += cooling ? -heatChange : heatChange;\n  }\n}\n\nexport function applyCohesionImpulse(\n  p1: Particle,\n  p2: Particle,\n  dx: number,\n  dy: number,\n  d: number,\n  dt: number,\n  cohesionRadius: number\n): void {\n  const force = SIM.COHESION_STRENGTH * (1 - d * (1 / cohesionRadius));\n  const invD = 1 / d;\n  const fx = dx * invD * force * dt;\n  const fy = dy * invD * force * dt;\n\n  p1.vx += fx;\n  p1.vy += fy;\n  p2.vx -= fx;\n  p2.vy -= fy;\n}\n\nexport function applyHeatConduction(\n  p1: Particle,\n  p2: Particle,\n  dt: number\n): void {\n  const heatDiff = p1.heat - p2.heat;\n  const conduction = heatDiff * SIM.HEAT_CONDUCTION * dt;\n  p1.heat -= conduction;\n  p2.heat += conduction;\n}\n\nexport function applyBottomHeatOrAirCooling(\n  p: Particle,\n  height: number,\n  neighborCount: number,\n  dt: number,\n  scaleFactor: number,\n  heatRate: number\n): void {\n  const distanceFromBottom = height - p.y;\n  const heatSourceDistance = computeHeatSourceDistance(scaleFactor);\n\n  if (distanceFromBottom < heatSourceDistance) {\n    const intensity = 1 - distanceFromBottom * (1 / heatSourceDistance);\n    p.heat += heatRate * intensity * dt;\n    return;\n  }\n\n  const maxNeighbors = 8;\n  const neighbors = neighborCount < maxNeighbors ? neighborCount : maxNeighbors;\n  const airExposure = 1 - neighbors / maxNeighbors;\n\n  const coolRate = computeCoolRate(scaleFactor);\n  p.heat -= coolRate * (0.2 + airExposure * 0.8) * dt;\n}\n\n// Main simulation step\nexport function stepSimulationOnePairPass(\n  particles: Particle[],\n  width: number,\n  height: number,\n  pointerDown: boolean,\n  pointerPos: Vec2,\n  neighborCounts: Uint16Array,\n  timeScale: number,\n  grid: SpatialGrid,\n  pointerCooling: boolean = false\n): void {\n  const dt = Math.max(0, Math.min(4.0, timeScale));\n  const scaleFactor = computeScaleFactor(width, height);\n  const cohesionRadius = computeCohesionRadius(scaleFactor);\n  const buoyancy = computeBuoyancy(scaleFactor);\n  const heatRate = computeHeatRate(scaleFactor);\n\n  // Pass 1: integrate + pointer heat + reset neighbors + bounds\n  for (let i = 0; i < particles.length; i++) {\n    const p = particles[i];\n\n    applyBuoyancyAndGravity(p, dt, buoyancy);\n    applyFriction(p, dt);\n    integrate(p, dt);\n\n    if (pointerDown) applyPointerHeat(p, pointerPos, dt, scaleFactor, heatRate, pointerCooling);\n\n    neighborCounts[i] = 0;\n    bounceInBounds(p, width, height);\n  }\n\n  // dt=0 => frozen (no cohesion/conduction/cooling), but still clamp\n  if (dt === 0) {\n    for (let i = 0; i < particles.length; i++) {\n      particles[i].heat = clamp01(particles[i].heat);\n    }\n    clampAllToBounds(particles, width, height);\n    return;\n  }\n\n  // Build spatial hash\n  grid.heads.fill(-1);\n  const invCell = 1 / grid.cellSize;\n\n  for (let i = 0; i < particles.length; i++) {\n    const p = particles[i];\n\n    let cx = (p.x * invCell) | 0;\n    let cy = (p.y * invCell) | 0;\n\n    if (cx < 0) cx = 0;\n    else if (cx >= grid.cols) cx = grid.cols - 1;\n\n    if (cy < 0) cy = 0;\n    else if (cy >= grid.rows) cy = grid.rows - 1;\n\n    const cell = gridIndex(grid, cx, cy);\n    grid.next[i] = grid.heads[cell];\n    grid.heads[cell] = i;\n  }\n\n  // Pass 2: local neighbor forces + conduction\n  const r = cohesionRadius;\n  const r2 = r * r;\n\n  for (let i = 0; i < particles.length; i++) {\n    const p1 = particles[i];\n\n    let cx = (p1.x * invCell) | 0;\n    let cy = (p1.y * invCell) | 0;\n\n    if (cx < 0) cx = 0;\n    else if (cx >= grid.cols) cx = grid.cols - 1;\n\n    if (cy < 0) cy = 0;\n    else if (cy >= grid.rows) cy = grid.rows - 1;\n\n    const x0 = cx > 0 ? cx - 1 : cx;\n    const x1 = cx + 1 < grid.cols ? cx + 1 : cx;\n    const y0 = cy > 0 ? cy - 1 : cy;\n    const y1 = cy + 1 < grid.rows ? cy + 1 : cy;\n\n    for (let ny = y0; ny <= y1; ny++) {\n      for (let nx = x0; nx <= x1; nx++) {\n        let j = grid.heads[gridIndex(grid, nx, ny)];\n        while (j !== -1) {\n          if (j > i) {\n            const p2 = particles[j];\n            const dx = p2.x - p1.x;\n            const dy = p2.y - p1.y;\n            const d2 = dx * dx + dy * dy;\n\n            if (d2 > 0 && d2 < r2) {\n              neighborCounts[i]++;\n              neighborCounts[j]++;\n\n              const d = Math.sqrt(d2);\n              applyCohesionImpulse(p1, p2, dx, dy, d, dt, cohesionRadius);\n              applyHeatConduction(p1, p2, dt);\n            }\n          }\n          j = grid.next[j];\n        }\n      }\n    }\n  }\n\n  // Pass 3: bottom heat / air cooling + clamp heat + bounds\n  for (let i = 0; i < particles.length; i++) {\n    const p = particles[i];\n    applyBottomHeatOrAirCooling(p, height, neighborCounts[i], dt, scaleFactor, heatRate);\n    p.heat = clamp01(p.heat);\n  }\n\n  clampAllToBounds(particles, width, height);\n}\n","/**\n * Canvas rendering utilities for metaball effect (performance optimized)\n */\n\nimport type React from \"react\";\nimport type { Particle } from \"./config.ts\";\nimport { RENDER, computePixelSize, computeScaleFactor, computeParticleRadius } from \"./config.ts\";\nimport { packRgba } from \"./colors.ts\";\n\n// Cached black value for fill (avoid recomputation)\nconst BLACK_RGBA = packRgba(0, 0, 0, 255);\n\n/**\n * Ensures a properly-sized ImageData instance\n */\nexport function ensureImageData(\n  ctx: CanvasRenderingContext2D,\n  imageRef: React.MutableRefObject<ImageData | null>,\n  width: number,\n  height: number\n): ImageData {\n  const img = imageRef.current;\n  if (!img || img.width !== width || img.height !== height) {\n    imageRef.current = ctx.createImageData(width, height);\n  }\n  return imageRef.current!;\n}\n\n/**\n * Rapidly fills a pixel block given a color.\n * Hot loop with tight bounds checking.\n */\nfunction fillPixelBlockFast(\n  data32: Uint32Array,\n  x: number,\n  y: number,\n  px: number,\n  w: number,\n  h: number,\n  rgba: number\n) {\n  const ymax = Math.min(y + px, h);\n  const xmax = Math.min(x + px, w);\n  for (let yy = y; yy < ymax; yy++) {\n    let idx = yy * w + x;\n    for (let xx = x; xx < xmax; xx++) {\n      data32[idx++] = rgba;\n    }\n  }\n}\n\n/**\n * Metaball rendering (brute force for all particles per pixel).\n */\nexport function drawMetaballs(\n  imageData: ImageData,\n  particles: Particle[],\n  canvasWidth: number,\n  canvasHeight: number,\n  heatLut256: Uint32Array,\n  pixelSize: number\n): void {\n  const threshold = RENDER.THRESHOLD;\n  const scaleFactor = computeScaleFactor(canvasWidth, canvasHeight);\n  const particleRadius = computeParticleRadius(scaleFactor);\n  const particleRadiusSquared = particleRadius * particleRadius;\n  const data32 = new Uint32Array(imageData.data.buffer);\n\n  // Fill the entire image with black using the cached RGBA value.\n  data32.fill(BLACK_RGBA);\n\n  const width = canvasWidth;\n  const height = canvasHeight;\n\n  for (let y = 0; y < height; y += pixelSize) {\n    for (let x = 0; x < width; x += pixelSize) {\n      let influenceSum = 0;\n      let heatSum = 0;\n\n      // Calculate influence from all particles at this block's top-left corner.\n      for (let i = 0; i < particles.length; ++i) {\n        const p = particles[i];\n        const dx = x - p.x;\n        const dy = y - p.y;\n        const distanceSquared = dx * dx + dy * dy;\n        const influence = particleRadiusSquared / (distanceSquared + 1);\n\n        influenceSum += influence;\n        heatSum += influence * p.heat;\n      }\n\n      // Only render if total influence exceeds the threshold.\n      if (influenceSum <= threshold) continue;\n\n      // Weighted average color based on influence.\n      const heat = heatSum / influenceSum;\n      const lutIdx = heat <= 0 ? 0 : heat >= 1 ? 255 : (heat * 255) | 0;\n      const colorRgba = heatLut256[lutIdx];\n\n      fillPixelBlockFast(data32, x, y, pixelSize, width, height, colorRgba);\n    }\n  }\n}\n\n/**\n * Renders a frame.\n */\nexport function renderFrame(\n  ctx: CanvasRenderingContext2D,\n  canvas: HTMLCanvasElement,\n  particles: Particle[],\n  imageRef: React.MutableRefObject<ImageData | null>,\n  heatLut256: Uint32Array\n): void {\n  const imageData = ensureImageData(ctx, imageRef, canvas.width, canvas.height);\n  const pixelSize = computePixelSize(canvas.width, canvas.height);\n\n  drawMetaballs(\n    imageData,\n    particles,\n    canvas.width,\n    canvas.height,\n    heatLut256,\n    pixelSize\n  );\n\n  ctx.putImageData(imageData, 0, 0);\n}\n","import { useCallback, useEffect, useRef, RefObject } from \"react\";\nimport {\n  computeParticleCount,\n  createParticles,\n  stepSimulationOnePairPass,\n} from \"../physics.ts\";\nimport { renderFrame } from \"../rendering.ts\";\nimport { ensureGrid } from \"../helpers.ts\";\nimport { FIXED_MS, MAX_CATCHUP_STEPS, computeScaleFactor, computeCohesionRadius } from \"../config.ts\";\nimport type { Particle, SpatialGrid, Vec2 } from \"../config.ts\";\n\ninterface UseSimulationParams {\n  canvasRef: RefObject<HTMLCanvasElement | null>;\n  ctxRef: React.MutableRefObject<CanvasRenderingContext2D | null>;\n  pointerDownRef: React.MutableRefObject<boolean>;\n  pointerCoolingRef: React.MutableRefObject<boolean>;\n  pointerPosRef: React.MutableRefObject<Vec2>;\n  speedRef: React.MutableRefObject<number>;\n  heatLutRef: React.MutableRefObject<Uint32Array>;\n  updateWaveform: () => void;\n}\n\nexport function useSimulation({\n  canvasRef,\n  ctxRef,\n  pointerDownRef,\n  pointerCoolingRef,\n  pointerPosRef,\n  speedRef,\n  heatLutRef,\n  updateWaveform,\n}: UseSimulationParams) {\n  const particlesRef = useRef<Particle[]>([]);\n  const imageRef = useRef<ImageData | null>(null);\n  const neighborCountsRef = useRef<Uint16Array>(new Uint16Array(0));\n  const particleCountRef = useRef<number | null>(null);\n  const gridRef = useRef<SpatialGrid | null>(null);\n  const sizeRef = useRef<{ w: number; h: number }>({ w: 1, h: 1 });\n  const rafRef = useRef<number | null>(null);\n  const clockRef = useRef<{ last: number; acc: number }>({ last: 0, acc: 0 });\n\n  // Canvas initial setup\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const w = window.innerWidth,\n      h = window.innerHeight;\n    sizeRef.current = { w, h };\n    canvas.width = w;\n    canvas.height = h;\n    ctxRef.current = canvas.getContext(\"2d\");\n    imageRef.current = null;\n  }, [canvasRef, ctxRef]);\n\n  // Initialize particles\n  const initializeParticlesOnce = useCallback(() => {\n    const { w, h } = sizeRef.current;\n    if (particleCountRef.current === null)\n      particleCountRef.current = computeParticleCount(w, h);\n    const count = particleCountRef.current;\n    const scaleFactor = computeScaleFactor(w, h);\n    particlesRef.current = createParticles(w, h, count, scaleFactor);\n    neighborCountsRef.current = new Uint16Array(count);\n    const cohesionRadius = computeCohesionRadius(scaleFactor);\n    ensureGrid(gridRef, w, h, count, cohesionRadius);\n  }, []);\n\n  // Update simulation one step\n  const updateOnce = useCallback(() => {\n    const g = gridRef.current,\n      { w, h } = sizeRef.current;\n    if (!g) return;\n    stepSimulationOnePairPass(\n      particlesRef.current,\n      w,\n      h,\n      pointerDownRef.current,\n      pointerPosRef.current,\n      neighborCountsRef.current,\n      speedRef.current,\n      g,\n      pointerCoolingRef.current\n    );\n  }, [pointerDownRef, pointerPosRef, speedRef, pointerCoolingRef]);\n\n  // Draw frame\n  const draw = useCallback(() => {\n    const canvas = canvasRef.current,\n      ctx = ctxRef.current;\n    if (!canvas || !ctx) return;\n    renderFrame(\n      ctx,\n      canvas,\n      particlesRef.current,\n      imageRef,\n      heatLutRef.current\n    );\n  }, [canvasRef, ctxRef, heatLutRef]);\n\n  // Animation loop\n  const animate = useCallback(\n    (now: number) => {\n      const clock = clockRef.current;\n      if (!clock.last) clock.last = now;\n      let delta = now - clock.last;\n      clock.last = now;\n      clock.acc += Math.min(250, Math.max(0, delta));\n      let steps = 0;\n      while (clock.acc >= FIXED_MS && steps < MAX_CATCHUP_STEPS) {\n        updateOnce();\n        clock.acc -= FIXED_MS;\n        steps++;\n      }\n      if (clock.acc >= FIXED_MS) clock.acc = 0;\n\n      updateWaveform();\n      draw();\n      rafRef.current = requestAnimationFrame(animate);\n    },\n    [draw, updateOnce, updateWaveform]\n  );\n\n  // Start simulation\n  const startSimulation = useCallback(() => {\n    initializeParticlesOnce();\n    clockRef.current = { last: 0, acc: 0 };\n    requestAnimationFrame(() => draw());\n    rafRef.current = requestAnimationFrame(animate);\n  }, [initializeParticlesOnce, draw, animate]);\n\n  // Cleanup on unmount\n  useEffect(\n    () => () => {\n      if (rafRef.current !== null) cancelAnimationFrame(rafRef.current);\n    },\n    []\n  );\n\n  return {\n    particlesRef,\n    sizeRef,\n    imageRef,\n    startSimulation,\n  };\n}\n","import React, {\n  ReactElement,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport powerIcon from \"../assets/lavaLamp/power.svg\";\nimport \"../styles/lavalamp.css\";\nimport NowPlayingWidget from \"./NowPlayingWidget.tsx\";\nimport ControlsMenu from \"./components/ControlsMenu.tsx\";\nimport { useAudioManagement } from \"./hooks/useAudioManagement.ts\";\nimport { useColorManagement } from \"./hooks/useColorManagement.ts\";\nimport { useFullscreen } from \"./hooks/useFullscreen.ts\";\nimport { useNowPlaying } from \"./hooks/useNowPlaying.ts\";\nimport { usePointerHandling } from \"./hooks/usePointerHandling.ts\";\nimport { useSimulation } from \"./hooks/useSimulation.ts\";\nimport { AUDIO_SOURCES, detectMobile } from \"./config.ts\";\nimport { indexToSpeed } from \"./helpers.ts\";\n\nexport default function LavaLamp(): ReactElement {\n  const isMobile = detectMobile();\n\n  // Core refs\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const ctxRef = useRef<CanvasRenderingContext2D | null>(null);\n\n  // State\n  const [hasStarted, setHasStarted] = useState(false);\n\n  // Speed control\n  const defaultSpeedIdx = 5;\n  const [speedIdx, setSpeedIdx] = useState<number>(defaultSpeedIdx);\n  const speedRef = useRef<number>(indexToSpeed(defaultSpeedIdx));\n\n  useEffect(() => {\n    speedRef.current = indexToSpeed(speedIdx);\n  }, [speedIdx]);\n\n  // Audio management hook\n  const {\n    audioSource,\n    setAudioSource,\n    volume,\n    setVolume,\n    gameMusic,\n    displayWaveform,\n    playClick,\n    resumeMusicFromSavedTime,\n    updateWaveform,\n    initializeAmplitudeAnalyzer,\n    resumeAmplitudeAnalyzer,\n  } = useAudioManagement(hasStarted);\n\n  // Color management hook\n  const {\n    lavaLowColor,\n    setLavaLowColor,\n    lavaHighColor,\n    setLavaHighColor,\n    rainbowMode,\n    setRainbowMode,\n    spectrumMode,\n    setSpectrumMode,\n    heatLutRef,\n  } = useColorManagement(speedRef);\n\n  // Pointer handling hook\n  const { pointerDownRef, pointerCoolingRef, pointerPosRef } =\n    usePointerHandling(canvasRef);\n\n  // Simulation hook\n  const { particlesRef, sizeRef, imageRef, startSimulation } = useSimulation({\n    canvasRef,\n    ctxRef,\n    pointerDownRef,\n    pointerCoolingRef,\n    pointerPosRef,\n    speedRef,\n    heatLutRef,\n    updateWaveform,\n  });\n\n  // Fullscreen hook\n  const { isFullscreen, toggleFullscreen } = useFullscreen({\n    canvasRef,\n    particlesRef,\n    sizeRef,\n    imageRef,\n  });\n\n  // Now playing hook\n  const { nowPlaying, nowPlayingExpanded, setNowPlayingExpanded } =\n    useNowPlaying(hasStarted, audioSource);\n\n  // Update document title with song info\n  useEffect(() => {\n    if (nowPlaying && !nowPlaying.isAirbreak) {\n      document.title = `${nowPlaying.song} - ${nowPlaying.artist}`;\n    } else {\n      document.title = \"connor.lava-lamp-radio\";\n    }\n  }, [nowPlaying]);\n\n  // Start lamp\n  const startLamp = useCallback(async () => {\n    playClick();\n    if (!hasStarted) {\n      setHasStarted(true);\n      startSimulation();\n      initializeAmplitudeAnalyzer();\n    }\n    resumeAmplitudeAnalyzer();\n    if (audioSource !== AUDIO_SOURCES.KEXP) resumeMusicFromSavedTime();\n    gameMusic.volume = 1.0;\n    if (gameMusic.readyState < 3) {\n      gameMusic.load();\n      const onCanPlay = async () => {\n        try {\n          await gameMusic.play();\n        } catch {}\n        gameMusic.removeEventListener(\"canplaythrough\", onCanPlay);\n      };\n      gameMusic.addEventListener(\"canplaythrough\", onCanPlay, { once: true });\n    } else {\n      try {\n        await gameMusic.play();\n      } catch {}\n    }\n  }, [\n    playClick,\n    hasStarted,\n    startSimulation,\n    initializeAmplitudeAnalyzer,\n    resumeAmplitudeAnalyzer,\n    audioSource,\n    resumeMusicFromSavedTime,\n    gameMusic,\n  ]);\n\n  // Initial canvas size\n  const initialCanvasSize = useMemo(\n    () => ({\n      w: window.innerWidth,\n      h: window.innerHeight,\n    }),\n    []\n  );\n\n  return (\n    <div className=\"lava-lamp-container\">\n      <canvas\n        ref={canvasRef}\n        className=\"lava-lamp-canvas\"\n        width={initialCanvasSize.w}\n        height={initialCanvasSize.h}\n      />\n      <NowPlayingWidget\n        nowPlaying={nowPlaying}\n        displayWaveform={displayWaveform}\n        expanded={nowPlayingExpanded}\n        onToggle={() => setNowPlayingExpanded((v) => !v)}\n      />\n      {!hasStarted ? (\n        <div className=\"lava-lamp-start-overlay\">\n          <button\n            type=\"button\"\n            className=\"lava-lamp-start\"\n            onClick={startLamp}\n            aria-label=\"Start lava lamp radio\"\n          >\n            <img src={powerIcon} alt=\"Power\" className=\"lava-lamp-start-icon\" />\n          </button>\n        </div>\n      ) : (\n        <ControlsMenu\n          speedIdx={speedIdx}\n          setSpeedIdx={setSpeedIdx}\n          volume={volume}\n          setVolume={setVolume}\n          audioSource={audioSource}\n          setAudioSource={setAudioSource}\n          lavaLowColor={lavaLowColor}\n          setLavaLowColor={setLavaLowColor}\n          lavaHighColor={lavaHighColor}\n          setLavaHighColor={setLavaHighColor}\n          rainbowMode={rainbowMode}\n          setRainbowMode={setRainbowMode}\n          spectrumMode={spectrumMode}\n          setSpectrumMode={setSpectrumMode}\n          isFullscreen={isFullscreen}\n          toggleFullscreen={toggleFullscreen}\n          isMobile={isMobile}\n        />\n      )}\n    </div>\n  );\n}\n","import { useEffect, useRef, RefObject } from \"react\";\nimport type { Vec2 } from \"../config.ts\";\n\nexport function usePointerHandling(canvasRef: RefObject<HTMLCanvasElement | null>) {\n  const pointerDownRef = useRef(false);\n  const pointerCoolingRef = useRef(false);\n  const pointerPosRef = useRef<Vec2>({ x: 0, y: 0 });\n\n  useEffect(() => {\n    const c = canvasRef.current;\n    if (!c) return;\n\n    const toLocal = (e: PointerEvent) => {\n      const rect = c.getBoundingClientRect();\n      return { x: e.clientX - rect.left, y: e.clientY - rect.top };\n    };\n\n    const onDown = (e: PointerEvent) => {\n      pointerDownRef.current = true;\n      pointerCoolingRef.current =\n        e.button === 2 || (e.button === 0 && e.ctrlKey);\n      pointerPosRef.current = toLocal(e);\n    };\n\n    const onMove = (e: PointerEvent) => (pointerPosRef.current = toLocal(e));\n\n    const onUp = () => {\n      pointerDownRef.current = false;\n      pointerCoolingRef.current = false;\n    };\n\n    c.addEventListener(\"pointerdown\", onDown);\n    c.addEventListener(\"contextmenu\", (e) => e.preventDefault());\n    window.addEventListener(\"pointermove\", onMove);\n    window.addEventListener(\"pointerup\", onUp);\n    window.addEventListener(\"pointercancel\", onUp);\n\n    return () => {\n      c.removeEventListener(\"pointerdown\", onDown);\n      window.removeEventListener(\"pointermove\", onMove);\n      window.removeEventListener(\"pointerup\", onUp);\n      window.removeEventListener(\"pointercancel\", onUp);\n    };\n  }, [canvasRef]);\n\n  return {\n    pointerDownRef,\n    pointerCoolingRef,\n    pointerPosRef,\n  };\n}\n","import { useCallback, useEffect, useState, RefObject } from \"react\";\nimport { clampAllToBounds } from \"../physics.ts\";\nimport type { Particle } from \"../config.ts\";\n\ninterface UseFullscreenParams {\n  canvasRef: RefObject<HTMLCanvasElement | null>;\n  particlesRef: React.MutableRefObject<Particle[]>;\n  sizeRef: React.MutableRefObject<{ w: number; h: number }>;\n  imageRef: React.MutableRefObject<ImageData | null>;\n}\n\nexport function useFullscreen({\n  canvasRef,\n  particlesRef,\n  sizeRef,\n  imageRef,\n}: UseFullscreenParams) {\n  const [isFullscreen, setIsFullscreen] = useState(false);\n\n  useEffect(() => {\n    const handler = () => {\n      setIsFullscreen(!!document.fullscreenElement);\n      document.body.classList.toggle(\n        \"lava-lamp-fullscreen\",\n        !!document.fullscreenElement\n      );\n\n      // Resize canvas\n      const canvas = canvasRef.current;\n      if (canvas) {\n        const w = window.innerWidth,\n          h = window.innerHeight;\n        canvas.width = w;\n        canvas.height = h;\n        sizeRef.current = { w, h };\n        imageRef.current = null;\n        particlesRef.current && clampAllToBounds(particlesRef.current, w, h);\n      }\n    };\n    document.addEventListener(\"fullscreenchange\", handler);\n    return () => {\n      document.removeEventListener(\"fullscreenchange\", handler);\n      document.body.classList.remove(\"lava-lamp-fullscreen\");\n    };\n  }, [canvasRef, particlesRef, sizeRef, imageRef]);\n\n  const toggleFullscreen = useCallback(() => {\n    if (!document.fullscreenElement) {\n      document.documentElement.requestFullscreen?.().catch(() => {});\n    } else {\n      document.exitFullscreen?.();\n    }\n  }, []);\n\n  return {\n    isFullscreen,\n    toggleFullscreen,\n  };\n}\n","import { useEffect, useState } from \"react\";\nimport type { AudioSource, NowPlayingInfo } from \"../config.ts\";\nimport { AUDIO_SOURCES, INFO_URLS } from \"../config.ts\";\n\nexport function useNowPlaying(hasStarted: boolean, audioSource: AudioSource) {\n  const [nowPlaying, setNowPlaying] = useState<NowPlayingInfo | null>(null);\n  const [nowPlayingExpanded, setNowPlayingExpanded] = useState(true);\n\n  useEffect(() => {\n    if (!hasStarted || audioSource === AUDIO_SOURCES.REDWOOD) {\n      setNowPlaying(null);\n      return;\n    }\n    let timer: number;\n    const fetchNowPlaying = async () => {\n      const infoUrl = INFO_URLS[audioSource];\n      try {\n        const info = await fetch(infoUrl);\n        const data = await info.json();\n        console.log(data)\n        const play = data.results?.[0];\n        if (!play) return;\n        if (play.play_type === \"airbreak\")\n          setNowPlaying({\n            song: \"airbreak\",\n            artist: \"\",\n            album: \"\",\n            isAirbreak: true,\n            station: audioSource,\n          });\n        else if (play.play_type === \"trackplay\")\n          setNowPlaying({\n            song: (play.song || \"unknown track\").toLowerCase(),\n            artist: (play.artist || \"unknown artist\").toLowerCase(),\n            album: (play.album || \"\").toLowerCase(),\n            isAirbreak: false,\n            station: audioSource,\n          });\n      } catch (e) {\n        console.error(\"failed to fetch track info\", e);\n      }\n    };\n\n    fetchNowPlaying();\n    timer = window.setInterval(fetchNowPlaying, 5000);\n    return () => clearInterval(timer);\n  }, [hasStarted, audioSource]);\n\n  return {\n    nowPlaying,\n    nowPlayingExpanded,\n    setNowPlayingExpanded,\n  };\n}\n","import Hls from \"hls.js\";\n\nexport class PersonalAudio extends Audio {\n  constructor(src, loop = false) {\n    super();\n    this.crossOrigin = \"anonymous\";\n    this.loop = loop;\n\n    this._hls = null;\n    this._logicalSrc = null;\n\n    // --- Fix 2: sequence guard to avoid races ---\n    this._setSourceSeq = 0;\n\n    if (src) this.setSource(src, { autoplay: false, loop });\n  }\n\n  get logicalSrc() {\n    return this._logicalSrc ?? this.src;\n  }\n\n  async setSource(src, { autoplay = false, loop = this.loop } = {}) {\n    // --- Fix 2: bump seq; any previous in-flight setSource becomes stale ---\n    const seq = ++this._setSourceSeq;\n\n    this.loop = loop;\n    this.crossOrigin = \"anonymous\";\n\n    // Better than isPlaying() for streams\n    const shouldAutoplay = autoplay || !this.paused;\n\n    this.pause();\n\n    this._detachHls();\n    this._logicalSrc = src;\n\n    const isHls = /\\.m3u8(\\?.*)?$/i.test(src);\n\n    // HLS: Safari plays natively; others need hls.js\n    const canNativeHls =\n      isHls && this.canPlayType(\"application/vnd.apple.mpegurl\") !== \"\";\n\n    // Non-HLS OR native-HLS (Safari): use plain Audio src\n    if (!isHls || canNativeHls) {\n      this.src = src;\n      this.load();\n      if (shouldAutoplay) {\n        await this._safePlayWhenReady();\n        if (seq !== this._setSourceSeq) return; // stale\n      }\n      return;\n    }\n\n    // HLS (non-Safari)\n    if (!Hls.isSupported()) {\n      throw new Error(\"HLS not supported in this browser (no MSE).\");\n    }\n\n    const hls = new Hls();\n    this._hls = hls;\n\n    hls.attachMedia(this);\n    hls.loadSource(src);\n\n    hls.on(Hls.Events.ERROR, (_evt, data) => {\n      console.error(\"hls.js error\", data);\n      if (!data.fatal) return;\n\n      if (data.type === Hls.ErrorTypes.NETWORK_ERROR) hls.startLoad();\n      if (data.type === Hls.ErrorTypes.MEDIA_ERROR) hls.recoverMediaError();\n    });\n\n    if (!shouldAutoplay) return;\n\n    await new Promise((resolve, reject) => {\n      const onParsed = () => {\n        hls.off(Hls.Events.MANIFEST_PARSED, onParsed);\n        resolve();\n      };\n      const onErr = (_evt, data) => {\n        if (!data.fatal) return;\n        hls.off(Hls.Events.ERROR, onErr);\n        reject(new Error(`Fatal HLS error: ${data.type} / ${data.details}`));\n      };\n      hls.on(Hls.Events.MANIFEST_PARSED, onParsed);\n      hls.on(Hls.Events.ERROR, onErr);\n    });\n\n    if (seq !== this._setSourceSeq) return; // stale\n    await this._safePlay();\n  }\n\n  _detachHls() {\n    if (!this._hls) return;\n    try {\n      this._hls.destroy();\n    } finally {\n      this._hls = null;\n    }\n  }\n\n  async _safePlayWhenReady() {\n    if (this.readyState >= 3) return this._safePlay();\n\n    await new Promise((resolve) => {\n      const onCanPlay = () => resolve();\n      this.addEventListener(\"canplay\", onCanPlay, { once: true });\n      this.addEventListener(\"error\", () => resolve(), { once: true });\n    });\n\n    await this._safePlay();\n  }\n\n  async _safePlay() {\n    try {\n      await this.play();\n    } catch {\n      // autoplay blocked etc.\n    }\n  }\n\n  isPlayingSrc = (audioSrc) => {\n    const s = this.logicalSrc ?? \"\";\n    return s.includes(audioSrc) && this.isPlaying();\n  };\n\n  isPlaying = () =>\n    this.currentTime > 0 && !this.paused && !this.ended && this.readyState > 2;\n\n  timeLeft = () => this.duration - this.currentTime;\n\n  reset = () => {\n    this.pause();\n    try {\n      this.currentTime = 0;\n    } catch {}\n  };\n\n  destroy = () => {\n    this.reset();\n    this._detachHls();\n    this.removeAttribute(\"src\");\n    this.load();\n  };\n}\n"],"names":["NowPlayingWidget","_ref","nowPlaying","displayWaveform","expanded","onToggle","nowPlayingSongRef","useRef","nowPlayingArtistRef","nowPlayingAlbumRef","songOverflowing","setSongOverflowing","useState","artistOverflowing","setArtistOverflowing","albumOverflowing","setAlbumOverflowing","useEffect","handleOverflowCheck","elementRef","setOverflowing","current","wrapper","querySelector","containerWidth","clientWidth","isOverflowing","scrollWidth","duration","delayFraction","style","setProperty","concat","classList","add","remove","checkAllOverflow","window","addEventListener","removeEventListener","_jsxs","className","children","_jsx","type","onClick","station","isAirbreak","map","height","i","ref","handleSongClick","open","cursor","title","song","_Fragment","artist","album","detectMobile","userAgent","navigator","vendor","opera","isMobileUA","test","hasTouch","maxTouchPoints","isSmallScreen","innerWidth","isMobile","AUDIO_SOURCES","REDWOOD","KEXP","BBC6MUSIC","INFO_URLS","SIM","GRAVITY","BUOYANCY_BASE","FRICTION","HEAT_RATE_BASE","COOL_RATE_BASE","HEAT_CONDUCTION","HEAT_SOURCE_DISTANCE_BASE","COHESION_RADIUS_BASE","COHESION_STRENGTH","MOUSE_HEAT_RADIUS_BASE","computeCohesionRadius","scaleFactor","RENDER","PARTICLE_RADIUS_BASE","THRESHOLD","computeScaleFactor","width","area","Math","sqrt","CLUMPS","COUNT","RADIUS_BASE","TOP_HALF_PROB","PARTICLES_PER_PIXEL","MAX_PARTICLES","SPEED","MIN","MAX","DEFAULT","STEPS","FIXED_MS","MAX_CATCHUP_STEPS","MUSIC_TIME_KEY","AUDIO_SOURCE_CONFIG","label","url","musicAudioNoise","info","CLICK_AUDIO_URL","clickAudioNoise","indexToSpeed","idx","steps","t","minPositive","targetMidSpeed","minLog","log","maxLog","exp","gridIndex","g","cx","cy","cols","hexToRgb","hex","h","slice","length","r","hexCharToNibble","b","c","code","charCodeAt","hslToHex","s","l","a","min","f","n","k","x","max","val","round","toString","hex2","hexToHue","rf","gf","bf","delta","hue","hslToRgb","hue2rgb","p","q","tt","hexToHsl","rgbToHsl","ColorWheel","wheelType","color","onColorChange","rainbowMode","onMouseDown","draggingWheel","rgb","result","exec","parseInt","isDragging","display","flexDirection","alignItems","gap","position","opacity","e","rect","currentTarget","getBoundingClientRect","centerX","centerY","clientX","left","y","clientY","top","atan2","PI","padStart","borderRadius","background","WebkitMask","mask","cos","sin","backgroundColor","border","boxShadow","transform","fontSize","fontFamily","String","ControlsMenu","speedIdx","setSpeedIdx","volume","setVolume","audioSource","setAudioSource","lavaLowColor","setLavaLowColor","lavaHighColor","setLavaHighColor","setRainbowMode","spectrumMode","setSpectrumMode","isFullscreen","toggleFullscreen","menuOpen","setMenuOpen","toggleMenu","useCallback","v","menuRef","handler","contains","target","document","lastSpeedIdx","setDraggingWheel","gradientDirectionRef","handleWheelDrag","wheelElement","body","handleMouseMove","handleMouseUp","gradientPreview","useMemo","stops","loHsl","h0","h1","diff","wrappedDiff","abs","push","join","maxHeight","overflowY","step","value","onChange","hi","lo","checked","marginBottom","justifyContent","marginTop","Object","entries","_ref2","location","reload","src","powerIcon","alt","AudioAmplitudeAnalyzer","constructor","audioContext","analyser","dataArray","connected","connect","audioElement","this","AudioContextClass","AudioContext","webkitAudioContext","console","warn","createAnalyser","fftSize","smoothingTimeConstant","createMediaElementSource","destination","Uint8Array","frequencyBinCount","state","resume","err","getAmplitude","getByteTimeDomainData","sum","normalized","rms","getWaveformBars","barCount","Array","fill","bars","floor","index","catch","disconnect","close","isConnected","useAudioManagement","hasStarted","gameMusic","audio","PersonalAudio","preload","clickSound","amplitudeAnalyzerRef","currentWaveformRef","setDisplayWaveform","waveformUpdateCounterRef","isFirstRender","config","shouldKeepPlaying","paused","setSource","autoplay","saveMusicPosition","_gameMusic$currentTim","seconds","Number","isFinite","localStorage","setItem","_unused2","writeSavedMusicTimeSeconds","currentTime","id","setInterval","onPageHide","onVisibility","visibilityState","clearInterval","_amplitudeAnalyzerRef","pause","reset","playClick","play","_unused","resumeMusicFromSavedTime","raw","getItem","readSavedMusicTimeSeconds","dur","updateWaveform","initializeAmplitudeAnalyzer","analyzer","onPlaying","once","resumeAmplitudeAnalyzer","_amplitudeAnalyzerRef2","handlePlay","_amplitudeAnalyzerRef3","buildStableHeatLut256","lowHex","highHex","directionRef","useSpectrum","lut","Uint32Array","lowRgb","highRgb","hiHsl","initialColors","hue1","random","hue2","color1","color2","low","high","generateRandomColors","initialSpectrumMode","clamp01","randInCircle","radius","angle","bounceInBounds","vx","vy","clampAllToBounds","particles","createParticles","count","particlesPerClump","clumpRadius","computeClumpRadius","clumpHeat","j","offset","heat","applyBuoyancyAndGravity","dt","buoyancy","buoyancyForce","applyFriction","pow","integrate","applyPointerHeat","pointerPos","heatRate","cooling","arguments","undefined","dx","dy","d2","computeMouseHeatRadius","heatChange","applyCohesionImpulse","p1","p2","d","cohesionRadius","force","invD","fx","fy","applyHeatConduction","conduction","applyBottomHeatOrAirCooling","neighborCount","distanceFromBottom","heatSourceDistance","computeHeatSourceDistance","intensity","airExposure","coolRate","computeCoolRate","stepSimulationOnePairPass","pointerDown","neighborCounts","timeScale","grid","pointerCooling","computeBuoyancy","computeHeatRate","heads","invCell","cellSize","rows","cell","next","r2","x0","x1","y0","y1","ny","nx","BLACK_RGBA","fillPixelBlockFast","data32","px","w","rgba","ymax","xmax","yy","xx","drawMetaballs","imageData","canvasWidth","canvasHeight","heatLut256","pixelSize","threshold","particleRadius","computeParticleRadius","particleRadiusSquared","data","buffer","influenceSum","heatSum","influence","renderFrame","ctx","canvas","imageRef","img","createImageData","ensureImageData","adaptivePixelSize","computePixelSize","putImageData","useSimulation","canvasRef","ctxRef","pointerDownRef","pointerCoolingRef","pointerPosRef","speedRef","heatLutRef","particlesRef","neighborCountsRef","Uint16Array","particleCountRef","gridRef","sizeRef","rafRef","clockRef","last","acc","innerHeight","getContext","initializeParticlesOnce","desired","computeParticleCount","ceil","cells","Int32Array","ensureGrid","updateOnce","draw","animate","now","clock","requestAnimationFrame","startSimulation","cancelAnimationFrame","LavaLamp","setHasStarted","lavaLowColorRef","lavaHighColorRef","rainbowLowHueRef","rainbowHighHueRef","rainbowLowSpeedRef","rainbowHighSpeedRef","prevRainbow","lowSpeed","highSpeed","lowDirection","highDirection","lastT","performance","tick","norm","lowHue","signedDistance","lowShouldBeNegative","highShouldBePositive","newSpeed","useColorManagement","toLocal","onDown","button","ctrlKey","onMove","onUp","preventDefault","usePointerHandling","setIsFullscreen","fullscreenElement","toggle","_document$exitFullscr","_document","_document$documentEle","_document$documentEle2","exitFullscreen","call","documentElement","requestFullscreen","useFullscreen","nowPlayingExpanded","setNowPlayingExpanded","setNowPlaying","timer","fetchNowPlaying","async","infoUrl","_data$results","fetch","json","results","play_type","toLowerCase","error","useNowPlaying","startLamp","readyState","load","onCanPlay","initialCanvasSize","Audio","loop","super","isPlayingSrc","audioSrc","_this$logicalSrc","logicalSrc","includes","isPlaying","ended","timeLeft","destroy","_detachHls","removeAttribute","crossOrigin","_hls","_logicalSrc","_setSourceSeq","_this$_logicalSrc","seq","shouldAutoplay","isHls","canNativeHls","canPlayType","_safePlayWhenReady","Hls","Error","hls","attachMedia","loadSource","on","ERROR","_evt","fatal","NETWORK_ERROR","startLoad","MEDIA_ERROR","recoverMediaError","Promise","resolve","reject","onParsed","off","MANIFEST_PARSED","onErr","details","_safePlay"],"sourceRoot":""}