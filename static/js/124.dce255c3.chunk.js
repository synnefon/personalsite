"use strict";(self.webpackChunkpersonalsite=self.webpackChunkpersonalsite||[]).push([[124],{9406:(e,t,n)=>{n.r(t),n.d(t,{default:()=>se});var r=n(5043);const a=n.p+"static/media/power.632cc1e66922cf3fa35d93370ea84178.svg",o=n.p+"static/media/guitar.7c3177d2baeb887643cc.mp3",s=n.p+"static/media/click.1c87678ffc4ae6835e44.mp3";let i=function(e){return e.forest="forest",e.kexp="kexp",e.bbcradio6music="bbc radio 6 music",e.nts1="nts 1",e.nts2="nts 2",e.kcrw="kcrw",e}({});const c=()=>{const e=navigator.userAgent||navigator.vendor||window.opera||"",t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e),n="ontouchstart"in window||navigator.maxTouchPoints>0,r=window.innerWidth<=500;return t||n&&r},l=c(),u={GRAVITY:.01,BUOYANCY_BASE:.04,FRICTION:.98,HEAT_RATE_BASE:.005,COOL_RATE_BASE:.0017,HEAT_CONDUCTION:.002,HEAT_SOURCE_DISTANCE_BASE:45,COHESION_RADIUS_BASE:25,COHESION_STRENGTH:.0035,MOUSE_HEAT_RADIUS_BASE:100};function d(e){return u.COHESION_RADIUS_BASE*e}const h={PARTICLE_RADIUS_BASE:10,THRESHOLD:.8};function m(e,t){const n=e*t;return Math.sqrt(n/1288920)}const p={COUNT:15,RADIUS_BASE:l?30:50,TOP_HALF_PROB:.3};const f=l?54e-5:61e-5,v=2e3,g={MIN:0,MAX:5,DEFAULT:.25,STEPS:10},w=1e3/60,y=5,b="lava-lamp-music-time",x={[i.forest]:{label:"redwood resonance",url:o,info:null,homepage:"https://youtu.be/t3LCXpKI9K0?si=LnBH9g-s6e1wuEhw"},[i.kexp]:{label:"kexp",url:"https://kexp.streamguys1.com/kexp160.aac",info:"https://api.kexp.org/v2/plays/?limit=5",homepage:"https://www.kexp.org/playlist/"},[i.nts1]:{label:"nts 1",url:"https://stream-relay-geo.ntslive.net/stream",info:"https://bbc-now-playing.connor-j-hopkins.workers.dev/nts/track/now?channel=1&limit=5",homepage:"https://www.nts.live/"},[i.nts2]:{label:"nts 2",url:"https://stream-relay-geo.ntslive.net/stream2",info:"https://bbc-now-playing.connor-j-hopkins.workers.dev/nts/track/now?channel=2&limit=5",homepage:"https://www.nts.live/"},[i.kcrw]:{label:"kcrw",url:"https://kcrw.streamguys1.com/kcrw_192k_aac_on_air",info:"https://bbc-now-playing.connor-j-hopkins.workers.dev/kcrw/now",homepage:"https://www.kcrw.com/music/shows"},[i.bbcradio6music]:{label:"bbc radio 6 music",url:"http://as-hls-ww-live.akamaized.net/pool_81827798/live/ww/bbc_6music/bbc_6music.isml/bbc_6music-audio%3d96000.norewind.m3u8",info:"https://bbc-now-playing.connor-j-hopkins.workers.dev/bbc/6music/now",homepage:"https://www.bbc.co.uk/sounds/play/live/bbc_6music"}},S=s;var A=n(579);function E(e){let{nowPlaying:t,displayWaveform:n,expanded:a,onToggle:o}=e;const s=(0,r.useRef)(null),i=(0,r.useRef)(null),c=(0,r.useRef)(null),[l,u]=(0,r.useState)(!1),[d,h]=(0,r.useState)(!1),[m,p]=(0,r.useState)(!1);if((0,r.useEffect)((()=>{function e(e,t){if(!e.current)return;const n=e.current.querySelector(".scroll-wrapper"),r=e.current.clientWidth,a=n&&n.scrollWidth>r;if(t(!!a),a&&n){const t=n.scrollWidth/30,r=1;e.current.style.setProperty("--scroll-duration","".concat(t,"s")),e.current.style.setProperty("--second-copy-delay","".concat(r)),e.current.classList.add("overflowing")}else e.current.classList.remove("overflowing")}function t(){e(s,u),e(i,h),e(c,p)}return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)}),[t,a]),!t)return null;return(0,A.jsxs)("div",{className:"lava-lamp-now-playing ".concat(a?"expanded":"collapsed"),children:[(0,A.jsx)("button",{type:"button",className:"lava-lamp-now-playing-toggle",onClick:o,"aria-label":a?"Collapse now playing":"Expand now playing",children:a?">":"<"}),(0,A.jsxs)("div",{className:"lava-lamp-now-playing-content",children:[(0,A.jsxs)("div",{className:"lava-lamp-now-playing-header",children:[(0,A.jsx)("div",{className:"lava-lamp-now-playing-label",children:t.station}),!t.isAirbreak&&(0,A.jsx)("div",{className:"lava-lamp-soundwave",children:n.map(((e,t)=>(0,A.jsx)("div",{className:"lava-lamp-soundwave-bar",style:{"--bar-height":e}},t)))})]}),(0,A.jsxs)("div",{ref:s,className:"lava-lamp-now-playing-song",onClick:()=>{const e=x[t.station].homepage||"";window.open(e,"_blank","noopener,noreferrer")},style:{cursor:"var(--pointer)"},title:"see station homepage",children:[(0,A.jsx)("span",{className:"scroll-wrapper",children:t.song}),l&&(0,A.jsx)("span",{className:"scroll-wrapper second",children:t.song})]}),!t.isAirbreak&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{ref:i,className:"lava-lamp-now-playing-artist",children:[(0,A.jsx)("span",{className:"scroll-wrapper",children:t.artist}),d&&(0,A.jsx)("span",{className:"scroll-wrapper second",children:t.artist})]}),(0,A.jsxs)("div",{ref:c,className:"lava-lamp-now-playing-album",children:[(0,A.jsx)("span",{className:"scroll-wrapper",children:t.album}),m&&(0,A.jsx)("span",{className:"scroll-wrapper second",children:t.album})]})]})]})]})}function M(e){if(e<=0)return 0;const t=g.STEPS;if(e>=t)return g.MAX;const n=e/t,r=.25/g.MAX,a=Math.log(r),o=Math.log(g.MAX);return Math.exp(a+(o-a)*n)}function R(e,t,n){return n*e.cols+t}function C(e){let t=e;return"#"===t[0]&&(t=t.slice(1)),6===t.length?{r:16*k(t[0])+k(t[1]),g:16*k(t[2])+k(t[3]),b:16*k(t[4])+k(t[5])}:3===t.length?{r:17*k(t[0]),g:17*k(t[1]),b:17*k(t[2])}:{r:255,g:221,b:0}}function k(e){const t=e.charCodeAt(0);return t>=48&&t<=57?t-48:t>=65&&t<=70?t-55:t>=97&&t<=102?t-87:0}function j(e,t,n){const r=t*Math.min(n,1-n);function a(t){const a=(t+e/30)%12,o=n-r*Math.max(Math.min(a-3,9-a,1),-1);let s=Math.round(255*o);return s=s<0?0:s>255?255:s,function(e){return e<16?"0"+e.toString(16):e.toString(16)}(s)}return"#".concat(a(0)).concat(a(8)).concat(a(4))}function N(e){const{r:t,g:n,b:r}=C(e),a=.00392156862745098*t,o=.00392156862745098*n,s=.00392156862745098*r,i=a>o?a>s?a:s:o>s?o:s,c=i-(a<o?a<s?a:s:o<s?o:s);if(c<1e-6)return 0;let l;return l=i===a?(o-s)/c%6:i===o?(s-a)/c+2:(a-o)/c+4,l=Math.round(60*l),l<0&&(l+=360),l}function _(e,t,n){let r,a,o;if(t<1e-5)r=a=o=n;else{const s=(e,t,n)=>{let r=n;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e},i=n<.5?n*(1+t):n+t-n*t,c=2*n-i;r=s(c,i,e+1/3),a=s(c,i,e),o=s(c,i,e-1/3)}return{r:Math.round(255*r),g:Math.round(255*a),b:Math.round(255*o)}}function L(e){const{r:t,g:n,b:r}=C(e);return function(e,t,n){const r=e/255,a=t/255,o=n/255,s=Math.max(r,a,o),i=Math.min(r,a,o),c=s-i,l=(s+i)/2;if(c<1e-5)return{h:0,s:0,l:l};let u;return u=s===r?((a-o)/c+(a<o?6:0))/6:s===a?((o-r)/c+2)/6:((r-a)/c+4)/6,{h:u,s:l>.5?c/(2-s-i):c/(s+i),l:l}}(t,n,r)}function T(e){let{wheelType:t,color:n,onColorChange:r,label:a,rainbowMode:o,onMouseDown:s,draggingWheel:i}=e;const c=function(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}}(n),l=i===t;return(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:[(0,A.jsxs)("div",{"data-wheel":t,style:{position:"relative",width:"80px",height:"80px",cursor:o?"var(--not-allowed)":l?"var(--grabbing)":"var(--pointer)",opacity:o?.5:1},onClick:e=>{if(o||i)return;const t=e.currentTarget.getBoundingClientRect(),n=t.width/2,a=t.height/2,s=e.clientX-t.left-n,c=e.clientY-t.top-a,l=(Math.atan2(c,s)/(2*Math.PI)%1+1)%1,{r:u,g:d,b:h}=_(l,1,.5),m="#".concat(u.toString(16).padStart(2,"0")).concat(d.toString(16).padStart(2,"0")).concat(h.toString(16).padStart(2,"0"));r(m)},onMouseDown:e=>{o||s()},children:[(0,A.jsx)("div",{style:{width:"100%",height:"100%",borderRadius:"50%",background:"conic-gradient(from 90deg, red, yellow, lime, cyan, blue, magenta, red)",WebkitMask:"radial-gradient(circle, transparent 35%, black 35%)",mask:"radial-gradient(circle, transparent 35%, black 35%)"}}),(0,A.jsx)("div",{style:{position:"absolute",left:"".concat(50+37*Math.cos(2*L(n).h*Math.PI),"%"),top:"".concat(50+37*Math.sin(2*L(n).h*Math.PI),"%"),width:"18px",height:"18px",borderRadius:"50%",backgroundColor:n,border:"2px solid white",boxShadow:"0 0 4px rgba(0,0,0,0.5)",transform:"translate(-50%, -50%)"}})]}),(0,A.jsx)("div",{style:{fontSize:"13px"},children:a}),(0,A.jsxs)("div",{style:{fontSize:"11px",opacity:.7,fontFamily:"monospace"},children:[String(c.r).padStart(3,"0")," / ",String(c.g).padStart(3,"0")," / ",String(c.b).padStart(3,"0")]})]})}function I(e){let{speedIdx:t,setSpeedIdx:n,volume:o,setVolume:s,audioSource:i,setAudioSource:c,lavaLowColor:l,setLavaLowColor:u,lavaHighColor:d,setLavaHighColor:h,rainbowMode:m,setRainbowMode:p,spectrumMode:f,setSpectrumMode:v,isFullscreen:w,toggleFullscreen:y,isMobile:b}=e;const[S,E]=(0,r.useState)(!1),M=(0,r.useCallback)((()=>E((e=>!e))),[]),R=(0,r.useRef)(null);(0,r.useEffect)((()=>{if(!S)return;const e=e=>{R.current&&!R.current.contains(e.target)&&E(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[S]);const C=g.STEPS-1,[k,j]=(0,r.useState)(null),N=(0,r.useRef)(0),I=(0,r.useCallback)(((e,t,n)=>{const r=n.getBoundingClientRect(),a=r.left+r.width/2,o=r.top+r.height/2,s=e.clientX-a,i=e.clientY-o,c=(Math.atan2(i,s)/(2*Math.PI)%1+1)%1,{r:l,g:d,b:m}=_(c,1,.5),f="#".concat(l.toString(16).padStart(2,"0")).concat(d.toString(16).padStart(2,"0")).concat(m.toString(16).padStart(2,"0"));"hot"===t?h(f):u(f),p(!1)}),[h,u,p]);(0,r.useEffect)((()=>{if(!k)return;document.body.style.cursor="var(--grabbing)";const e=e=>{const t=document.querySelector('[data-wheel="'.concat(k,'"]'));t&&I(e,k,t)},t=()=>{j(null)};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t),document.body.style.cursor=""}}),[k,I]);const P=(0,r.useMemo)((()=>{const e=[];if(!f)return"linear-gradient(to right, ".concat(d,", ").concat(l,")");const t=L(l);let n=L(d).h,r=t.h;if(0===N.current){const e=r-n,t=e>0?e-1:e+1;N.current=Math.abs(e)<Math.abs(t)?1:-1}-1===N.current&&(r>n?n+=1:r+=1);for(let a=0;a<=10;a++){const t=a/10;let o=n+(r-n)*t;for(;o>1;)o-=1;for(;o<0;)o+=1;const s=1,i=.5,{r:c,g:l,b:u}=_(o,s,i),d="#".concat(c.toString(16).padStart(2,"0")).concat(l.toString(16).padStart(2,"0")).concat(u.toString(16).padStart(2,"0"));e.push("".concat(d," ").concat(100*t,"%"))}return"linear-gradient(to right, ".concat(e.join(", "),")")}),[l,d,f]);return(0,A.jsxs)("div",{className:"lava-lamp-controls",ref:R,children:[(0,A.jsx)("button",{type:"button",className:"lava-lamp-menu-toggle",onClick:M,"aria-label":S?"Hide menu":"Show menu","aria-pressed":S,children:S?"\u2715":"\u2630"}),S&&(0,A.jsxs)("div",{className:"lava-lamp-menu",style:{maxHeight:"65vh",overflowY:"auto"},children:[(0,A.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,A.jsx)("div",{className:"lava-lamp-control-header",children:(0,A.jsxs)("div",{className:"lava-lamp-control-title",children:["speed: ",t]})}),(0,A.jsx)("div",{className:"lava-lamp-slider-wrap",children:(0,A.jsx)("input",{className:"lava-lamp-slider",type:"range",min:0,max:C,step:1,value:t,onChange:e=>{return n((t=+e.target.value,a=C,t<(r=0)?r:t>a?a:t));var t,r,a},"aria-label":"Simulation speed"})})]}),!b&&(0,A.jsx)("div",{className:"lava-lamp-control-block",children:(0,A.jsx)("div",{className:"lava-lamp-slider-wrap",children:(0,A.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"var(--pointer)"},children:[(0,A.jsx)("input",{type:"checkbox",className:"lava-lamp-checkbox",checked:w,onChange:y}),(0,A.jsx)("span",{style:{fontSize:13,opacity:.9},children:"fullscreen mode"})]})})}),(0,A.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,A.jsx)("div",{className:"lava-lamp-slider-wrap",style:{marginBottom:12},children:(0,A.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"var(--pointer)"},children:[(0,A.jsx)("input",{type:"checkbox",className:"lava-lamp-checkbox",checked:m,onChange:e=>p(e.target.checked)}),(0,A.jsx)("span",{style:{fontSize:13,opacity:.9},children:"rainbow drift mode"})]})}),(0,A.jsx)("div",{className:"lava-lamp-slider-wrap",style:{marginBottom:12},children:(0,A.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"var(--pointer)"},children:[(0,A.jsx)("input",{type:"checkbox",className:"lava-lamp-checkbox",checked:f,onChange:e=>v(e.target.checked)}),(0,A.jsx)("span",{style:{fontSize:13,opacity:.9},children:"spectrum mode"})]})}),(0,A.jsxs)("div",{style:{display:"flex",justifyContent:"space-around",gap:"16px",marginBottom:"8px"},children:[(0,A.jsx)(T,{wheelType:"hot",color:d,onColorChange:e=>{h(e),p(!1)},label:"hot",rainbowMode:m,onMouseDown:()=>j("hot"),draggingWheel:k}),(0,A.jsx)(T,{wheelType:"cool",color:l,onColorChange:e=>{u(e),p(!1)},label:"cool",rainbowMode:m,onMouseDown:()=>j("cool"),draggingWheel:k})]}),(0,A.jsx)("div",{style:{marginTop:"8px"},children:(0,A.jsx)("div",{style:{width:"100%",height:"24px",background:P,borderRadius:"4px"},title:"Color gradient preview"})})]}),(0,A.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,A.jsx)("div",{className:"lava-lamp-control-header",children:(0,A.jsx)("div",{className:"lava-lamp-control-title",children:"audio source"})}),(0,A.jsx)("div",{className:"lava-lamp-slider-wrap",children:(0,A.jsx)("select",{className:"lava-lamp-slider",value:i,onChange:e=>c(e.target.value),"aria-label":"Audio source",children:Object.entries(x).map((e=>{let[t,n]=e;return(0,A.jsx)("option",{value:t,children:n.label},t)}))})}),(0,A.jsx)("div",{className:"lava-lamp-control-header",style:{marginTop:12},children:(0,A.jsxs)("div",{className:"lava-lamp-control-title",children:["volume: ",Math.round(100*o),"%"]})}),(0,A.jsx)("div",{className:"lava-lamp-slider-wrap",children:(0,A.jsx)("input",{className:"lava-lamp-slider",type:"range",min:0,max:1,step:.01,value:o,onChange:e=>s(+e.target.value),"aria-label":"Music volume"})})]}),(0,A.jsx)("div",{className:"lava-lamp-control-block",children:(0,A.jsxs)("button",{type:"button",className:"lava-lamp-power-off",onClick:()=>window.location.reload(),"aria-label":"Power off",children:[(0,A.jsx)("img",{src:a,alt:"Power off",className:"lava-lamp-power-off-icon"}),(0,A.jsx)("span",{children:"power off"})]})})]})]})}var P=n(7375);class O{constructor(){this.audioContext=null,this.analyser=null,this.dataArray=null,this.connected=!1}connect(e){if(this.connected)return!0;try{const t=window.AudioContext||window.webkitAudioContext;if(!t)return console.warn("[AudioAmplitude] AudioContext not supported"),!1;this.audioContext=new t,this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=256,this.analyser.smoothingTimeConstant=.95;return this.audioContext.createMediaElementSource(e).connect(this.analyser).connect(this.audioContext.destination),this.dataArray=new Uint8Array(this.analyser.frequencyBinCount),this.connected=!0,"suspended"===this.audioContext.state&&this.audioContext.resume(),!0}catch(t){return console.warn("[AudioAmplitude] Failed to connect analyser:",t),!1}}getAmplitude(){if(!this.analyser||!this.dataArray)return 0;try{this.analyser.getByteTimeDomainData(this.dataArray);let e=0;for(let n=0;n<this.dataArray.length;n++){const t=(this.dataArray[n]-128)/128;e+=t*t}const t=Math.sqrt(e/this.dataArray.length);return Math.min(1,3*t)}catch(e){return console.warn("[AudioAmplitude] Error reading amplitude:",e),0}}getWaveformBars(e){if(!this.analyser||!this.dataArray)return new Array(e).fill(0);try{this.analyser.getByteTimeDomainData(this.dataArray);const t=[],n=Math.floor(this.dataArray.length/e);for(let r=0;r<e;r++){const e=r*n,a=Math.abs((this.dataArray[e]-128)/128);t.push(Math.min(1,1.2*a))}return t}catch(t){return console.warn("[AudioAmplitude] Error reading waveform:",t),new Array(e).fill(0)}}resume(){this.audioContext&&"suspended"===this.audioContext.state&&this.audioContext.resume().catch((e=>{console.warn("[AudioAmplitude] Failed to resume audio context:",e)}))}disconnect(){this.audioContext&&(this.audioContext.close().catch((()=>{})),this.audioContext=null),this.analyser=null,this.dataArray=null,this.connected=!1}isConnected(){return this.connected}}function H(e){const[t,n]=(0,r.useState)(i.kexp),[a,o]=(0,r.useState)(1),s=(0,r.useMemo)((()=>{const e=new P.D(x[i.kexp].url,!0);return e.preload="auto",e}),[]),c=(0,r.useMemo)((()=>new P.D(S,!1)),[]),l=(0,r.useRef)(null),u=(0,r.useRef)(Array(10).fill(0)),[d,h]=(0,r.useState)(Array(10).fill(0)),m=(0,r.useRef)(0);(0,r.useEffect)((()=>{s.volume=a}),[a,s]);const p=(0,r.useRef)(!0);(0,r.useEffect)((()=>{if(p.current)return void(p.current=!1);const e=x[t],n=!s.paused;s.setSource(e.url,{autoplay:n}).catch((()=>{}))}),[t,s]);const f=(0,r.useCallback)((()=>{var e;!function(e){try{if(!Number.isFinite(e)||e<0)return;localStorage.setItem(b,String(e))}catch(t){}}(null!==(e=s.currentTime)&&void 0!==e?e:0)}),[s]);(0,r.useEffect)((()=>{if(!e)return;const t=window.setInterval(f,1e3),n=()=>f(),r=()=>{"hidden"===document.visibilityState&&f()};return window.addEventListener("pagehide",n),document.addEventListener("visibilitychange",r),()=>{clearInterval(t),window.removeEventListener("pagehide",n),document.removeEventListener("visibilitychange",r)}}),[e,f]),(0,r.useEffect)((()=>()=>{var e;f(),s.pause(),s.volume=0,s.reset(),c.pause(),c.volume=0,c.reset(),null===(e=l.current)||void 0===e||e.disconnect(),l.current=null}),[s,c,f]);const v=(0,r.useCallback)((()=>{try{c.volume=1,c.currentTime=0,c.reset(),c.play()}catch(e){}}),[c]),g=(0,r.useCallback)((()=>{const e=function(){try{const e=localStorage.getItem(b);if(!e)return 0;const t=Number(e);return Number.isFinite(t)&&t>=0?t:0}catch(e){return 0}}();try{const t=s.duration;s.currentTime="number"===typeof t&&Number.isFinite(t)&&t>0?e%t:e}catch(t){}}),[s]),w=(0,r.useCallback)((()=>{l.current&&(u.current=l.current.getWaveformBars(10),++m.current>=5&&(h(u.current),m.current=0))}),[]),y=(0,r.useCallback)((()=>{if(!l.current){const e=new O;if(e.connect(s))l.current=e;else{const t=()=>{!l.current&&e.connect(s)&&(l.current=e),s.removeEventListener("playing",t)};s.addEventListener("playing",t,{once:!0})}}}),[s]),A=(0,r.useCallback)((()=>{var e;null===(e=l.current)||void 0===e||e.resume()}),[]);return(0,r.useEffect)((()=>{if(!e)return;const t=()=>{var e;null===(e=l.current)||void 0===e||e.resume()};return s.addEventListener("play",t),()=>s.removeEventListener("play",t)}),[e,s]),{audioSource:t,setAudioSource:n,volume:a,setVolume:o,gameMusic:s,clickSound:c,displayWaveform:d,amplitudeAnalyzerRef:l,playClick:v,resumeMusicFromSavedTime:g,updateWaveform:w,initializeAmplitudeAnalyzer:y,resumeAmplitudeAnalyzer:A}}function D(e,t,n,r){const a=new Uint32Array(256);if(!r){const n=B(e),r=B(t);for(let e=0;e<256;++e){const t=e/255,o=Math.round(n.r+(r.r-n.r)*t),s=Math.round(n.g+(r.g-n.g)*t),i=Math.round(n.b+(r.b-n.b)*t);a[e]=(255<<24|i<<16|s<<8|o)>>>0}return a}const o=L(e),s=L(t);let i=o.h,c=s.h;if(0===n.current){const e=c-i,t=e>0?e-1:e+1;n.current=Math.abs(e)<Math.abs(t)?1:-1}-1===n.current&&(c>i?i+=1:c+=1);for(let l=0;l<256;++l){let e=i+(c-i)*(l/255);for(;e>1;)e-=1;for(;e<0;)e+=1;const t=1,n=.5,{r:r,g:o,b:s}=_(e,t,n);a[l]=(255<<24|s<<16|o<<8|r)>>>0}return a}function B(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}}const F=function(){const e=Math.random(),t=(e+(.25+.5*Math.random())*(Math.random()<.5?1:-1)+1)%1,n=_(e,1,.5),r=_(t,1,.5);return{low:"#".concat(n.r.toString(16).padStart(2,"0")).concat(n.g.toString(16).padStart(2,"0")).concat(n.b.toString(16).padStart(2,"0")),high:"#".concat(r.r.toString(16).padStart(2,"0")).concat(r.g.toString(16).padStart(2,"0")).concat(r.b.toString(16).padStart(2,"0"))}}(),U=Math.random()<.25;function z(e){return e<0?0:e>1?1:e}function W(e){const t=Math.random()*Math.PI*2,n=Math.random()*e;return{x:Math.cos(t)*n,y:Math.sin(t)*n}}function q(e,t,n){e.x<0?(e.x=0,e.vx*=-.5):e.x>t&&(e.x=t,e.vx*=-.5),e.y<0?(e.y=0,e.vy*=-.5):e.y>n&&(e.y=n,e.vy*=-.5)}function Y(e,t,n){for(let r=0;r<e.length;r++)q(e[r],t,n)}function X(e,t,n,r){const a=[],o=Math.floor(n/p.COUNT),s=function(e){return p.RADIUS_BASE*e}(r);for(let i=0;i<p.COUNT;i++){const n=Math.random()*e,r=Math.random()<p.TOP_HALF_PROB?Math.random()*t*.5:.5*t+Math.random()*t*.5,i=Math.random();for(let e=0;e<o;e++){const e=W(s);a.push({x:n+e.x,y:r+e.y,vx:0,vy:0,heat:i})}}for(;a.length<n;)a.push({x:Math.random()*e,y:Math.random()*t,vx:0,vy:0,heat:0});return a}function V(e,t,n){const r=e.heat*e.heat*n;e.vy+=(u.GRAVITY-r)*t}function G(e,t){const n=Math.pow(u.FRICTION,t);e.vx*=n,e.vy*=n}function K(e,t){e.x+=e.vx*t,e.y+=e.vy*t}function $(e,t,n,r,a){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const s=e.x-t.x,i=e.y-t.y,c=s*s+i*i,l=function(e){return u.MOUSE_HEAT_RADIUS_BASE*e}(r);if(c<l*l){const t=10*a*(1-Math.sqrt(c)*(1/l))*n;e.heat+=o?-t:t}}function J(e,t,n,r,a,o,s){const i=u.COHESION_STRENGTH*(1-a*(1/s)),c=1/a,l=n*c*i*o,d=r*c*i*o;e.vx+=l,e.vy+=d,t.vx-=l,t.vy-=d}function Q(e,t,n){const r=(e.heat-t.heat)*u.HEAT_CONDUCTION*n;e.heat-=r,t.heat+=r}function Z(e,t,n,r,a,o){const s=t-e.y,i=function(e){return u.HEAT_SOURCE_DISTANCE_BASE*e}(a);if(s<i){const t=1-s*(1/i);return void(e.heat+=o*t*r)}const c=1-(n<8?n:8)/8,l=function(e){return u.COOL_RATE_BASE*e}(a);e.heat-=l*(.2+.8*c)*r}function ee(e,t,n,r,a,o,s,i){let c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const l=Math.max(0,Math.min(4,s)),h=m(t,n),p=d(h),f=function(e){return u.BUOYANCY_BASE*e}(h),v=function(e){return u.HEAT_RATE_BASE*e}(h);for(let u=0;u<e.length;u++){const s=e[u];V(s,l,f),G(s,l),K(s,l),r&&$(s,a,l,h,v,c),o[u]=0,q(s,t,n)}if(0===l){for(let t=0;t<e.length;t++)e[t].heat=z(e[t].heat);return void Y(e,t,n)}i.heads.fill(-1);const g=1/i.cellSize;for(let u=0;u<e.length;u++){const t=e[u];let n=t.x*g|0,r=t.y*g|0;n<0?n=0:n>=i.cols&&(n=i.cols-1),r<0?r=0:r>=i.rows&&(r=i.rows-1);const a=R(i,n,r);i.next[u]=i.heads[a],i.heads[a]=u}const w=p*p;for(let u=0;u<e.length;u++){const t=e[u];let n=t.x*g|0,r=t.y*g|0;n<0?n=0:n>=i.cols&&(n=i.cols-1),r<0?r=0:r>=i.rows&&(r=i.rows-1);const a=n>0?n-1:n,s=n+1<i.cols?n+1:n,c=r>0?r-1:r,d=r+1<i.rows?r+1:r;for(let h=c;h<=d;h++)for(let n=a;n<=s;n++){let r=i.heads[R(i,n,h)];for(;-1!==r;){if(r>u){const n=e[r],a=n.x-t.x,s=n.y-t.y,i=a*a+s*s;if(i>0&&i<w){o[u]++,o[r]++;J(t,n,a,s,Math.sqrt(i),l,p),Q(t,n,l)}}r=i.next[r]}}}for(let u=0;u<e.length;u++){const t=e[u];Z(t,n,o[u],l,h,v),t.heat=z(t.heat)}Y(e,t,n)}const te=(255<<24|0<<16|0<<8|0)>>>0;function ne(e,t,n,r,a,o,s){const i=Math.min(n+r,o),c=Math.min(t+r,a);for(let l=n;l<i;l++){let n=l*a+t;for(let r=t;r<c;r++)e[n++]=s}}function re(e,t,n,r,a,o){const s=h.THRESHOLD,i=function(e){return h.PARTICLE_RADIUS_BASE*e}(m(n,r)),c=i*i,l=new Uint32Array(e.data.buffer);l.fill(te);const u=n,d=r;for(let h=0;h<d;h+=o)for(let e=0;e<u;e+=o){let n=0,r=0;for(let a=0;a<t.length;++a){const o=t[a],s=e-o.x,i=h-o.y,l=c/(s*s+i*i+1);n+=l,r+=l*o.heat}if(n<=s)continue;const i=r/n;ne(l,e,h,o,u,d,a[i<=0?0:i>=1?255:255*i|0])}}function ae(e,t,n,r,a){const o=function(e,t,n,r){const a=t.current;return a&&a.width===n&&a.height===r||(t.current=e.createImageData(n,r)),t.current}(e,r,t.width,t.height),s=function(e,t){const n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:8)*m(e,t);return Math.max(4,Math.min(24,Math.round(n)))}(t.width,t.height);re(o,n,t.width,t.height,a,s),e.putImageData(o,0,0)}function oe(e){let{canvasRef:t,ctxRef:n,pointerDownRef:a,pointerCoolingRef:o,pointerPosRef:s,speedRef:i,heatLutRef:c,updateWaveform:l}=e;const u=(0,r.useRef)([]),h=(0,r.useRef)(null),p=(0,r.useRef)(new Uint16Array(0)),g=(0,r.useRef)(null),b=(0,r.useRef)(null),x=(0,r.useRef)({w:1,h:1}),S=(0,r.useRef)(null),A=(0,r.useRef)({last:0,acc:0});(0,r.useEffect)((()=>{const e=t.current;if(!e)return;const r=window.innerWidth,a=window.innerHeight;x.current={w:r,h:a},e.width=r,e.height=a,n.current=e.getContext("2d"),h.current=null}),[t,n]);const E=(0,r.useCallback)((()=>{const{w:e,h:t}=x.current;null===g.current&&(g.current=function(e,t){const n=e*t,r=m(e,t),a=Math.round(n*f/(r*r));return Math.min(a,v)}(e,t));const n=g.current,r=m(e,t);u.current=X(e,t,n,r),p.current=new Uint16Array(n);const a=d(r);!function(e,t,n,r,a){const o=Math.max(1,Math.ceil(t/a)),s=Math.max(1,Math.ceil(n/a)),i=o*s,c=e.current;c&&c.cols===o&&c.rows===s&&c.cellSize===a&&c.next.length===r&&c.heads.length===i||(e.current={cellSize:a,cols:o,rows:s,heads:new Int32Array(i),next:new Int32Array(r)})}(b,e,t,n,a)}),[]),M=(0,r.useCallback)((()=>{const e=b.current,{w:t,h:n}=x.current;e&&ee(u.current,t,n,a.current,s.current,p.current,i.current,e,o.current)}),[a,s,i,o]),R=(0,r.useCallback)((()=>{const e=t.current,r=n.current;e&&r&&ae(r,e,u.current,h,c.current)}),[t,n,c]),C=(0,r.useCallback)((e=>{const t=A.current;t.last||(t.last=e);let n=e-t.last;t.last=e,t.acc+=Math.min(250,Math.max(0,n));let r=0;for(;t.acc>=w&&r<y;)M(),t.acc-=w,r++;t.acc>=w&&(t.acc=0),l(),R(),S.current=requestAnimationFrame(C)}),[R,M,l]),k=(0,r.useCallback)((()=>{E(),A.current={last:0,acc:0},requestAnimationFrame((()=>R())),S.current=requestAnimationFrame(C)}),[E,R,C]);return(0,r.useEffect)((()=>()=>{null!==S.current&&cancelAnimationFrame(S.current)}),[]),{particlesRef:u,sizeRef:x,imageRef:h,startSimulation:k}}function se(){const e=c(),t=(0,r.useRef)(null),n=(0,r.useRef)(null),[o,s]=(0,r.useState)(!1),[l,u]=(0,r.useState)(5),d=(0,r.useRef)(M(5));(0,r.useEffect)((()=>{d.current=M(l)}),[l]);const{audioSource:h,setAudioSource:m,volume:p,setVolume:f,gameMusic:v,displayWaveform:g,playClick:w,resumeMusicFromSavedTime:y,updateWaveform:b,initializeAmplitudeAnalyzer:S,resumeAmplitudeAnalyzer:R}=H(o),{lavaLowColor:C,setLavaLowColor:k,lavaHighColor:_,setLavaHighColor:L,rainbowMode:T,setRainbowMode:P,spectrumMode:O,setSpectrumMode:B,heatLutRef:z}=function(e){const[t,n]=(0,r.useState)(F.low),[a,o]=(0,r.useState)(F.high),[s,i]=(0,r.useState)(!1),[c,l]=(0,r.useState)(U),u=(0,r.useRef)(0),d=(0,r.useRef)(D(F.low,F.high,u,U)),h=(0,r.useRef)(F.low),m=(0,r.useRef)(F.high);(0,r.useEffect)((()=>{h.current=t,m.current=a,d.current=D(t,a,u,c)}),[t,a,c]);const p=(0,r.useRef)(0),f=(0,r.useRef)(0),v=(0,r.useRef)(1),g=(0,r.useRef)(1.3),w=(0,r.useRef)(!1);return(0,r.useEffect)((()=>{if(s&&!w.current){p.current=N(t),f.current=N(a);const e=.5+1.5*Math.random(),n=.5+1.5*Math.random(),r=Math.random()<.5?1:-1,o=Math.random()<.5?1:-1;v.current=e*r,g.current=n*o}w.current=s}),[s,t,a]),(0,r.useEffect)((()=>{if(!s)return;let t,r=performance.now();const a=s=>{const i=s-r;r=s;const c=e.current,l=i/16.67;p.current=(p.current+.02*c*l*v.current)%360,f.current=(f.current+.02*c*l*g.current)%360;const u=p.current,d=f.current-u,h=d>0?d-360:d+360,m=Math.abs(d)<Math.abs(h)?d:h;if(Math.abs(m)<45){const e=v.current,t=g.current,n=m>0,r=m>0;if(n&&e>0){const e=.5+1.5*Math.random();v.current=-e}else if(!n&&e<0){const e=.5+1.5*Math.random();v.current=e}if(r&&t<0){const e=.5+1.5*Math.random();g.current=e}else if(!r&&t>0){const e=.5+1.5*Math.random();g.current=-e}}n(j(p.current,1,.5)),o(j(f.current,1,.5)),t=requestAnimationFrame(a)};return t=requestAnimationFrame(a),()=>cancelAnimationFrame(t)}),[s,e]),{lavaLowColor:t,setLavaLowColor:n,lavaHighColor:a,setLavaHighColor:o,rainbowMode:s,setRainbowMode:i,spectrumMode:c,setSpectrumMode:l,heatLutRef:d}}(d),{pointerDownRef:W,pointerCoolingRef:q,pointerPosRef:X}=function(e){const t=(0,r.useRef)(!1),n=(0,r.useRef)(!1),a=(0,r.useRef)({x:0,y:0});return(0,r.useEffect)((()=>{const r=e.current;if(!r)return;const o=e=>{const t=r.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}},s=e=>{t.current=!0,n.current=2===e.button||0===e.button&&e.ctrlKey,a.current=o(e)},i=e=>a.current=o(e),c=()=>{t.current=!1,n.current=!1};return r.addEventListener("pointerdown",s),r.addEventListener("contextmenu",(e=>e.preventDefault())),window.addEventListener("pointermove",i),window.addEventListener("pointerup",c),window.addEventListener("pointercancel",c),()=>{r.removeEventListener("pointerdown",s),window.removeEventListener("pointermove",i),window.removeEventListener("pointerup",c),window.removeEventListener("pointercancel",c)}}),[e]),{pointerDownRef:t,pointerCoolingRef:n,pointerPosRef:a}}(t),{particlesRef:V,sizeRef:G,imageRef:K,startSimulation:$}=oe({canvasRef:t,ctxRef:n,pointerDownRef:W,pointerCoolingRef:q,pointerPosRef:X,speedRef:d,heatLutRef:z,updateWaveform:b}),{isFullscreen:J,toggleFullscreen:Q}=function(e){let{canvasRef:t,particlesRef:n,sizeRef:a,imageRef:o}=e;const[s,i]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{const e=()=>{i(!!document.fullscreenElement),document.body.classList.toggle("lava-lamp-fullscreen",!!document.fullscreenElement);const e=t.current;if(e){const t=window.innerWidth,r=window.innerHeight;e.width=t,e.height=r,a.current={w:t,h:r},o.current=null,n.current&&Y(n.current,t,r)}};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e),document.body.classList.remove("lava-lamp-fullscreen")}}),[t,n,a,o]),{isFullscreen:s,toggleFullscreen:(0,r.useCallback)((()=>{var e,t,n,r;document.fullscreenElement?null===(e=(t=document).exitFullscreen)||void 0===e||e.call(t):null===(n=(r=document.documentElement).requestFullscreen)||void 0===n||n.call(r).catch((()=>{}))}),[])}}({canvasRef:t,particlesRef:V,sizeRef:G,imageRef:K}),{nowPlaying:Z,nowPlayingExpanded:ee,setNowPlayingExpanded:te}=function(e,t){const[n,a]=(0,r.useState)(null),[o,s]=(0,r.useState)(!0);return(0,r.useEffect)((()=>{if(!e)return void a(null);if(t===i.forest)return void a({song:"redwood resonance",artist:"dianna lopez",album:"",isAirbreak:!1,station:t});let n;const r=async()=>{const e=x[t].info;try{var n;const r=await fetch(e),o=await r.json();console.log(o);const s=null===(n=o.results)||void 0===n?void 0:n[0];if(!s)return;"airbreak"===s.play_type?a({song:"airbreak",artist:"",album:"",isAirbreak:!0,station:t}):"trackplay"===s.play_type&&a({song:(s.song||"unknown track").toLowerCase(),artist:(s.artist||"unknown artist").toLowerCase(),album:(s.album||"").toLowerCase(),isAirbreak:!1,station:t})}catch(r){console.error("failed to fetch track info",r)}};return r(),n=window.setInterval(r,5e3),()=>clearInterval(n)}),[e,t]),{nowPlaying:n,nowPlayingExpanded:o,setNowPlayingExpanded:s}}(o,h);(0,r.useEffect)((()=>{Z&&!Z.isAirbreak?document.title="".concat(Z.song," - ").concat(Z.artist):document.title="connor.lava-lamp-radio"}),[Z]);const ne=(0,r.useCallback)((async()=>{if(w(),o||(s(!0),$(),S()),R(),h===i.forest&&y(),v.volume=1,v.readyState<3){v.load();const e=async()=>{try{await v.play()}catch(t){}v.removeEventListener("canplaythrough",e)};v.addEventListener("canplaythrough",e,{once:!0})}else try{await v.play()}catch(e){}}),[w,o,$,S,R,h,y,v]),re=(0,r.useMemo)((()=>({w:window.innerWidth,h:window.innerHeight})),[]);return(0,A.jsxs)("div",{className:"lava-lamp-container",children:[(0,A.jsx)("canvas",{ref:t,className:"lava-lamp-canvas",width:re.w,height:re.h}),(0,A.jsx)(E,{nowPlaying:Z,displayWaveform:g,expanded:ee,onToggle:()=>te((e=>!e))}),o?(0,A.jsx)(I,{speedIdx:l,setSpeedIdx:u,volume:p,setVolume:f,audioSource:h,setAudioSource:m,lavaLowColor:C,setLavaLowColor:k,lavaHighColor:_,setLavaHighColor:L,rainbowMode:T,setRainbowMode:P,spectrumMode:O,setSpectrumMode:B,isFullscreen:J,toggleFullscreen:Q,isMobile:e}):(0,A.jsx)("div",{className:"lava-lamp-start-overlay",children:(0,A.jsx)("button",{type:"button",className:"lava-lamp-start",onClick:ne,"aria-label":"Start lava lamp radio",children:(0,A.jsx)("img",{src:a,alt:"Power",className:"lava-lamp-start-icon"})})})]})}},7375:(e,t,n)=>{n.d(t,{D:()=>a});var r=n(9788);class a extends Audio{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.isPlayingSrc=e=>{var t;return(null!==(t=this.logicalSrc)&&void 0!==t?t:"").includes(e)&&this.isPlaying()},this.isPlaying=()=>this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2,this.timeLeft=()=>this.duration-this.currentTime,this.reset=()=>{this.pause();try{this.currentTime=0}catch(e){}},this.destroy=()=>{this.reset(),this._detachHls(),this.removeAttribute("src"),this.load()},this.crossOrigin="anonymous",this.loop=t,this._hls=null,this._logicalSrc=null,this._setSourceSeq=0,e&&this.setSource(e,{autoplay:!1,loop:t})}get logicalSrc(){var e;return null!==(e=this._logicalSrc)&&void 0!==e?e:this.src}async setSource(e){let{autoplay:t=!1,loop:n=this.loop}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=++this._setSourceSeq;this.loop=n,this.crossOrigin="anonymous";const o=t||!this.paused;this.pause(),this._detachHls(),this._logicalSrc=e;const s=/\.m3u8(\?.*)?$/i.test(e),i=s&&""!==this.canPlayType("application/vnd.apple.mpegurl");if(!s||i)return this.src=e,this.load(),void(o&&(await this._safePlayWhenReady(),this._setSourceSeq));if(!r.Ay.isSupported())throw new Error("HLS not supported in this browser (no MSE).");const c=new r.Ay;this._hls=c,c.attachMedia(this),c.loadSource(e),c.on(r.Ay.Events.ERROR,((e,t)=>{console.error("hls.js error",t),t.fatal&&(t.type===r.Ay.ErrorTypes.NETWORK_ERROR&&c.startLoad(),t.type===r.Ay.ErrorTypes.MEDIA_ERROR&&c.recoverMediaError())})),o&&(await new Promise(((e,t)=>{const n=()=>{c.off(r.Ay.Events.MANIFEST_PARSED,n),e()},a=(e,n)=>{n.fatal&&(c.off(r.Ay.Events.ERROR,a),t(new Error("Fatal HLS error: ".concat(n.type," / ").concat(n.details))))};c.on(r.Ay.Events.MANIFEST_PARSED,n),c.on(r.Ay.Events.ERROR,a)})),a===this._setSourceSeq&&await this._safePlay())}_detachHls(){if(this._hls)try{this._hls.destroy()}finally{this._hls=null}}async _safePlayWhenReady(){await this._safePlay(),this.paused&&(await new Promise((e=>{this.addEventListener("canplay",(()=>e()),{once:!0}),this.addEventListener("error",(()=>e()),{once:!0})})),await this._safePlay())}async _safePlay(){try{await this.play()}catch(e){console.log("play() failed:",e)}}}}}]);
//# sourceMappingURL=124.dce255c3.chunk.js.map