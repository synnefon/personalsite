"use strict";(self.webpackChunkpersonalsite=self.webpackChunkpersonalsite||[]).push([[200],{202:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b,stepSimulationOnePairPass:()=>S});var r=n(5043);const a=n.p+"static/media/guitar.7c3177d2baeb887643cc.mp3",i=n.p+"static/media/click.1c87678ffc4ae6835e44.mp3";var s=n(7375),o=n(579);const c={GRAVITY:.01,BUOYANCY:.04,FRICTION:.98,HEAT_RATE:.005,COOL_RATE:.0017,HEAT_CONDUCTION:.002,HEAT_SOURCE_DISTANCE:45,COHESION_RADIUS:25,COHESION_STRENGTH:.0035,MOUSE_HEAT_RADIUS:100},l={PARTICLE_RADIUS:10,PIXEL_SIZE:6,THRESHOLD:.8},u={COUNT:15,RADIUS:50,TOP_HALF_PROB:.3},h={WIDTH:1920,HEIGHT:1080,PARTICLES:1200},d={MIN:0,MAX:5,DEFAULT:1,STEPS:10};const m="lavaLamp.musicTimeSeconds";function v(e){if(e<=0)return 0;const t=d.STEPS;if(t<=1)return d.DEFAULT;const n=(e-1)/(t-2),r=Math.log(.25),a=Math.log(d.MAX);return Math.exp(function(e,t,n){return e+(t-e)*n}(r,a,n))}function f(e){return e<0?0:e>1?1:e}function E(e,t){return Math.hypot(e,t)}function p(e){const t=Math.random()*Math.PI*2,n=Math.random()*e;return{x:Math.cos(t)*n,y:Math.sin(t)*n}}function T(e,t,n){e.x<0?(e.x=0,e.vx*=-.5):e.x>t&&(e.x=t,e.vx*=-.5),e.y<0?(e.y=0,e.vy*=-.5):e.y>n&&(e.y=n,e.vy*=-.5)}function S(e,t,n,r,a,i,s){const o=Math.max(0,Math.min(4,s));for(let c=0;c<e.length;c++){const s=e[c];w(s,o),A(s,o),g(s,o),r&&y(s,a,o),i[c]=0,T(s,t,n)}if(o>0){for(let t=0;t<e.length;t++){const n=e[t];for(let r=t+1;r<e.length;r++){const a=e[r],s=a.x-n.x,l=a.y-n.y,u=E(s,l);u>0&&u<c.COHESION_RADIUS&&(i[t]++,i[r]++,x(n,a,s,l,u,o),I(n,a,o))}}for(let t=0;t<e.length;t++){const r=e[t];R(r,n,i[t],o),r.heat=f(r.heat)}}else for(let c=0;c<e.length;c++)e[c].heat=f(e[c].heat);!function(e,t,n){for(let r=0;r<e.length;r++)T(e[r],t,n)}(e,t,n)}function w(e,t){if(0===t)return;const n=e.heat*e.heat*c.BUOYANCY;e.vy+=(c.GRAVITY-n)*t}function A(e,t){if(0===t)return;const n=Math.pow(c.FRICTION,t);e.vx*=n,e.vy*=n}function g(e,t){0!==t&&(e.x+=e.vx*t,e.y+=e.vy*t)}function y(e,t,n){const r=E(e.x-t.x,e.y-t.y);if(r<c.MOUSE_HEAT_RADIUS){const t=1-r*(1/c.MOUSE_HEAT_RADIUS);e.heat+=2*c.HEAT_RATE*t*(0===n?1:n)}}function x(e,t,n,r,a,i){const s=c.COHESION_STRENGTH*(1-a*(1/c.COHESION_RADIUS)),o=1/a,l=n*o*s*i,u=r*o*s*i;e.vx+=l,e.vy+=u,t.vx-=l,t.vy-=u}function I(e,t,n){const r=(e.heat-t.heat)*c.HEAT_CONDUCTION*n;e.heat-=r,t.heat+=r}function R(e,t,n,r){const a=t-e.y;if(a<c.HEAT_SOURCE_DISTANCE){const t=1-a*(1/c.HEAT_SOURCE_DISTANCE);return void(e.heat+=c.HEAT_RATE*t*r)}const i=1-(n<8?n:8)/8;e.heat-=c.COOL_RATE*(.2+.8*i)*r}function C(e){const t=f(e);return{r:255,g:Math.round(50+205*t),b:0}}function N(e,t,n,r,a,i,s,o,c){for(let l=0;l<i;l++){const u=a+l;if(u>=n)continue;const h=u*t*4;for(let n=0;n<i;n++){const a=r+n;if(a>=t)continue;const i=h+4*a;e[i+0]=s,e[i+1]=o,e[i+2]=c,e[i+3]=255}}}function M(e,t,n,r){const a=t-e.x,i=n-e.y;return r/(a*a+i*i+1)}function O(e,t,n){const r=e.getContext("2d");if(!r)return;r.fillStyle="#000",r.fillRect(0,0,e.width,e.height);const a=function(e,t,n,r){const a=t.current;return a&&a.width===n&&a.height===r||(t.current=e.createImageData(n,r)),t.current}(r,n,e.width,e.height);!function(e,t,n,r){const a=e.data;a.fill(0);const i=l.PIXEL_SIZE,s=l.THRESHOLD,o=l.PARTICLE_RADIUS*l.PARTICLE_RADIUS;for(let c=0;c<r;c+=i)for(let e=0;e<n;e+=i){let l=0,u=0;for(let n=0;n<t.length;n++){const r=t[n],a=M(r,e,c,o);l+=a,u+=a*r.heat}if(l<=s)continue;const h=u/l,{r:d,g:m,b:v}=C(h);N(a,n,r,e,c,i,d,m,v)}}(a,t,e.width,e.height),r.putImageData(a,0,0)}function b(){const e=(0,r.useRef)(null),t=(0,r.useRef)(null),n=(0,r.useRef)([]),c=(0,r.useRef)(null),l=(0,r.useRef)(new Uint16Array(0)),f=(0,r.useRef)(null),E=(0,r.useMemo)((()=>new s.D(a,!0)),[]),T=(0,r.useMemo)((()=>new s.D(i,!1)),[]),[w,A]=(0,r.useState)(!1),g=(0,r.useRef)(!1),y=(0,r.useRef)({x:0,y:0}),x=(0,r.useMemo)((()=>function(e){if(e<=0)return 0;const t=d.STEPS;let n=1,r=1/0;const a=Math.log(e);for(let i=1;i<t;i++){const e=v(i),t=Math.abs(Math.log(e)-a);t<r&&(r=t,n=i)}return n}(d.DEFAULT)),[]),[I,R]=(0,r.useState)(x),C=(0,r.useRef)(d.DEFAULT);(0,r.useEffect)((()=>{C.current=v(I)}),[I]);const[N,M]=(0,r.useState)(!1),b=(0,r.useCallback)((()=>{M((e=>!e))}),[]),[H,L]=(0,r.useState)(1);(0,r.useEffect)((()=>{E.volume=H}),[H,E]);const _=(0,r.useCallback)((()=>{const e=window.innerWidth,t=window.innerHeight;null===f.current&&(f.current=function(e,t){const n=h.WIDTH*h.HEIGHT,r=e*t,a=h.PARTICLES/n,i=Math.round(r*a);return Math.max(200,Math.min(2e3,i))}(e,t));const r=f.current;n.current=function(e,t,n){const r=[],a=Math.floor(n/u.COUNT);for(let i=0;i<u.COUNT;i++){const n=Math.random()*e,i=Math.random()<u.TOP_HALF_PROB?Math.random()*t*.5:.5*t+Math.random()*t*.5,s=Math.random();for(let e=0;e<a;e++){const e=p(u.RADIUS);r.push({x:n+e.x,y:i+e.y,vx:0,vy:0,heat:s})}}for(;r.length<n;)r.push({x:Math.random()*e,y:Math.random()*t,vx:0,vy:0,heat:0});return r}(e,t,r),l.current=new Uint16Array(r)}),[]),U=(0,r.useCallback)((()=>{var e;!function(e){try{if(!Number.isFinite(e)||e<0)return;localStorage.setItem(m,String(e))}catch(t){}}(null!==(e=E.currentTime)&&void 0!==e?e:0)}),[E]);(0,r.useEffect)((()=>{if(!w)return;const e=window.setInterval((()=>U()),1e3),t=()=>U(),n=()=>{"hidden"===document.visibilityState&&U()};return window.addEventListener("pagehide",t),document.addEventListener("visibilitychange",n),()=>{window.clearInterval(e),window.removeEventListener("pagehide",t),document.removeEventListener("visibilitychange",n)}}),[w,U]),(0,r.useEffect)((()=>()=>{U(),E.pause(),E.volume=0,E.reset(),T.pause(),T.volume=0,T.reset()}),[E,T,U]);const D=(0,r.useCallback)((()=>{S(n.current,window.innerWidth,window.innerHeight,g.current,y.current,l.current,C.current)}),[]),P=(0,r.useCallback)((()=>{const t=e.current;t&&O(t,n.current,c)}),[]),k=(0,r.useCallback)((()=>{D(),P(),t.current=requestAnimationFrame(k)}),[D,P]);(0,r.useEffect)((()=>{const t=()=>{const t=e.current;t&&(!function(e){e.width=window.innerWidth,e.height=window.innerHeight}(t),c.current=null,w&&P())};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)}),[P,w]),(0,r.useEffect)((()=>{const t=e.current;if(!t)return;const n=e=>{const n=t.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}},r=e=>{g.current=!0,y.current=n(e)},a=e=>{y.current=n(e)},i=()=>{g.current=!1};return t.addEventListener("pointerdown",r),window.addEventListener("pointermove",a),window.addEventListener("pointerup",i),window.addEventListener("pointercancel",i),()=>{t.removeEventListener("pointerdown",r),window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",i),window.removeEventListener("pointercancel",i)}}),[]);const j=(0,r.useCallback)((()=>{try{T.volume=1,T.currentTime=0,T.reset(),T.play()}catch(e){}}),[T]),F=(0,r.useCallback)((()=>{const e=function(){try{const e=localStorage.getItem(m);if(!e)return 0;const t=Number(e);return Number.isFinite(t)&&t>=0?t:0}catch(e){return 0}}();try{const t=E.duration;"number"===typeof t&&Number.isFinite(t)&&t>0?E.currentTime=e%t:E.currentTime=e}catch(t){}}),[E]),Y=(0,r.useCallback)((()=>{j(),w||(A(!0),_(),requestAnimationFrame((()=>P())),t.current=requestAnimationFrame(k)),F(),E.volume=1,E.play()}),[k,P,E,w,_,j,F]),G=(0,r.useMemo)((()=>({w:window.innerWidth,h:window.innerHeight})),[]),W=(0,r.useRef)(null);return(0,o.jsxs)("div",{className:"lava-lamp-container",children:[(0,o.jsx)("canvas",{ref:e,className:"lava-lamp-canvas",width:G.w,height:G.h}),w?(0,o.jsxs)("div",{className:"lava-lamp-controls",children:[(0,o.jsx)("button",{type:"button",className:"lava-lamp-menu-toggle",onClick:b,"aria-label":N?"Hide menu":"Show menu","aria-pressed":N,children:N?"\u2715":"\u2630"}),N&&(0,o.jsxs)("div",{className:"lava-lamp-menu",children:[(0,o.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,o.jsx)("div",{className:"lava-lamp-control-header",children:(0,o.jsxs)("div",{className:"lava-lamp-control-title",children:["speed: ",I]})}),(0,o.jsx)("div",{ref:W,className:"lava-lamp-slider-wrap",children:(0,o.jsx)("input",{className:"lava-lamp-slider",type:"range",min:0,max:d.STEPS,step:1,value:I,onChange:e=>{return R((t=Number(e.target.value),n=0,r=d.STEPS,t<n?n:t>r?r:t));var t,n,r},"aria-label":"Simulation speed"})})]}),(0,o.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,o.jsx)("div",{className:"lava-lamp-control-header",children:(0,o.jsxs)("div",{className:"lava-lamp-control-title",children:["volume: ",Math.round(10*H)]})}),(0,o.jsx)("div",{className:"lava-lamp-slider-wrap",children:(0,o.jsx)("input",{className:"lava-lamp-slider",type:"range",min:0,max:1,step:.1,value:H,onChange:e=>L(Number(e.target.value)),"aria-label":"Music volume"})})]})]})]}):(0,o.jsx)("div",{className:"lava-lamp-start-overlay",children:(0,o.jsx)("button",{type:"button",className:"lava-lamp-start",onClick:Y,"aria-label":"Start lava lamp",children:"START"})})]})}},7375:(e,t,n)=>{n.d(t,{D:()=>r});class r extends Audio{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e),this.isPlayingSrc=e=>{var t;return(null===(t=this.src)||void 0===t?void 0:t.includes(e))&&this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2},this.isPlaying=()=>this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2,this.timeLeft=()=>this.duration-this.currentTime,this.reset=()=>{this.pause(),this.currentTime=0},this.loop=t}}}}]);
//# sourceMappingURL=200.9ab25c9b.chunk.js.map