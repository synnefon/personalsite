"use strict";(self.webpackChunkpersonalsite=self.webpackChunkpersonalsite||[]).push([[200],{202:(e,t,a)=>{a.r(t),a.d(t,{default:()=>P,stepSimulationOnePairPass:()=>M});var n=a(5043);const r=a.p+"static/media/guitar.7c3177d2baeb887643cc.mp3",s=a.p+"static/media/click.1c87678ffc4ae6835e44.mp3";var l=a(7375),c=a(579);const o={REDWOOD:"redwood",KEXP:"kexp"},i={[o.REDWOOD]:{label:"redwood meditation",url:r},[o.KEXP]:{label:"KEXP",url:"https://kexp.streamguys1.com/kexp160.aac"}},u="#ffdd00",h="#ff5500",d={GRAVITY:.01,BUOYANCY:.04,FRICTION:.98,HEAT_RATE:.005,COOL_RATE:.0017,HEAT_CONDUCTION:.002,HEAT_SOURCE_DISTANCE:45,COHESION_RADIUS:25,COHESION_STRENGTH:.0035,MOUSE_HEAT_RADIUS:100},m={PARTICLE_RADIUS:10,PIXEL_SIZE:6,THRESHOLD:.8},v={COUNT:15,RADIUS:50,TOP_HALF_PROB:.3},f={WIDTH:1920,HEIGHT:1080,PARTICLES:1200},p={MIN:0,MAX:5,DEFAULT:.25,STEPS:10},x=1e3/60,E=4,w="lavaLamp.musicTimeSeconds";function g(e){return e<0?0:e>1?1:e}function y(e,t,a){const n=e+(t-e)*a;return n<0?0:n>255?255:Math.round(n)}function S(e){const t=Math.random()*Math.PI*2,a=Math.random()*e;return{x:Math.cos(t)*a,y:Math.sin(t)*a}}function N(e,t,a){e.x<0?(e.x=0,e.vx*=-.5):e.x>t&&(e.x=t,e.vx*=-.5),e.y<0?(e.y=0,e.vy*=-.5):e.y>a&&(e.y=a,e.vy*=-.5)}function T(e,t,a){for(let n=0;n<e.length;n++)N(e[n],t,a)}function A(e){if(e<=0)return 0;const t=p.STEPS;if(e>=t)return p.MAX;const a=e/t,n=.25/p.MAX,r=Math.log(n),s=Math.log(p.MAX);return Math.exp(function(e,t,a){return e+(t-e)*a}(r,s,a))}function I(e){const t=e.trim().replace("#","");if(3===t.length){return{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16)}}if(6===t.length){return{r:parseInt(t.slice(0,2),16),g:parseInt(t.slice(2,4),16),b:parseInt(t.slice(4,6),16)}}return{r:255,g:221,b:0}}function b(e,t,a,n){return n<<24|a<<16|t<<8|e}function R(e,t){const a=I(e),n=I(t),r=new Uint32Array(256);for(let s=0;s<256;s++){const e=s/255,t=y(a.r,n.r,e),l=y(a.g,n.g,e),c=y(a.b,n.b,e);r[s]=b(t,l,c,255)}return r}function C(e,t,a){return a*e.cols+t}function M(e,t,a,n,r,s,l,c){const o=Math.max(0,Math.min(4,l));for(let d=0;d<e.length;d++){const l=e[d];O(l,o),j(l,o),D(l,o),n&&H(l,r,o),s[d]=0,N(l,t,a)}if(0===o){for(let t=0;t<e.length;t++)e[t].heat=g(e[t].heat);return void T(e,t,a)}c.heads.fill(-1);const i=1/c.cellSize;for(let d=0;d<e.length;d++){const t=e[d];let a=t.x*i|0,n=t.y*i|0;a<0?a=0:a>=c.cols&&(a=c.cols-1),n<0?n=0:n>=c.rows&&(n=c.rows-1);const r=C(c,a,n);c.next[d]=c.heads[r],c.heads[r]=d}const u=d.COHESION_RADIUS,h=u*u;for(let d=0;d<e.length;d++){const t=e[d];let a=t.x*i|0,n=t.y*i|0;a<0?a=0:a>=c.cols&&(a=c.cols-1),n<0?n=0:n>=c.rows&&(n=c.rows-1);const r=a>0?a-1:a,l=a+1<c.cols?a+1:a,u=n>0?n-1:n,m=n+1<c.rows?n+1:n;for(let i=u;i<=m;i++)for(let a=r;a<=l;a++){let n=c.heads[C(c,a,i)];for(;-1!==n;){if(n>d){const a=e[n],r=a.x-t.x,l=a.y-t.y,c=r*r+l*l;if(c>0&&c<h){s[d]++,s[n]++;_(t,a,r,l,Math.sqrt(c),o),L(t,a,o)}}n=c.next[n]}}}for(let d=0;d<e.length;d++){const t=e[d];U(t,a,s[d],o),t.heat=g(t.heat)}T(e,t,a)}function O(e,t){const a=e.heat*e.heat*d.BUOYANCY;e.vy+=(d.GRAVITY-a)*t}function j(e,t){const a=Math.pow(d.FRICTION,t);e.vx*=a,e.vy*=a}function D(e,t){e.x+=e.vx*t,e.y+=e.vy*t}function H(e,t,a){const n=e.x-t.x,r=e.y-t.y,s=n*n+r*r,l=d.MOUSE_HEAT_RADIUS;if(s<l*l){const t=1-Math.sqrt(s)*(1/l);e.heat+=2*d.HEAT_RATE*t*a}}function _(e,t,a,n,r,s){const l=d.COHESION_STRENGTH*(1-r*(1/d.COHESION_RADIUS)),c=1/r,o=a*c*l*s,i=n*c*l*s;e.vx+=o,e.vy+=i,t.vx-=o,t.vy-=i}function L(e,t,a){const n=(e.heat-t.heat)*d.HEAT_CONDUCTION*a;e.heat-=n,t.heat+=n}function U(e,t,a,n){const r=t-e.y;if(r<d.HEAT_SOURCE_DISTANCE){const t=1-r*(1/d.HEAT_SOURCE_DISTANCE);return void(e.heat+=d.HEAT_RATE*t*n)}const s=1-(a<8?a:8)/8;e.heat-=d.COOL_RATE*(.2+.8*s)*n}function k(e,t,a,n,r){const s=function(e,t,a,n){const r=t.current;return r&&r.width===a&&r.height===n||(t.current=e.createImageData(a,n)),t.current}(e,n,t.width,t.height);!function(e,t,a,n,r){const s=m.PIXEL_SIZE,l=m.THRESHOLD,c=m.PARTICLE_RADIUS*m.PARTICLE_RADIUS,o=new Uint32Array(e.data.buffer),i=b(0,0,0,255);o.fill(i);const u=a;for(let h=0;h<n;h+=s)for(let e=0;e<a;e+=s){let a=0,i=0;for(let n=0;n<t.length;n++){const r=t[n],s=e-r.x,l=h-r.y,o=c/(s*s+l*l+1);a+=o,i+=o*r.heat}if(a<=l)continue;const d=i/a,m=r[d<=0?0:d>=1?255:255*d|0];for(let t=0;t<s;t++){const a=h+t;if(a>=n)break;let r=a*u+e;const l=Math.min(e+s,u);for(let t=e;t<l;t++)o[r++]=m}}}(s,a,t.width,t.height,r),e.putImageData(s,0,0)}function P(){const e=(0,n.useRef)(null),t=(0,n.useRef)(null),a=(0,n.useRef)(null),m=(0,n.useRef)([]),g=(0,n.useRef)(null),y=(0,n.useRef)(new Uint16Array(0)),N=(0,n.useRef)(null),T=(0,n.useRef)(null),I=(0,n.useRef)({w:1,h:1}),b=(0,n.useMemo)((()=>new l.D(r,!0)),[]),C=(0,n.useMemo)((()=>new l.D(s,!1)),[]),[O,j]=(0,n.useState)(!1),D=(0,n.useRef)(!1),H=(0,n.useRef)({x:0,y:0}),_=(0,n.useMemo)((()=>function(e){if(e<=0)return 0;const t=p.STEPS-1;let a=1,n=1/0;const r=Math.log(e);for(let s=1;s<=t;s++){const e=A(s),t=Math.abs(Math.log(e)-r);t<n&&(n=t,a=s)}return a}(p.DEFAULT)),[]),[L,U]=(0,n.useState)(_),P=(0,n.useRef)(p.DEFAULT);(0,n.useEffect)((()=>{P.current=A(L)}),[L]);const[F,X]=(0,n.useState)(!1),W=(0,n.useCallback)((()=>X((e=>!e))),[]),[Y,G]=(0,n.useState)(1);(0,n.useEffect)((()=>{b.volume=Y}),[Y,b]);const[q,B]=(0,n.useState)(o.REDWOOD),[K,z]=(0,n.useState)(null);(0,n.useEffect)((()=>{const e=i[q],t=b.isPlaying();b.src=e.url,b.load(),t&&b.play().catch((()=>{}))}),[q,b]),(0,n.useEffect)((()=>{if(!O||q!==o.KEXP)return void z(null);const e=async()=>{try{var e;const t=await fetch("https://api.kexp.org/v2/plays/?limit=1"),a=await t.json();null!==(e=a.results)&&void 0!==e&&e[0]&&"trackplay"===a.results[0].play_type&&z({song:a.results[0].song||"Unknown Track",artist:a.results[0].artist||"Unknown Artist"})}catch(t){}};e();const t=setInterval(e,3e4);return()=>clearInterval(t)}),[O,q]);const V=(0,n.useRef)(h),Z=(0,n.useRef)(u),[J,Q]=(0,n.useState)(h),[$,ee]=(0,n.useState)(u),te=(0,n.useRef)(R(h,u));(0,n.useEffect)((()=>{V.current=J,Z.current=$,te.current=R(J,$)}),[J,$,O]),(0,n.useEffect)((()=>{const a=e.current;if(!a)return;const n=window.innerWidth,r=window.innerHeight;I.current={w:n,h:r},a.width=n,a.height=r,t.current=a.getContext("2d"),g.current=null}),[]);const ae=(0,n.useCallback)((()=>{const{w:e,h:t}=I.current;null===N.current&&(N.current=function(e,t){const a=f.WIDTH*f.HEIGHT,n=e*t,r=f.PARTICLES/a,s=Math.round(n*r);return Math.max(200,Math.min(2e3,s))}(e,t));const a=N.current;m.current=function(e,t,a){const n=[],r=Math.floor(a/v.COUNT);for(let s=0;s<v.COUNT;s++){const a=Math.random()*e,s=Math.random()<v.TOP_HALF_PROB?Math.random()*t*.5:.5*t+Math.random()*t*.5,l=Math.random();for(let e=0;e<r;e++){const e=S(v.RADIUS);n.push({x:a+e.x,y:s+e.y,vx:0,vy:0,heat:l})}}for(;n.length<a;)n.push({x:Math.random()*e,y:Math.random()*t,vx:0,vy:0,heat:0});return n}(e,t,a),y.current=new Uint16Array(a),function(e,t,a,n,r){const s=Math.max(1,Math.ceil(t/r)),l=Math.max(1,Math.ceil(a/r)),c=s*l,o=e.current;o&&o.cols===s&&o.rows===l&&o.cellSize===r&&o.next.length===n&&o.heads.length===c||(e.current={cellSize:r,cols:s,rows:l,heads:new Int32Array(c),next:new Int32Array(n)})}(T,e,t,a,d.COHESION_RADIUS)}),[]),ne=(0,n.useCallback)((()=>{var e;!function(e){try{if(!Number.isFinite(e)||e<0)return;localStorage.setItem(w,String(e))}catch(t){}}(null!==(e=b.currentTime)&&void 0!==e?e:0)}),[b]);(0,n.useEffect)((()=>{if(!O)return;const e=window.setInterval((()=>ne()),1e3),t=()=>ne(),a=()=>{"hidden"===document.visibilityState&&ne()};return window.addEventListener("pagehide",t),document.addEventListener("visibilitychange",a),()=>{window.clearInterval(e),window.removeEventListener("pagehide",t),document.removeEventListener("visibilitychange",a)}}),[O,ne]),(0,n.useEffect)((()=>()=>{ne(),b.pause(),b.volume=0,b.reset(),C.pause(),C.volume=0,C.reset()}),[b,C,ne]);const re=(0,n.useCallback)((()=>{const e=T.current;if(!e)return;const{w:t,h:a}=I.current;M(m.current,t,a,D.current,H.current,y.current,P.current,e)}),[]),se=(0,n.useCallback)((()=>{const a=e.current,n=t.current;a&&n&&k(n,a,m.current,g,te.current)}),[]),le=(0,n.useRef)({last:0,acc:0}),ce=(0,n.useCallback)((e=>{const t=le.current;0===t.last&&(t.last=e);const n=e-t.last;t.last=e,t.acc+=Math.min(250,Math.max(0,n));let r=0;for(;t.acc>=x&&r<E;)re(),t.acc-=x,r++;t.acc>=x&&(t.acc=0),se(),a.current=requestAnimationFrame(ce)}),[se,re]);(0,n.useEffect)((()=>{const t=e.current;if(!t)return;const a=e=>{const a=t.getBoundingClientRect();return{x:e.clientX-a.left,y:e.clientY-a.top}},n=e=>{D.current=!0,H.current=a(e)},r=e=>{H.current=a(e)},s=()=>{D.current=!1};return t.addEventListener("pointerdown",n),window.addEventListener("pointermove",r),window.addEventListener("pointerup",s),window.addEventListener("pointercancel",s),()=>{t.removeEventListener("pointerdown",n),window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",s),window.removeEventListener("pointercancel",s)}}),[]);const oe=(0,n.useCallback)((()=>{try{C.volume=1,C.currentTime=0,C.reset(),C.play()}catch(e){}}),[C]),ie=(0,n.useCallback)((()=>{const e=function(){try{const e=localStorage.getItem(w);if(!e)return 0;const t=Number(e);return Number.isFinite(t)&&t>=0?t:0}catch(e){return 0}}();try{const t=b.duration;"number"===typeof t&&Number.isFinite(t)&&t>0?b.currentTime=e%t:b.currentTime=e}catch(t){}}),[b]),ue=(0,n.useCallback)((()=>{oe(),O||(j(!0),ae(),le.current={last:0,acc:0},requestAnimationFrame((()=>se())),a.current=requestAnimationFrame(ce)),ie(),b.volume=1,b.play()}),[ce,se,b,O,ae,oe,ie]),he=(0,n.useMemo)((()=>({w:window.innerWidth,h:window.innerHeight})),[]),de=p.STEPS-1;return(0,c.jsxs)("div",{className:"lava-lamp-container",children:[(0,c.jsx)("canvas",{ref:e,className:"lava-lamp-canvas",width:he.w,height:he.h}),K&&(0,c.jsxs)("div",{className:"lava-lamp-now-playing",children:[(0,c.jsx)("div",{className:"lava-lamp-now-playing-song",children:K.song}),(0,c.jsx)("div",{className:"lava-lamp-now-playing-artist",children:K.artist})]}),O?(0,c.jsxs)("div",{className:"lava-lamp-controls",children:[(0,c.jsx)("button",{type:"button",className:"lava-lamp-menu-toggle",onClick:W,"aria-label":F?"Hide menu":"Show menu","aria-pressed":F,children:F?"\u2715":"\u2630"}),F&&(0,c.jsxs)("div",{className:"lava-lamp-menu",children:[(0,c.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,c.jsx)("div",{className:"lava-lamp-control-header",children:(0,c.jsxs)("div",{className:"lava-lamp-control-title",children:["speed: ",L]})}),(0,c.jsx)("div",{className:"lava-lamp-slider-wrap",children:(0,c.jsx)("input",{className:"lava-lamp-slider",type:"range",min:0,max:de,step:1,value:L,onChange:e=>{return U((t=Number(e.target.value),n=de,t<(a=0)?a:t>n?n:t));var t,a,n},"aria-label":"Simulation speed"})})]}),(0,c.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,c.jsx)("div",{className:"lava-lamp-control-header",children:(0,c.jsxs)("div",{className:"lava-lamp-control-title",children:["volume: ",Math.round(100*Y),"%"]})}),(0,c.jsx)("div",{className:"lava-lamp-slider-wrap",children:(0,c.jsx)("input",{className:"lava-lamp-slider",type:"range",min:0,max:1,step:.01,value:Y,onChange:e=>G(Number(e.target.value)),"aria-label":"Music volume"})})]}),(0,c.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,c.jsx)("div",{className:"lava-lamp-control-header",children:(0,c.jsx)("div",{className:"lava-lamp-control-title",children:"audio source"})}),(0,c.jsx)("div",{className:"lava-lamp-slider-wrap",children:(0,c.jsx)("select",{className:"lava-lamp-slider",value:q,onChange:e=>B(e.target.value),"aria-label":"Audio source",children:Object.entries(i).map((e=>{let[t,a]=e;return(0,c.jsx)("option",{value:t,children:a.label},t)}))})})]}),(0,c.jsxs)("div",{className:"lava-lamp-control-block",children:[(0,c.jsx)("div",{className:"lava-lamp-control-header",children:(0,c.jsx)("div",{className:"lava-lamp-control-title",children:"lava colors"})}),(0,c.jsxs)("div",{className:"lava-lamp-color-row",children:[(0,c.jsxs)("label",{className:"lava-lamp-color-label",children:["hot",(0,c.jsx)("input",{className:"lava-lamp-color-input",type:"color",value:$,onChange:e=>ee(e.target.value),"aria-label":"Lava high color"})]}),(0,c.jsxs)("label",{className:"lava-lamp-color-label",children:["cool",(0,c.jsx)("input",{className:"lava-lamp-color-input",type:"color",value:J,onChange:e=>Q(e.target.value),"aria-label":"Lava low color"})]}),(0,c.jsx)("button",{type:"button",className:"lava-lamp-color-reset",onClick:()=>{Q(h),ee(u)},children:"reset"})]})]})]})]}):(0,c.jsx)("div",{className:"lava-lamp-start-overlay",children:(0,c.jsx)("button",{type:"button",className:"lava-lamp-start",onClick:ue,"aria-label":"Start lava lamp",children:"START"})})]})}},7375:(e,t,a)=>{a.d(t,{D:()=>n});class n extends Audio{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e),this.isPlayingSrc=e=>{var t;return(null===(t=this.src)||void 0===t?void 0:t.includes(e))&&this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2},this.isPlaying=()=>this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2,this.timeLeft=()=>this.duration-this.currentTime,this.reset=()=>{this.pause(),this.currentTime=0},this.loop=t}}}}]);
//# sourceMappingURL=200.960cda81.chunk.js.map