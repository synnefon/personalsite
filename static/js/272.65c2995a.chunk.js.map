{"version":3,"file":"static/js/272.65c2995a.chunk.js","mappings":"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","sources":["assets/lavaLamp/power.svg","util/audioAmplitude.ts","lava_lamp/LavaLamp.tsx","util/Audio.js"],"sourcesContent":["var _g;\nconst _excluded = [\"title\", \"titleId\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var s = Object.getOwnPropertySymbols(e); for (r = 0; r < s.length; r++) o = s[r], t.includes(o) || {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (e.includes(n)) continue; t[n] = r[n]; } return t; }\nimport * as React from \"react\";\nfunction SvgPower(_ref, svgRef) {\n  let {\n      title,\n      titleId\n    } = _ref,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    id: \"Capa_1\",\n    x: \"0px\",\n    y: \"0px\",\n    viewBox: \"0 0 512.292 512.292\",\n    style: {\n      enableBackground: \"new 0 0 512.292 512.292\"\n    },\n    xmlSpace: \"preserve\",\n    width: 512,\n    height: 512,\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M256.061,0L256.061,0c17.673,0,32,14.327,32,32v106.667c0,17.673-14.327,32-32,32l0,0c-17.673,0-32-14.327-32-32V32   C224.061,14.327,238.387,0,256.061,0z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M330.727,105.387L330.727,105.387c-0.157,10.742,5.259,20.8,14.315,26.581c80.432,49.143,105.796,154.185,56.652,234.616   S247.51,472.38,167.078,423.237S61.282,269.052,110.426,188.62c14.042-22.982,33.324-42.315,56.269-56.418   c9.211-5.781,14.773-15.92,14.699-26.795l0,0c0.049-17.673-14.238-32.039-31.911-32.088c-6.07-0.017-12.02,1.693-17.155,4.931   C22.233,146.634-11.58,291.318,56.803,401.412s213.067,143.907,323.161,75.524s143.907-213.067,75.524-323.161   c-19.035-30.645-44.879-56.489-75.524-75.524c-14.997-9.461-34.824-4.973-44.285,10.024   C332.447,93.397,330.731,99.33,330.727,105.387z\"\n  }))));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgPower);\nexport default __webpack_public_path__ + \"static/media/power.632cc1e66922cf3fa35d93370ea84178.svg\";\nexport { ForwardRef as ReactComponent };","/**\n * Audio amplitude analysis for visualizing music playback.\n * Uses Web Audio API's AnalyserNode to extract real-time amplitude data.\n */\n\nexport class AudioAmplitudeAnalyzer {\n  private audioContext: AudioContext | null = null;\n  private analyser: AnalyserNode | null = null;\n  private dataArray: Uint8Array | null = null;\n  private connected = false;\n\n  /**\n   * Initialize and connect the analyser to an audio element.\n   * Must be called after user interaction to avoid autoplay restrictions.\n   */\n  connect(audioElement: HTMLAudioElement): boolean {\n    if (this.connected) return true;\n\n    try {\n      this.audioContext = new AudioContext();\n      this.analyser = this.audioContext.createAnalyser();\n      this.analyser.fftSize = 256; // Small size for performance\n      this.analyser.smoothingTimeConstant = 0.8; // Smooth out jitter\n\n      const source = this.audioContext.createMediaElementSource(audioElement);\n      source.connect(this.analyser).connect(this.audioContext.destination);\n\n      this.dataArray = new Uint8Array(this.analyser.frequencyBinCount);\n      this.connected = true;\n\n      return true;\n    } catch (err) {\n      console.warn('[AudioAmplitude] Failed to connect analyser:', err);\n      return false;\n    }\n  }\n\n  /**\n   * Get current amplitude as a value between 0 and 1.\n   * Uses RMS (root mean square) for smooth, accurate amplitude measurement.\n   */\n  getAmplitude(): number {\n    if (!this.analyser || !this.dataArray) return 0;\n\n    try {\n      // Get time domain data (waveform)\n      this.analyser.getByteTimeDomainData(this.dataArray);\n\n      // Calculate RMS amplitude\n      let sum = 0;\n      for (let i = 0; i < this.dataArray.length; i++) {\n        const normalized = (this.dataArray[i] - 128) / 128;\n        sum += normalized * normalized;\n      }\n\n      const rms = Math.sqrt(sum / this.dataArray.length);\n\n      // Boost the signal for better visualization (typical music is quiet)\n      return Math.min(1, rms * 3);\n    } catch (err) {\n      console.warn('[AudioAmplitude] Error reading amplitude:', err);\n      return 0;\n    }\n  }\n\n  /**\n   * Resume audio context if suspended (required on some browsers after page load).\n   */\n  resume(): void {\n    if (this.audioContext && this.audioContext.state === 'suspended') {\n      this.audioContext.resume().catch((err) => {\n        console.warn('[AudioAmplitude] Failed to resume audio context:', err);\n      });\n    }\n  }\n\n  /**\n   * Clean up resources.\n   */\n  disconnect(): void {\n    if (this.audioContext) {\n      this.audioContext.close().catch(() => {\n        // ignore\n      });\n      this.audioContext = null;\n    }\n    this.analyser = null;\n    this.dataArray = null;\n    this.connected = false;\n  }\n\n  isConnected(): boolean {\n    return this.connected;\n  }\n}\n","import React, {\n  ReactElement,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport \"../styles/lavalamp.css\";\n\n// AIDEV-NOTE: TypeScript cannot import non-code assets directly unless custom module declarations exist; fallback to string for asset references\n// If using custom typings (e.g., for mp3/svg imports), ensure they exist in `src/types` or `@types`.\n\n// If not, import as string and ignore TS error (safest cross-project), or\n// declare the modules in a `.d.ts` file for the asset types.\n\n// @ts-expect-error - See AIDEV-NOTE above; ensure proper module declarations for assets or update your tsconfig to include them.\nimport musicAudioNoise from \"../assets/lavaLamp/guitar.mp3\";\n// @ts-expect-error - See AIDEV-NOTE above.\nimport clickAudioNoise from \"../assets/lavaLamp/click.mp3\";\n// @ts-expect-error - See AIDEV-NOTE above.\nimport powerIcon from \"../assets/lavaLamp/power.svg\";\nimport { PersonalAudio } from \"../util/Audio\";\nimport { AudioAmplitudeAnalyzer } from \"../util/audioAmplitude.ts\";\n\n// --- Audio sources ---\nconst AUDIO_SOURCES = {\n  REDWOOD: \"redwood\",\n  KEXP: \"kexp\",\n} as const;\n\ntype AudioSource = typeof AUDIO_SOURCES[keyof typeof AUDIO_SOURCES];\n\nconst AUDIO_SOURCE_CONFIG: Record<AudioSource, { label: string; url: string }> = {\n  [AUDIO_SOURCES.REDWOOD]: {\n    label: \"redwood meditation\",\n    url: musicAudioNoise,\n  },\n  [AUDIO_SOURCES.KEXP]: {\n    label: \"kexp\",\n    url: \"https://kexp.streamguys1.com/kexp160.aac\",\n  },\n};\n\n// --- Colors: keep state (for controlled inputs) + refs (fast access elsewhere) ---\nconst DEFAULT_HIGH = \"#ffdd00\";\nconst DEFAULT_LOW = \"#ff5500\";\n\n// --- Types ---\ninterface Particle {\n  x: number;\n  y: number;\n  vx: number;\n  vy: number;\n  heat: number; // [0..1]\n}\n\ntype Vec2 = { x: number; y: number };\n\ntype SpatialGrid = {\n  cellSize: number;\n  cols: number;\n  rows: number;\n  heads: Int32Array; // length cols*rows, head index or -1\n  next: Int32Array; // length particleCount, next index or -1\n};\n\n// --- Constants ---\nconst SIM = {\n  GRAVITY: 0.01,\n  BUOYANCY: 0.04,\n  FRICTION: 0.98,\n\n  HEAT_RATE: 0.005,\n  COOL_RATE: 0.0017,\n  HEAT_CONDUCTION: 0.002,\n\n  HEAT_SOURCE_DISTANCE: 45,\n\n  COHESION_RADIUS: 25,\n  COHESION_STRENGTH: 0.0035,\n\n  MOUSE_HEAT_RADIUS: 100,\n} as const;\n\nconst RENDER = {\n  PARTICLE_RADIUS: 10,\n  PIXEL_SIZE: 6,\n  THRESHOLD: 0.8,\n} as const;\n\nconst CLUMPS = {\n  COUNT: 15,\n  RADIUS: 50,\n  TOP_HALF_PROB: 0.3,\n} as const;\n\n// Baseline density: preserves \"look\" across screens, computed once per page load.\nconst BASELINE = {\n  WIDTH: 1920,\n  HEIGHT: 1080,\n  PARTICLES: 1200,\n} as const;\n\n// --- Speed control (indexed slider) ---\nconst SPEED = {\n  MIN: 0.0,\n  MAX: 5,\n  DEFAULT: 0.25,\n  STEPS: 10, // number of discrete positions\n} as const;\n\n// --- Fixed update rate (independent of render cost / screen size) ---\nconst FIXED_FPS = 60;\nconst FIXED_MS = 1000 / FIXED_FPS;\nconst MAX_CATCHUP_STEPS = 4;\n\n// --- Persisted audio position ---\nconst MUSIC_TIME_KEY = \"lavaLamp.musicTimeSeconds\";\n\n// --- Utils ---\nfunction clamp01(v: number): number {\n  return v < 0 ? 0 : v > 1 ? 1 : v;\n}\n\nfunction clampInt(v: number, lo: number, hi: number) {\n  return v < lo ? lo : v > hi ? hi : v;\n}\n\nfunction lerp(a: number, b: number, t: number) {\n  return a + (b - a) * t;\n}\n\nfunction lerpInt(a: number, b: number, t: number): number {\n  const v = a + (b - a) * t;\n  return v < 0 ? 0 : v > 255 ? 255 : Math.round(v);\n}\n\nfunction randInCircle(radius: number): Vec2 {\n  const angle = Math.random() * Math.PI * 2;\n  const r = Math.random() * radius;\n  return { x: Math.cos(angle) * r, y: Math.sin(angle) * r };\n}\n\nfunction bounceInBounds(p: Particle, width: number, height: number) {\n  if (p.x < 0) {\n    p.x = 0;\n    p.vx *= -0.5;\n  } else if (p.x > width) {\n    p.x = width;\n    p.vx *= -0.5;\n  }\n\n  if (p.y < 0) {\n    p.y = 0;\n    p.vy *= -0.5;\n  } else if (p.y > height) {\n    p.y = height;\n    p.vy *= -0.5;\n  }\n}\n\nfunction clampAllToBounds(particles: Particle[], width: number, height: number) {\n  for (let i = 0; i < particles.length; i++) {\n    bounceInBounds(particles[i], width, height);\n  }\n}\n\nfunction computeParticleCount(width: number, height: number): number {\n  const baselineArea = BASELINE.WIDTH * BASELINE.HEIGHT;\n  const currentArea = width * height;\n\n  const density = BASELINE.PARTICLES / baselineArea;\n  const scaled = Math.round(currentArea * density);\n\n  return Math.max(200, Math.min(2000, scaled));\n}\n\nfunction readSavedMusicTimeSeconds(): number {\n  try {\n    const raw = localStorage.getItem(MUSIC_TIME_KEY);\n    if (!raw) return 0;\n    const v = Number(raw);\n    return Number.isFinite(v) && v >= 0 ? v : 0;\n  } catch {\n    return 0;\n  }\n}\n\nfunction writeSavedMusicTimeSeconds(seconds: number) {\n  try {\n    if (!Number.isFinite(seconds) || seconds < 0) return;\n    localStorage.setItem(MUSIC_TIME_KEY, String(seconds));\n  } catch {\n    // ignore\n  }\n}\n\n// Note: MIN=0 is special; idx 0 => frozen-ish. idx 1..(STEPS-1) => (0..MAX] in log space.\nfunction indexToSpeed(idx: number): number {\n  if (idx <= 0) return 0;\n\n  const steps = SPEED.STEPS;\n  if (idx >= steps) return SPEED.MAX;\n\n  // normalized position excluding 0\n  const t = idx / steps; // idx=steps/2 => midpoint\n\n  // calibrated so midpoint ≈ 0.5\n  const targetMidSpeed = 0.5;\n  const minPositive = (targetMidSpeed * targetMidSpeed) / SPEED.MAX;\n\n  const minLog = Math.log(minPositive);\n  const maxLog = Math.log(SPEED.MAX);\n\n  return Math.exp(lerp(minLog, maxLog, t));\n}\n\nfunction speedToNearestIndex(speed: number): number {\n  if (speed <= 0) return 0;\n\n  const steps = SPEED.STEPS;\n  const last = steps - 1;\n\n  let best = 1;\n  let bestErr = Infinity;\n  const target = Math.log(speed);\n\n  for (let i = 1; i <= last; i++) {\n    const s = indexToSpeed(i);\n    const err = Math.abs(Math.log(s) - target);\n    if (err < bestErr) {\n      bestErr = err;\n      best = i;\n    }\n  }\n  return best;\n}\n\n// --- Color / LUT ---\nfunction hexToRgb(hex: string): { r: number; g: number; b: number } {\n  const h = hex.trim().replace(\"#\", \"\");\n  if (h.length === 3) {\n    const r = parseInt(h[0] + h[0], 16);\n    const g = parseInt(h[1] + h[1], 16);\n    const b = parseInt(h[2] + h[2], 16);\n    return { r, g, b };\n  }\n  if (h.length === 6) {\n    const r = parseInt(h.slice(0, 2), 16);\n    const g = parseInt(h.slice(2, 4), 16);\n    const b = parseInt(h.slice(4, 6), 16);\n    return { r, g, b };\n  }\n  return { r: 255, g: 221, b: 0 };\n}\n\nfunction packRgba(r: number, g: number, b: number, a: number): number {\n  // Uint32Array view over ImageData.data.buffer (common little-endian fast path).\n  return (a << 24) | (b << 16) | (g << 8) | r;\n}\n\nfunction buildHeatLut256(lowHex: string, highHex: string): Uint32Array {\n  const lo = hexToRgb(lowHex);\n  const hi = hexToRgb(highHex);\n\n  const lut = new Uint32Array(256);\n  for (let i = 0; i < 256; i++) {\n    const t = i / 255;\n    const r = lerpInt(lo.r, hi.r, t);\n    const g = lerpInt(lo.g, hi.g, t);\n    const b = lerpInt(lo.b, hi.b, t);\n    lut[i] = packRgba(r, g, b, 255);\n  }\n  return lut;\n}\n\n// --- Spatial grid helpers ---\nfunction ensureGrid(\n  gridRef: React.MutableRefObject<SpatialGrid | null>,\n  width: number,\n  height: number,\n  count: number,\n  cellSize: number\n) {\n  const cols = Math.max(1, Math.ceil(width / cellSize));\n  const rows = Math.max(1, Math.ceil(height / cellSize));\n  const cells = cols * rows;\n\n  const g = gridRef.current;\n  if (\n    !g ||\n    g.cols !== cols ||\n    g.rows !== rows ||\n    g.cellSize !== cellSize ||\n    g.next.length !== count ||\n    g.heads.length !== cells\n  ) {\n    gridRef.current = {\n      cellSize,\n      cols,\n      rows,\n      heads: new Int32Array(cells),\n      next: new Int32Array(count),\n    };\n  }\n}\n\nfunction gridIndex(g: SpatialGrid, cx: number, cy: number): number {\n  return cy * g.cols + cx;\n}\n\n// --- Init ---\nfunction createParticles(width: number, height: number, count: number): Particle[] {\n  const particles: Particle[] = [];\n  const particlesPerClump = Math.floor(count / CLUMPS.COUNT);\n\n  for (let i = 0; i < CLUMPS.COUNT; i++) {\n    const centerX = Math.random() * width;\n    const centerY =\n      Math.random() < CLUMPS.TOP_HALF_PROB\n        ? Math.random() * height * 0.5\n        : height * 0.5 + Math.random() * height * 0.5;\n\n    const clumpHeat = Math.random();\n    for (let j = 0; j < particlesPerClump; j++) {\n      const offset = randInCircle(CLUMPS.RADIUS);\n      particles.push({\n        x: centerX + offset.x,\n        y: centerY + offset.y,\n        vx: 0,\n        vy: 0,\n        heat: clumpHeat,\n      });\n    }\n  }\n\n  while (particles.length < count) {\n    particles.push({\n      x: Math.random() * width,\n      y: Math.random() * height,\n      vx: 0,\n      vy: 0,\n      heat: 0,\n    });\n  }\n\n  return particles;\n}\n\n// --- Physics (grid-accelerated cohesion/conduction) ---\nexport function stepSimulationOnePairPass(\n  particles: Particle[],\n  width: number,\n  height: number,\n  pointerDown: boolean,\n  pointerPos: Vec2,\n  neighborCounts: Uint16Array,\n  timeScale: number,\n  grid: SpatialGrid\n) {\n  const dt = Math.max(0, Math.min(4.0, timeScale));\n\n  // Pass 1: integrate + pointer heat + reset neighbors + bounds\n  for (let i = 0; i < particles.length; i++) {\n    const p = particles[i];\n\n    applyBuoyancyAndGravity(p, dt);\n    applyFriction(p, dt);\n    integrate(p, dt);\n\n    if (pointerDown) applyPointerHeat(p, pointerPos, dt);\n\n    neighborCounts[i] = 0;\n    bounceInBounds(p, width, height);\n  }\n\n  // dt=0 => frozen (no cohesion/conduction/cooling), but still clamp\n  if (dt === 0) {\n    for (let i = 0; i < particles.length; i++) {\n      particles[i].heat = clamp01(particles[i].heat);\n    }\n    clampAllToBounds(particles, width, height);\n    return;\n  }\n\n  // Build spatial hash\n  grid.heads.fill(-1);\n  const invCell = 1 / grid.cellSize;\n\n  for (let i = 0; i < particles.length; i++) {\n    const p = particles[i];\n\n    let cx = (p.x * invCell) | 0;\n    let cy = (p.y * invCell) | 0;\n\n    if (cx < 0) cx = 0;\n    else if (cx >= grid.cols) cx = grid.cols - 1;\n\n    if (cy < 0) cy = 0;\n    else if (cy >= grid.rows) cy = grid.rows - 1;\n\n    const cell = gridIndex(grid, cx, cy);\n    grid.next[i] = grid.heads[cell];\n    grid.heads[cell] = i;\n  }\n\n  // Pass 2: local neighbor forces + conduction\n  const r = SIM.COHESION_RADIUS;\n  const r2 = r * r;\n\n  for (let i = 0; i < particles.length; i++) {\n    const p1 = particles[i];\n\n    let cx = (p1.x * invCell) | 0;\n    let cy = (p1.y * invCell) | 0;\n\n    if (cx < 0) cx = 0;\n    else if (cx >= grid.cols) cx = grid.cols - 1;\n\n    if (cy < 0) cy = 0;\n    else if (cy >= grid.rows) cy = grid.rows - 1;\n\n    const x0 = cx > 0 ? cx - 1 : cx;\n    const x1 = cx + 1 < grid.cols ? cx + 1 : cx;\n    const y0 = cy > 0 ? cy - 1 : cy;\n    const y1 = cy + 1 < grid.rows ? cy + 1 : cy;\n\n    for (let ny = y0; ny <= y1; ny++) {\n      for (let nx = x0; nx <= x1; nx++) {\n        let j = grid.heads[gridIndex(grid, nx, ny)];\n        while (j !== -1) {\n          if (j > i) {\n            const p2 = particles[j];\n            const dx = p2.x - p1.x;\n            const dy = p2.y - p1.y;\n            const d2 = dx * dx + dy * dy;\n\n            if (d2 > 0 && d2 < r2) {\n              neighborCounts[i]++;\n              neighborCounts[j]++;\n\n              const d = Math.sqrt(d2);\n              applyCohesionImpulse(p1, p2, dx, dy, d, dt);\n              applyHeatConduction(p1, p2, dt);\n            }\n          }\n          j = grid.next[j];\n        }\n      }\n    }\n  }\n\n  // Pass 3: heat source / cooling\n  for (let i = 0; i < particles.length; i++) {\n    const p = particles[i];\n    applyBottomHeatOrAirCooling(p, height, neighborCounts[i], dt);\n    p.heat = clamp01(p.heat);\n  }\n\n  clampAllToBounds(particles, width, height);\n}\n\nfunction applyBuoyancyAndGravity(p: Particle, dt: number) {\n  const buoyancy = p.heat * p.heat * SIM.BUOYANCY;\n  p.vy += (SIM.GRAVITY - buoyancy) * dt;\n}\n\nfunction applyFriction(p: Particle, dt: number) {\n  const f = Math.pow(SIM.FRICTION, dt);\n  p.vx *= f;\n  p.vy *= f;\n}\n\nfunction integrate(p: Particle, dt: number) {\n  p.x += p.vx * dt;\n  p.y += p.vy * dt;\n}\n\nfunction applyPointerHeat(p: Particle, pointerPos: Vec2, dt: number) {\n  const dx = p.x - pointerPos.x;\n  const dy = p.y - pointerPos.y;\n  const d2 = dx * dx + dy * dy;\n  const r = SIM.MOUSE_HEAT_RADIUS;\n  const r2 = r * r;\n\n  if (d2 < r2) {\n    const d = Math.sqrt(d2);\n    const intensity = 1 - d * (1 / r);\n    p.heat += SIM.HEAT_RATE * 2 * intensity * dt;\n  }\n}\n\nfunction applyCohesionImpulse(\n  p1: Particle,\n  p2: Particle,\n  dx: number,\n  dy: number,\n  d: number,\n  dt: number\n) {\n  const force = SIM.COHESION_STRENGTH * (1 - d * (1 / SIM.COHESION_RADIUS));\n  const invD = 1 / d;\n  const fx = dx * invD * force * dt;\n  const fy = dy * invD * force * dt;\n\n  p1.vx += fx;\n  p1.vy += fy;\n  p2.vx -= fx;\n  p2.vy -= fy;\n}\n\nfunction applyHeatConduction(p1: Particle, p2: Particle, dt: number) {\n  const heatDiff = p1.heat - p2.heat;\n  const conduction = heatDiff * SIM.HEAT_CONDUCTION * dt;\n  p1.heat -= conduction;\n  p2.heat += conduction;\n}\n\nfunction applyBottomHeatOrAirCooling(\n  p: Particle,\n  height: number,\n  neighborCount: number,\n  dt: number\n) {\n  const distanceFromBottom = height - p.y;\n\n  if (distanceFromBottom < SIM.HEAT_SOURCE_DISTANCE) {\n    const intensity = 1 - distanceFromBottom * (1 / SIM.HEAT_SOURCE_DISTANCE);\n    p.heat += SIM.HEAT_RATE * intensity * dt;\n    return;\n  }\n\n  const maxNeighbors = 8;\n  const neighbors = neighborCount < maxNeighbors ? neighborCount : maxNeighbors;\n  const airExposure = 1 - neighbors / maxNeighbors;\n\n  p.heat -= SIM.COOL_RATE * (0.2 + airExposure * 0.8) * dt;\n}\n\n// --- Render helpers ---\nfunction ensureImageData(\n  ctx: CanvasRenderingContext2D,\n  imageRef: React.MutableRefObject<ImageData | null>,\n  width: number,\n  height: number\n): ImageData {\n  const img = imageRef.current;\n  if (!img || img.width !== width || img.height !== height) {\n    imageRef.current = ctx.createImageData(width, height);\n  }\n  return imageRef.current!;\n}\n\nfunction drawMetaballs(\n  imageData: ImageData,\n  particles: Particle[],\n  canvasWidth: number,\n  canvasHeight: number,\n  heatLut256: Uint32Array\n) {\n  const pixelSize = RENDER.PIXEL_SIZE;\n  const threshold = RENDER.THRESHOLD;\n  const r2 = RENDER.PARTICLE_RADIUS * RENDER.PARTICLE_RADIUS;\n\n  const data32 = new Uint32Array(imageData.data.buffer);\n\n  // 7) Don’t clear twice: clear ONCE here to opaque black\n  const black = packRgba(0, 0, 0, 255);\n  data32.fill(black);\n\n  const w = canvasWidth;\n\n  for (let y = 0; y < canvasHeight; y += pixelSize) {\n    for (let x = 0; x < canvasWidth; x += pixelSize) {\n      let influenceSum = 0;\n      let heatWeightedSum = 0;\n\n      for (let i = 0; i < particles.length; i++) {\n        const p = particles[i];\n        const dx = x - p.x;\n        const dy = y - p.y;\n        const distSq = dx * dx + dy * dy;\n        const influence = r2 / (distSq + 1);\n\n        influenceSum += influence;\n        heatWeightedSum += influence * p.heat;\n      }\n\n      if (influenceSum <= threshold) continue;\n\n      const heat = heatWeightedSum / influenceSum;\n      const lutIdx = heat <= 0 ? 0 : heat >= 1 ? 255 : (heat * 255) | 0;\n      const rgba = heatLut256[lutIdx];\n\n      for (let py = 0; py < pixelSize; py++) {\n        const yy = y + py;\n        if (yy >= canvasHeight) break;\n\n        let idx = yy * w + x;\n        const rowEnd = Math.min(x + pixelSize, w);\n        for (let xx = x; xx < rowEnd; xx++) {\n          data32[idx++] = rgba;\n        }\n      }\n    }\n  }\n}\n\nfunction renderFrame(\n  ctx: CanvasRenderingContext2D,\n  canvas: HTMLCanvasElement,\n  particles: Particle[],\n  imageRef: React.MutableRefObject<ImageData | null>,\n  heatLut256: Uint32Array\n) {\n  const imageData = ensureImageData(ctx, imageRef, canvas.width, canvas.height);\n  drawMetaballs(imageData, particles, canvas.width, canvas.height, heatLut256);\n  ctx.putImageData(imageData, 0, 0);\n}\n\n// --- Component ---\nexport default function LavaLamp(): ReactElement {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const ctxRef = useRef<CanvasRenderingContext2D | null>(null);\n\n  const rafRef = useRef<number | null>(null);\n\n  const particlesRef = useRef<Particle[]>([]);\n  const imageRef = useRef<ImageData | null>(null);\n  const neighborCountsRef = useRef<Uint16Array>(new Uint16Array(0));\n  const particleCountRef = useRef<number | null>(null);\n\n  const gridRef = useRef<SpatialGrid | null>(null);\n\n  // 5) Cache dimensions ONCE (read only on page load)\n  const sizeRef = useRef<{ w: number; h: number }>({ w: 1, h: 1 });\n\n  const [audioSource, setAudioSource] = useState<AudioSource>(AUDIO_SOURCES.KEXP);\n\n  const gameMusic = useMemo(() => {\n    // Initialize directly with KEXP stream\n    const audio = new PersonalAudio(AUDIO_SOURCE_CONFIG[AUDIO_SOURCES.KEXP].url, true);\n    audio.preload = \"auto\";\n    return audio;\n  }, []);\n  const clickSound = useMemo(() => new PersonalAudio(clickAudioNoise, false), []);\n\n  const [hasStarted, setHasStarted] = useState(false);\n\n  const pointerDownRef = useRef(false);\n  const pointerPosRef = useRef<Vec2>({ x: 0, y: 0 });\n\n  // Audio amplitude analysis\n  const amplitudeAnalyzerRef = useRef<AudioAmplitudeAnalyzer | null>(null);\n  const currentAmplitudeRef = useRef(0);\n  const [displayAmplitude, setDisplayAmplitude] = useState(0);\n  const amplitudeUpdateCounterRef = useRef(0);\n\n  // Speed slider state\n  const defaultSpeedIdx = useMemo(() => speedToNearestIndex(SPEED.DEFAULT), []);\n  const [speedIdx, setSpeedIdx] = useState<number>(defaultSpeedIdx);\n  const speedRef = useRef<number>(SPEED.DEFAULT);\n\n  useEffect(() => {\n    speedRef.current = indexToSpeed(speedIdx);\n  }, [speedIdx]);\n\n  const [menuOpen, setMenuOpen] = useState(false);\n  const toggleMenu = useCallback(() => setMenuOpen((v) => !v), []);\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  // Close menu when clicking outside\n  useEffect(() => {\n    if (!menuOpen) return;\n\n    const handleClickOutside = (event: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\n        setMenuOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [menuOpen]);\n\n  const [volume, setVolume] = useState(1.0);\n  useEffect(() => {\n    gameMusic.volume = volume;\n  }, [volume, gameMusic]);\n  const [nowPlaying, setNowPlaying] = useState<{\n    song: string;\n    artist: string;\n    album: string;\n    isAirbreak: boolean;\n  } | null>(null);\n  const [nowPlayingExpanded, setNowPlayingExpanded] = useState(true);\n  const nowPlayingSongRef = useRef<HTMLDivElement>(null);\n  const nowPlayingArtistRef = useRef<HTMLDivElement>(null);\n  const nowPlayingAlbumRef = useRef<HTMLDivElement>(null);\n  const [songOverflowing, setSongOverflowing] = useState(false);\n  const [artistOverflowing, setArtistOverflowing] = useState(false);\n  const [albumOverflowing, setAlbumOverflowing] = useState(false);\n\n  const isFirstRender = useRef(true);\n\n  useEffect(() => {\n    // Skip on first render - audio is already initialized with KEXP\n    if (isFirstRender.current) {\n      isFirstRender.current = false;\n      return;\n    }\n\n    const config = AUDIO_SOURCE_CONFIG[audioSource];\n    const wasPlaying = gameMusic.isPlaying();\n\n    // Pause current audio before switching\n    if (wasPlaying) {\n      gameMusic.pause();\n    }\n\n    gameMusic.src = config.url;\n    gameMusic.load();\n\n    if (wasPlaying) {\n      const onCanPlay = () => {\n        gameMusic.play().catch(() => {\n          // ignore autoplay errors\n        });\n        gameMusic.removeEventListener('canplaythrough', onCanPlay);\n      };\n      gameMusic.addEventListener('canplaythrough', onCanPlay, { once: true });\n    }\n  }, [audioSource, gameMusic]);\n\n  // Fetch KEXP now playing info\n  useEffect(() => {\n    if (!hasStarted || audioSource !== AUDIO_SOURCES.KEXP) {\n      setNowPlaying(null);\n      return;\n    }\n\n    const fetchNowPlaying = async () => {\n      try {\n        const response = await fetch(\"https://api.kexp.org/v2/plays/?limit=5\");\n        const data = await response.json();\n\n        // Get the most recent play regardless of type\n        const mostRecentPlay = data.results?.[0];\n\n        if (!mostRecentPlay) {\n          console.log('[KEXP] No plays found');\n          return;\n        }\n\n        // Check if it's an airbreak\n        if (mostRecentPlay.play_type === \"airbreak\") {\n          console.log('[KEXP] Current play is airbreak');\n          setNowPlaying({\n            song: \"airbreak\",\n            artist: \"\",\n            album: \"\",\n            isAirbreak: true,\n          });\n        } else if (mostRecentPlay.play_type === \"trackplay\") {\n          const newTrack = {\n            song: (mostRecentPlay.song || \"unknown track\").toLowerCase(),\n            artist: (mostRecentPlay.artist || \"unknown artist\").toLowerCase(),\n            album: (mostRecentPlay.album || \"unknown album\").toLowerCase(),\n            isAirbreak: false,\n          };\n          console.log('[KEXP] Updating now playing:', newTrack);\n          setNowPlaying(newTrack);\n        }\n      } catch (err) {\n        console.log('[KEXP] Fetch error:', err);\n      }\n    };\n\n    fetchNowPlaying();\n    const interval = setInterval(fetchNowPlaying, 10000); // Poll every 10 seconds\n\n    return () => clearInterval(interval);\n  }, [hasStarted, audioSource]);\n\n  // Check for text overflow and apply scrolling class\n  useEffect(() => {\n    const SCROLL_SPEED = 30; // pixels per second (slower = more readable)\n\n    const calculateScrollDuration = (containerWidth: number, textWidth: number): number => {\n      // Distance = just the text width (text scrolls from 0% to -100%)\n      return textWidth / SCROLL_SPEED;\n    };\n\n    const checkOverflow = () => {\n      if (nowPlayingSongRef.current) {\n        const wrapper = nowPlayingSongRef.current.querySelector('.scroll-wrapper') as HTMLElement;\n        const containerWidth = nowPlayingSongRef.current.clientWidth;\n        const isOverflowing = wrapper && wrapper.scrollWidth > containerWidth;\n        setSongOverflowing(!!isOverflowing);\n        if (isOverflowing && wrapper) {\n          const duration = calculateScrollDuration(containerWidth, wrapper.scrollWidth);\n          nowPlayingSongRef.current.style.setProperty('--scroll-duration', `${duration}s`);\n          nowPlayingSongRef.current.classList.add(\"overflowing\");\n        } else {\n          nowPlayingSongRef.current.classList.remove(\"overflowing\");\n        }\n      }\n\n      if (nowPlayingArtistRef.current) {\n        const wrapper = nowPlayingArtistRef.current.querySelector('.scroll-wrapper') as HTMLElement;\n        const containerWidth = nowPlayingArtistRef.current.clientWidth;\n        const isOverflowing = wrapper && wrapper.scrollWidth > containerWidth;\n        setArtistOverflowing(!!isOverflowing);\n        if (isOverflowing && wrapper) {\n          const duration = calculateScrollDuration(containerWidth, wrapper.scrollWidth);\n          nowPlayingArtistRef.current.style.setProperty('--scroll-duration', `${duration}s`);\n          nowPlayingArtistRef.current.classList.add(\"overflowing\");\n        } else {\n          nowPlayingArtistRef.current.classList.remove(\"overflowing\");\n        }\n      }\n\n      if (nowPlayingAlbumRef.current) {\n        const wrapper = nowPlayingAlbumRef.current.querySelector('.scroll-wrapper') as HTMLElement;\n        const containerWidth = nowPlayingAlbumRef.current.clientWidth;\n        const isOverflowing = wrapper && wrapper.scrollWidth > containerWidth;\n        setAlbumOverflowing(!!isOverflowing);\n        if (isOverflowing && wrapper) {\n          const duration = calculateScrollDuration(containerWidth, wrapper.scrollWidth);\n          nowPlayingAlbumRef.current.style.setProperty('--scroll-duration', `${duration}s`);\n          nowPlayingAlbumRef.current.classList.add(\"overflowing\");\n        } else {\n          nowPlayingAlbumRef.current.classList.remove(\"overflowing\");\n        }\n      }\n    };\n\n    checkOverflow();\n    window.addEventListener(\"resize\", checkOverflow);\n\n    return () => window.removeEventListener(\"resize\", checkOverflow);\n  }, [nowPlaying, nowPlayingExpanded]);\n\n  const lavaLowColorRef = useRef(DEFAULT_LOW);\n  const lavaHighColorRef = useRef(DEFAULT_HIGH);\n\n  const [lavaLowColor, setLavaLowColor] = useState(DEFAULT_LOW);\n  const [lavaHighColor, setLavaHighColor] = useState(DEFAULT_HIGH);\n\n  const heatLutRef = useRef<Uint32Array>(buildHeatLut256(DEFAULT_LOW, DEFAULT_HIGH));\n\n  // Rebuild LUT whenever colors change; redraw immediately if running.\n  useEffect(() => {\n    lavaLowColorRef.current = lavaLowColor;\n    lavaHighColorRef.current = lavaHighColor;\n    heatLutRef.current = buildHeatLut256(lavaLowColor, lavaHighColor);\n  }, [lavaLowColor, lavaHighColor, hasStarted]);\n\n  // 5) Cache canvas/context + dimensions (only read on initial mount)\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const w = window.innerWidth;\n    const h = window.innerHeight;\n    sizeRef.current = { w, h };\n\n    canvas.width = w;\n    canvas.height = h;\n\n    ctxRef.current = canvas.getContext(\"2d\");\n\n    // ensure image data matches cached size\n    imageRef.current = null;\n\n    // no resize listener by request\n  }, []);\n\n  const initializeParticlesOnce = useCallback(() => {\n    const { w, h } = sizeRef.current;\n\n    if (particleCountRef.current === null) {\n      particleCountRef.current = computeParticleCount(w, h);\n    }\n\n    const count = particleCountRef.current;\n    particlesRef.current = createParticles(w, h, count);\n    neighborCountsRef.current = new Uint16Array(count);\n\n    ensureGrid(gridRef, w, h, count, SIM.COHESION_RADIUS);\n  }, []);\n\n  const saveMusicPosition = useCallback(() => {\n    writeSavedMusicTimeSeconds(gameMusic.currentTime ?? 0);\n  }, [gameMusic]);\n\n  useEffect(() => {\n    if (!hasStarted) return;\n\n    const tick = () => saveMusicPosition();\n    const id = window.setInterval(tick, 1000);\n\n    const onPageHide = () => saveMusicPosition();\n    const onVisibilityChange = () => {\n      if (document.visibilityState === \"hidden\") saveMusicPosition();\n    };\n\n    window.addEventListener(\"pagehide\", onPageHide);\n    document.addEventListener(\"visibilitychange\", onVisibilityChange);\n\n    return () => {\n      window.clearInterval(id);\n      window.removeEventListener(\"pagehide\", onPageHide);\n      document.removeEventListener(\"visibilitychange\", onVisibilityChange);\n    };\n  }, [hasStarted, saveMusicPosition]);\n\n  useEffect(() => {\n    return () => {\n      saveMusicPosition();\n\n      gameMusic.pause();\n      gameMusic.volume = 0;\n      gameMusic.reset();\n\n      clickSound.pause();\n      clickSound.volume = 0;\n      clickSound.reset();\n\n      // Cleanup amplitude analyzer\n      if (amplitudeAnalyzerRef.current) {\n        amplitudeAnalyzerRef.current.disconnect();\n        amplitudeAnalyzerRef.current = null;\n      }\n    };\n  }, [gameMusic, clickSound, saveMusicPosition]);\n\n  const updateOnce = useCallback(() => {\n    const g = gridRef.current;\n    if (!g) return;\n\n    const { w, h } = sizeRef.current;\n\n    stepSimulationOnePairPass(\n      particlesRef.current,\n      w,\n      h,\n      pointerDownRef.current,\n      pointerPosRef.current,\n      neighborCountsRef.current,\n      speedRef.current,\n      g\n    );\n  }, []);\n\n  const draw = useCallback(() => {\n    const canvas = canvasRef.current;\n    const ctx = ctxRef.current;\n    if (!canvas || !ctx) return;\n\n    renderFrame(ctx, canvas, particlesRef.current, imageRef, heatLutRef.current);\n  }, []);\n\n  // 0) Fixed update cadence: updates happen at FIXED_FPS regardless of render speed.\n  const clockRef = useRef<{ last: number; acc: number }>({ last: 0, acc: 0 });\n\n  const animate = useCallback((now: number) => {\n    const clock = clockRef.current;\n\n    if (clock.last === 0) clock.last = now;\n    const delta = now - clock.last;\n    clock.last = now;\n\n    // Clamp massive deltas (tab-switch etc.)\n    clock.acc += Math.min(250, Math.max(0, delta));\n\n    let steps = 0;\n    while (clock.acc >= FIXED_MS && steps < MAX_CATCHUP_STEPS) {\n      updateOnce();\n      clock.acc -= FIXED_MS;\n      steps++;\n    }\n\n    // Drop extra backlog to avoid death spiral\n    if (clock.acc >= FIXED_MS) clock.acc = 0;\n\n    // Update audio amplitude (update state every 3 frames to avoid excessive re-renders)\n    if (amplitudeAnalyzerRef.current) {\n      currentAmplitudeRef.current = amplitudeAnalyzerRef.current.getAmplitude();\n      amplitudeUpdateCounterRef.current++;\n      if (amplitudeUpdateCounterRef.current >= 3) {\n        setDisplayAmplitude(currentAmplitudeRef.current);\n        amplitudeUpdateCounterRef.current = 0;\n      }\n    }\n\n    draw();\n    rafRef.current = requestAnimationFrame(animate);\n  }, [draw, updateOnce]);\n\n  // Pointer handling\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const toLocal = (e: PointerEvent): Vec2 => {\n      const rect = canvas.getBoundingClientRect();\n      return { x: e.clientX - rect.left, y: e.clientY - rect.top };\n    };\n\n    const onDown = (e: PointerEvent) => {\n      pointerDownRef.current = true;\n      pointerPosRef.current = toLocal(e);\n    };\n    const onMove = (e: PointerEvent) => {\n      pointerPosRef.current = toLocal(e);\n    };\n    const onUp = () => {\n      pointerDownRef.current = false;\n    };\n\n    canvas.addEventListener(\"pointerdown\", onDown);\n    window.addEventListener(\"pointermove\", onMove);\n    window.addEventListener(\"pointerup\", onUp);\n    window.addEventListener(\"pointercancel\", onUp);\n\n    return () => {\n      canvas.removeEventListener(\"pointerdown\", onDown);\n      window.removeEventListener(\"pointermove\", onMove);\n      window.removeEventListener(\"pointerup\", onUp);\n      window.removeEventListener(\"pointercancel\", onUp);\n    };\n  }, []);\n\n  const playClick = useCallback(() => {\n    try {\n      clickSound.volume = 1.0;\n      clickSound.currentTime = 0;\n      clickSound.reset();\n      clickSound.play();\n    } catch {\n      // ignore\n    }\n  }, [clickSound]);\n\n  const resumeMusicFromSavedTime = useCallback(() => {\n    const t = readSavedMusicTimeSeconds();\n    try {\n      const duration = (gameMusic as any).duration as number | undefined;\n      if (typeof duration === \"number\" && Number.isFinite(duration) && duration > 0) {\n        gameMusic.currentTime = t % duration;\n      } else {\n        gameMusic.currentTime = t;\n      }\n    } catch {\n      // ignore\n    }\n  }, [gameMusic]);\n\n  const startLamp = useCallback(async () => {\n    playClick();\n\n    if (!hasStarted) {\n      setHasStarted(true);\n      initializeParticlesOnce();\n\n      // reset fixed-timestep clock\n      clockRef.current = { last: 0, acc: 0 };\n\n      // draw a first frame immediately\n      requestAnimationFrame(() => draw());\n\n      // start RAF loop\n      rafRef.current = requestAnimationFrame(animate);\n\n      // Initialize amplitude analyzer\n      if (!amplitudeAnalyzerRef.current) {\n        const analyzer = new AudioAmplitudeAnalyzer();\n        const connected = analyzer.connect(gameMusic);\n        if (connected) {\n          amplitudeAnalyzerRef.current = analyzer;\n          console.log('[LavaLamp] Audio amplitude analyzer connected');\n        } else {\n          console.warn('[LavaLamp] Failed to connect audio amplitude analyzer');\n        }\n      }\n    }\n\n    // Resume audio context if suspended\n    if (amplitudeAnalyzerRef.current) {\n      amplitudeAnalyzerRef.current.resume();\n    }\n\n    // Only resume from saved time for non-streaming sources (like Redwood)\n    if (audioSource !== AUDIO_SOURCES.KEXP) {\n      resumeMusicFromSavedTime();\n    }\n    gameMusic.volume = 1.0;\n\n    // Ensure audio is loaded before trying to play\n    if (gameMusic.readyState < 3) {\n      // If not enough data loaded, trigger load and wait\n      gameMusic.load();\n\n      const onCanPlay = async () => {\n        try {\n          await gameMusic.play();\n        } catch {\n          // ignore if still fails\n        }\n        gameMusic.removeEventListener('canplaythrough', onCanPlay);\n      };\n      gameMusic.addEventListener('canplaythrough', onCanPlay, { once: true });\n    } else {\n      // Audio already loaded, play immediately\n      try {\n        await gameMusic.play();\n      } catch {\n        // ignore autoplay errors\n      }\n    }\n  }, [\n    animate,\n    audioSource,\n    draw,\n    gameMusic,\n    hasStarted,\n    initializeParticlesOnce,\n    playClick,\n    resumeMusicFromSavedTime,\n  ]);\n\n  const initialCanvasSize = useMemo(\n    () => ({ w: window.innerWidth, h: window.innerHeight }),\n    []\n  );\n\n  const lastSpeedIdx = SPEED.STEPS - 1;\n\n  return (\n    <div className=\"lava-lamp-container\">\n      <canvas\n        ref={canvasRef}\n        className=\"lava-lamp-canvas\"\n        width={initialCanvasSize.w}\n        height={initialCanvasSize.h}\n      />\n\n      {nowPlaying && (\n        <div className={`lava-lamp-now-playing ${nowPlayingExpanded ? 'expanded' : 'collapsed'}`}>\n          <button\n            type=\"button\"\n            className=\"lava-lamp-now-playing-toggle\"\n            onClick={() => setNowPlayingExpanded(!nowPlayingExpanded)}\n            aria-label={nowPlayingExpanded ? \"Collapse now playing\" : \"Expand now playing\"}\n          >\n            {nowPlayingExpanded ? '›' : '‹'}\n          </button>\n          <div className=\"lava-lamp-now-playing-content\">\n            <div className=\"lava-lamp-now-playing-header\">\n              <div className=\"lava-lamp-now-playing-label\">kexp</div>\n              {!nowPlaying.isAirbreak && (\n                <div\n                  className=\"lava-lamp-soundwave\"\n                  style={{ '--amplitude': displayAmplitude } as React.CSSProperties}\n                >\n                  <div className=\"lava-lamp-soundwave-bar\"></div>\n                  <div className=\"lava-lamp-soundwave-bar\"></div>\n                  <div className=\"lava-lamp-soundwave-bar\"></div>\n                  <div className=\"lava-lamp-soundwave-bar\"></div>\n                </div>\n              )}\n            </div>\n            <div ref={nowPlayingSongRef} className=\"lava-lamp-now-playing-song\">\n              <span className=\"scroll-wrapper\">\n                {nowPlaying.song}\n              </span>\n              {songOverflowing && (\n                <span className=\"scroll-wrapper second\">\n                  {nowPlaying.song}\n                </span>\n              )}\n            </div>\n            {!nowPlaying.isAirbreak && (\n              <>\n                <div ref={nowPlayingArtistRef} className=\"lava-lamp-now-playing-artist\">\n                  <span className=\"scroll-wrapper\">\n                    {nowPlaying.artist}\n                  </span>\n                  {artistOverflowing && (\n                    <span className=\"scroll-wrapper second\">\n                      {nowPlaying.artist}\n                    </span>\n                  )}\n                </div>\n                <div ref={nowPlayingAlbumRef} className=\"lava-lamp-now-playing-album\">\n                  <span className=\"scroll-wrapper\">\n                    {nowPlaying.album}\n                  </span>\n                  {albumOverflowing && (\n                    <span className=\"scroll-wrapper second\">\n                      {nowPlaying.album}\n                    </span>\n                  )}\n                </div>\n              </>\n            )}\n          </div>\n        </div>\n      )}\n\n      {!hasStarted ? (\n        <div className=\"lava-lamp-start-overlay\">\n          <button\n            type=\"button\"\n            className=\"lava-lamp-start\"\n            onClick={startLamp}\n            aria-label=\"Start lava lamp radio\"\n          >\n            <img src={powerIcon} alt=\"Power\" className=\"lava-lamp-start-icon\" />\n          </button>\n        </div>\n      ) : (\n        <div className=\"lava-lamp-controls\" ref={menuRef}>\n          <button\n            type=\"button\"\n            className=\"lava-lamp-menu-toggle\"\n            onClick={toggleMenu}\n            aria-label={menuOpen ? \"Hide menu\" : \"Show menu\"}\n            aria-pressed={menuOpen}\n          >\n            {menuOpen ? \"✕\" : \"☰\"}\n          </button>\n\n          {menuOpen && (\n            <div className=\"lava-lamp-menu\">\n              {/* Speed */}\n              <div className=\"lava-lamp-control-block\">\n                <div className=\"lava-lamp-control-header\">\n                  <div className=\"lava-lamp-control-title\">speed: {speedIdx}</div>\n                </div>\n\n                <div className=\"lava-lamp-slider-wrap\">\n                  <input\n                    className=\"lava-lamp-slider\"\n                    type=\"range\"\n                    min={0}\n                    max={lastSpeedIdx}\n                    step={1}\n                    value={speedIdx}\n                    onChange={(e) =>\n                      setSpeedIdx(clampInt(Number(e.target.value), 0, lastSpeedIdx))\n                    }\n                    aria-label=\"Simulation speed\"\n                  />\n                </div>\n              </div>\n\n              {/* Volume */}\n              <div className=\"lava-lamp-control-block\">\n                <div className=\"lava-lamp-control-header\">\n                  <div className=\"lava-lamp-control-title\">\n                    volume: {Math.round(volume * 100)}%\n                  </div>\n                </div>\n\n                <div className=\"lava-lamp-slider-wrap\">\n                  <input\n                    className=\"lava-lamp-slider\"\n                    type=\"range\"\n                    min={0}\n                    max={1}\n                    step={0.01}\n                    value={volume}\n                    onChange={(e) => setVolume(Number(e.target.value))}\n                    aria-label=\"Music volume\"\n                  />\n                </div>\n              </div>\n\n              {/* Audio Source */}\n              <div className=\"lava-lamp-control-block\">\n                <div className=\"lava-lamp-control-header\">\n                  <div className=\"lava-lamp-control-title\">audio source</div>\n                </div>\n\n                <div className=\"lava-lamp-slider-wrap\">\n                  <select\n                    className=\"lava-lamp-slider\"\n                    value={audioSource}\n                    onChange={(e) => setAudioSource(e.target.value as AudioSource)}\n                    aria-label=\"Audio source\"\n                  >\n                    {Object.entries(AUDIO_SOURCE_CONFIG).map(([key, config]) => (\n                      <option key={key} value={key}>\n                        {config.label}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n              </div>\n\n              {/* Lava colors */}\n              <div className=\"lava-lamp-control-block\">\n                <div className=\"lava-lamp-control-header\">\n                  <div className=\"lava-lamp-control-title\">lava colors</div>\n                </div>\n\n                <div className=\"lava-lamp-color-row\">\n\n                  <label className=\"lava-lamp-color-label\">\n                    hot\n                    <input\n                      className=\"lava-lamp-color-input\"\n                      type=\"color\"\n                      value={lavaHighColor}\n                      onChange={(e) => setLavaHighColor(e.target.value)}\n                      aria-label=\"Lava high color\"\n                    />\n                  </label>\n\n                  <label className=\"lava-lamp-color-label\">\n                    cool\n                    <input\n                      className=\"lava-lamp-color-input\"\n                      type=\"color\"\n                      value={lavaLowColor}\n                      onChange={(e) => setLavaLowColor(e.target.value)}\n                      aria-label=\"Lava low color\"\n                    />\n                  </label>\n\n                  <button\n                    type=\"button\"\n                    className=\"lava-lamp-color-reset\"\n                    onClick={() => {\n                      setLavaLowColor(DEFAULT_LOW);\n                      setLavaHighColor(DEFAULT_HIGH);\n                    }}\n                  >\n                    reset\n                  </button>\n                </div>\n              </div>\n\n              {/* Power off */}\n              <div className=\"lava-lamp-control-block\">\n                <button\n                  type=\"button\"\n                  className=\"lava-lamp-power-off\"\n                  onClick={() => window.location.reload()}\n                  aria-label=\"Power off\"\n                >\n                  <img src={powerIcon} alt=\"Power off\" className=\"lava-lamp-power-off-icon\" />\n                  <span>power off</span>\n                </button>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n","export class PersonalAudio extends Audio {\n  constructor(src, loop=false) {\n    super(src);\n    this.loop = loop;\n    this.crossOrigin = \"anonymous\";\n  };\n\n  isPlayingSrc = (audioSrc) => {\n    return this.src?.includes(audioSrc)\n        && this.currentTime > 0\n        && !this.paused\n        && !this.ended\n        && this.readyState > 2;\n  };\n\n  isPlaying = () => {\n    return this.currentTime > 0\n        && !this.paused\n        && !this.ended\n        && this.readyState > 2;\n  };\n\n  timeLeft = () => this.duration - this.currentTime;\n\n  reset = () => {\n    this.pause();\n    this.currentTime = 0;\n  };\n}"],"names":["AudioAmplitudeAnalyzer","constructor","audioContext","analyser","dataArray","connected","connect","audioElement","this","AudioContext","createAnalyser","fftSize","smoothingTimeConstant","createMediaElementSource","destination","Uint8Array","frequencyBinCount","err","console","warn","getAmplitude","getByteTimeDomainData","sum","i","length","normalized","rms","Math","sqrt","min","resume","state","catch","disconnect","close","isConnected","AUDIO_SOURCES","REDWOOD","KEXP","AUDIO_SOURCE_CONFIG","label","url","musicAudioNoise","DEFAULT_HIGH","DEFAULT_LOW","SIM","GRAVITY","BUOYANCY","FRICTION","HEAT_RATE","COOL_RATE","HEAT_CONDUCTION","HEAT_SOURCE_DISTANCE","COHESION_RADIUS","COHESION_STRENGTH","MOUSE_HEAT_RADIUS","RENDER","PARTICLE_RADIUS","PIXEL_SIZE","THRESHOLD","CLUMPS","COUNT","RADIUS","TOP_HALF_PROB","BASELINE","WIDTH","HEIGHT","PARTICLES","SPEED","MIN","MAX","DEFAULT","STEPS","FIXED_MS","MAX_CATCHUP_STEPS","MUSIC_TIME_KEY","clamp01","v","lerpInt","a","b","t","round","randInCircle","radius","angle","random","PI","r","x","cos","y","sin","bounceInBounds","p","width","height","vx","vy","clampAllToBounds","particles","indexToSpeed","idx","steps","minPositive","targetMidSpeed","minLog","log","maxLog","exp","lerp","hexToRgb","hex","h","trim","replace","parseInt","g","slice","packRgba","buildHeatLut256","lowHex","highHex","lo","hi","lut","Uint32Array","gridIndex","cx","cy","cols","stepSimulationOnePairPass","pointerDown","pointerPos","neighborCounts","timeScale","grid","dt","max","applyBuoyancyAndGravity","applyFriction","integrate","applyPointerHeat","heat","heads","fill","invCell","cellSize","rows","cell","next","r2","p1","x0","x1","y0","y1","ny","nx","j","p2","dx","dy","d2","applyCohesionImpulse","applyHeatConduction","applyBottomHeatOrAirCooling","buoyancy","f","pow","intensity","d","force","invD","fx","fy","conduction","neighborCount","distanceFromBottom","airExposure","renderFrame","ctx","canvas","imageRef","heatLut256","imageData","img","current","createImageData","ensureImageData","canvasWidth","canvasHeight","pixelSize","threshold","data32","data","buffer","black","w","influenceSum","heatWeightedSum","influence","rgba","py","yy","rowEnd","xx","drawMetaballs","putImageData","LavaLamp","canvasRef","useRef","ctxRef","rafRef","particlesRef","neighborCountsRef","Uint16Array","particleCountRef","gridRef","sizeRef","audioSource","setAudioSource","useState","gameMusic","useMemo","audio","PersonalAudio","preload","clickSound","clickAudioNoise","hasStarted","setHasStarted","pointerDownRef","pointerPosRef","amplitudeAnalyzerRef","currentAmplitudeRef","displayAmplitude","setDisplayAmplitude","amplitudeUpdateCounterRef","defaultSpeedIdx","speed","last","best","bestErr","Infinity","target","s","abs","speedToNearestIndex","speedIdx","setSpeedIdx","speedRef","useEffect","menuOpen","setMenuOpen","toggleMenu","useCallback","menuRef","handleClickOutside","event","contains","document","addEventListener","removeEventListener","volume","setVolume","nowPlaying","setNowPlaying","nowPlayingExpanded","setNowPlayingExpanded","nowPlayingSongRef","nowPlayingArtistRef","nowPlayingAlbumRef","songOverflowing","setSongOverflowing","artistOverflowing","setArtistOverflowing","albumOverflowing","setAlbumOverflowing","isFirstRender","config","wasPlaying","isPlaying","pause","src","load","onCanPlay","play","once","fetchNowPlaying","async","_data$results","response","fetch","mostRecentPlay","json","results","play_type","song","artist","album","isAirbreak","newTrack","toLowerCase","interval","setInterval","clearInterval","calculateScrollDuration","containerWidth","textWidth","checkOverflow","wrapper","querySelector","clientWidth","isOverflowing","scrollWidth","duration","style","setProperty","concat","classList","add","remove","window","lavaLowColorRef","lavaHighColorRef","lavaLowColor","setLavaLowColor","lavaHighColor","setLavaHighColor","heatLutRef","innerWidth","innerHeight","getContext","initializeParticlesOnce","baselineArea","currentArea","density","scaled","computeParticleCount","count","particlesPerClump","floor","centerX","centerY","clumpHeat","offset","push","createParticles","ceil","cells","Int32Array","ensureGrid","saveMusicPosition","_gameMusic$currentTim","seconds","Number","isFinite","localStorage","setItem","String","_unused2","writeSavedMusicTimeSeconds","currentTime","id","tick","onPageHide","onVisibilityChange","visibilityState","reset","updateOnce","draw","clockRef","acc","animate","now","clock","delta","requestAnimationFrame","toLocal","e","rect","getBoundingClientRect","clientX","left","clientY","top","onDown","onMove","onUp","playClick","_unused3","resumeMusicFromSavedTime","raw","getItem","_unused","readSavedMusicTimeSeconds","_unused4","startLamp","analyzer","readyState","_unused5","_unused6","initialCanvasSize","lastSpeedIdx","_jsxs","className","children","_jsx","ref","type","onClick","_Fragment","step","value","onChange","Object","entries","map","_ref","key","location","reload","powerIcon","alt","Audio","loop","arguments","undefined","super","isPlayingSrc","audioSrc","_this$src","includes","paused","ended","timeLeft","crossOrigin"],"sourceRoot":""}