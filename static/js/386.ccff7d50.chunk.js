"use strict";(self.webpackChunkpersonalsite=self.webpackChunkpersonalsite||[]).push([[386],{6110:(e,r,t)=>{t.r(r),t.d(r,{default:()=>R});var n=t(2782),c=t(5043),u=t(7375),s=t(579);const o=e=>{let{setDirection:r}=e;const[t,u]=(0,c.useState)();return(0,c.useEffect)((()=>{document.addEventListener("touchmove",(e=>{e.preventDefault()}),{passive:!1})}),[]),(0,s.jsx)(n.Ay,{className:"joystick",onChange:e=>{t!==e.direction&&e.direction!==n.OP.Center&&(u(e.direction),r(e.direction))}})},a=t.p+"static/media/game_over.21c74c34f50a8ecedde0.mp3",l=t.p+"static/media/groovy_click.5cb6eae90670166005af.mp3",i=t.p+"static/media/the_gathering.2d97c4755109d9278151.mp3",d=35,h=20,f=6;var w=125;const m=0,p=1,g=2,v=3,y=5,b=22;function R(){const[e,r]=(0,c.useState)(0),[t,R]=(0,c.useState)(!1),[x,k]=(0,c.useState)(0),[A,E]=(0,c.useState)("ArrowRight"),[S,j]=(0,c.useState)(0),[M,L]=(0,c.useState)(0),D=(0,c.useRef)(null),C=(0,c.useRef)(w),N=(0,c.useRef)(!1),T=(0,c.useRef)(p),P=(0,c.useRef)(p),F=(0,c.useRef)([]),O=(0,c.useRef)(new Set),z=(0,c.useRef)({row:-1,col:-1}),I=(0,c.useRef)(!1),U=(0,c.useRef)(!1),q=(0,c.useRef)([]),W=(0,c.useRef)(new Set),_=(0,c.useRef)(new Uint8Array(h*d)),B=(0,c.useRef)([]),G=(0,c.useRef)(),V=(0,c.useMemo)((()=>new u.D(l)),[]),K=(0,c.useMemo)((()=>new u.D(a)),[]),H=(0,c.useMemo)((()=>new u.D(i,!0)),[]),J=S<=768,Q=(e,r)=>e*d+r,X=e=>(e+2)%4,Y=function(e,r,t,n){let c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return((e,r,t,n)=>Math.max(Math.abs(e-t),Math.abs(r-n)))(e,r,t,n)>=c+1},Z=(0,c.useRef)(null),$=(0,c.useRef)(null),ee=(0,c.useRef)(null),re=(0,c.useRef)(null),te=(0,c.useRef)(null),ne=d*b,ce=h*b,ue="rgba(233,233,242,0.55)",se="rgba(233,233,242,0.9)",oe="#3cff00",ae="#ffffff",le="#ffffff",ie="#ff4d4f",de=function(e,r,t){let{alpha:n}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{alpha:!0};const c=Math.max(1,window.devicePixelRatio||1);(e.width!==r*c||e.height!==t*c)&&(e.width=r*c,e.height=t*c,e.style.width="".concat(r,"px"),e.style.height="".concat(t,"px"));const u=e.getContext("2d",{alpha:n});return u.setTransform(c,0,0,c,0,0),u},he=(e,r,t,n)=>{e.fillStyle=n,e.fillRect(t*b,r*b,b,b)},fe=(e,r,t)=>e.clearRect(t*b,r*b,b,b),we=e=>{const r=(()=>{const e=Z.current;if(!e)return"transparent";const r=getComputedStyle(e).backgroundColor;return r&&"rgba(0, 0, 0, 0)"!==r?r:"rgb(95, 93, 156)"})();e.fillStyle=r,e.fillRect(0,0,ne,ce),e.save(),e.strokeStyle=ue,e.setLineDash([2,3]),e.lineWidth=1,e.beginPath();for(let t=0;t<=h;t++){const r=t*b+.5;e.moveTo(0,r),e.lineTo(ne,r)}for(let t=0;t<=d;t++){const r=t*b+.5;e.moveTo(r,0),e.lineTo(r,ce)}e.stroke(),e.restore()},me=(e,r)=>re.current&&he(re.current,e,r,se),pe=()=>{const e=z.current;te.current&&e.row>=0&&he(te.current,e.row,e.col,oe)},ge=()=>{const e=z.current;if(!te.current||e.row<0)return;const r=F.current[F.current.length-1];r&&r.row===e.row&&r.col===e.col||fe(te.current,e.row,e.col)},ve=()=>{if(!te.current||!F.current.length)return;for(let r=0;r<F.current.length-1;r++){const{row:e,col:t}=F.current[r];he(te.current,e,t,ae)}const e=F.current[F.current.length-1];he(te.current,e.row,e.col,le)},ye=(0,c.useCallback)((e=>{switch(e){case"w":case"W":case n.OP.Top:e="ArrowUp";break;case"s":case"S":case n.OP.Bottom:e="ArrowDown";break;case"a":case"A":case n.OP.Left:e="ArrowLeft";break;case"d":case"D":case n.OP.Right:e="ArrowRight"}const r="ArrowUp"===e?m:"ArrowDown"===e?g:"ArrowLeft"===e?v:"ArrowRight"===e?p:null;return null==r||r===X(T.current)?null:r}),[]),be=e=>{var r;if(null==e)return;const t=B.current.length?B.current[B.current.length-1]:null!==(r=P.current)&&void 0!==r?r:T.current;e!==X(t)&&(B.current.length&&B.current[B.current.length-1]===e||B.current.length<3&&B.current.push(e))},Re=(e,r)=>!O.current.has(Q(e,r)),xe=(e,r)=>!W.current.has(Q(e,r)),ke=(e,r)=>0===_.current[Q(e,r)],Ae=(e,r)=>Re(e,r)&&((e,r)=>{if(!F.current.length)return!0;const t=F.current[F.current.length-1];return Y(e,r,t.row,t.col,5)})(e,r)&&xe(e,r)&&ke(e,r),Ee=(e,r)=>Re(e,r)&&xe(e,r)&&ke(e,r)&&((e,r)=>{const t=z.current;return t.row<0||Y(e,r,t.row,t.col,1)})(e,r),Se=(0,c.useCallback)((()=>{let e,r,t=0;do{if(e=Math.random()*h|0,r=Math.random()*d|0,t++,t>200)break}while(!Ae(e,r));ge(),z.current={row:e,col:r},pe()}),[]),je=()=>{let e,r,t=0;do{if(e=Math.random()*h|0,r=Math.random()*d|0,t++,t>300)return}while(!Ee(e,r));q.current.push({row:e,col:r}),W.current.add(Q(e,r)),me(e,r),((e,r,t)=>{for(let n=e-1;n<=e+1;n++)for(let e=r-1;e<=r+1;e++){if(n<0||e<0||n>=h||e>=d)continue;const r=Q(n,e),c=_.current[r]+t;_.current[r]=c<0?0:c}})(e,r,1)},Me=(0,c.useCallback)((()=>{F.current=[],O.current=new Set,q.current=[],W.current=new Set,_.current=new Uint8Array(h*d),$.current&&ee.current&&(re.current=de($.current,ne,ce,{alpha:!1}),te.current=de(ee.current,ne,ce,{alpha:!0}),we(re.current),te.current.clearRect(0,0,ne,ce));for(let e=0;e<f;e++)F.current.push({row:0,col:e}),O.current.add(Q(0,e));K.volume=1,V.volume=1,H.volume=1,R(!1),r(0),T.current=p,P.current=p,B.current=[],I.current=!1,U.current=!1,ve(),Se()}),[V,H,K,Se]),Le=()=>{if(N.current)return;N.current=!0;let e=performance.now(),r=0;const t=n=>{if(N.current){for(r+=n-e,e=n;r>=C.current;)Te(),r-=C.current;D.current=requestAnimationFrame(t)}};D.current=requestAnimationFrame(t)},De=()=>{D.current&&cancelAnimationFrame(D.current),D.current=null,N.current=!1},Ce=async()=>{R(!0),L(0),K.play(),H.reset(),k(0),I.current=!1,U.current=!0,B.current=[],(()=>{if(!te.current||!F.current.length)return;const e=F.current[F.current.length-1];he(te.current,e.row,e.col,ie)})(),De()},Ne=(e,r)=>((e,r)=>e<0||r<0||e>=h||r>=d)(e,r)||W.current.has(Q(e,r))?"wall":!!O.current.has(Q(e,r))&&"self",Te=()=>{if(!I.current||U.current)return;B.current.length&&(P.current=B.current.shift()),T.current=P.current;const e=F.current[F.current.length-1],[t,n]=(c=e.row,u=e.col,(s=T.current)===m?[c-1,u]:s===g?[c+1,u]:s===v?[c,u-1]:[c,u+1]);var c,u,s;const o=t===z.current.row&&n===z.current.col;if(Ne(t,n))Ce();else if(o&&ge(),he(te.current,e.row,e.col,ae),F.current.push({row:t,col:n}),O.current.add(Q(t,n)),he(te.current,t,n,le),o)r((e=>{const r=e+1;return r%y===0&&L((e=>e+43.5)),r>=y&&r%y===0&&(je(),je()),r})),Se();else{const e=F.current.shift();O.current.delete(Q(e.row,e.col)),fe(te.current,e.row,e.col)}};return(0,c.useLayoutEffect)((()=>{let e=0;const r=()=>{cancelAnimationFrame(e),e=requestAnimationFrame((()=>{if(j(window.innerWidth),$.current&&ee.current){re.current=de($.current,ne,ce,{alpha:!1}),te.current=de(ee.current,ne,ce,{alpha:!0}),we(re.current);for(const e of q.current)me(e.row,e.col);te.current.clearRect(0,0,ne,ce),ve(),pe()}}))};return window.addEventListener("resize",r),r(),()=>{cancelAnimationFrame(e),window.removeEventListener("resize",r)}}),[]),(0,c.useEffect)((()=>{const e=e=>{const r=ye(e.key);be(r)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[ye]),(0,c.useEffect)((()=>{if(!J)return;const e=ye(A);be(e)}),[A,ye,J]),(0,c.useEffect)((()=>{const e=document.getElementById("app-base");e&&(e.style.filter="hue-rotate(".concat(M,"deg)"))}),[M]),(0,c.useEffect)((()=>{const e=()=>document.hidden?De():I.current&&Le();return document.addEventListener("visibilitychange",e,{passive:!0}),()=>document.removeEventListener("visibilitychange",e)}),[]),(0,c.useEffect)((()=>()=>{K.volume=0,V.volume=0,H.volume=0,H.currentTime=0,De()}),[K,V,H]),(0,c.useEffect)((()=>{Me()}),[Me]),(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{id:"app-base",className:"snek-colors",children:(0,s.jsxs)("div",{className:"game-container",style:{cursor:x?"none":"inherit"},children:[(0,s.jsx)("h1",{className:"snek-title",style:{display:x||t?"none":"block"},children:"SNEK"}),!x&&(0,s.jsx)("button",{onMouseDown:()=>V.play(),onClick:()=>{N.current||(async()=>{De(),Me(),G.current=o,k(1),I.current=!0,U.current=!1,H.play(),Le()})()},disabled:N.current,children:t?"try again":"start game"}),(0,s.jsxs)("div",{id:"board-wrap",className:"board",ref:Z,style:{display:x||t?"block":"none",position:"absolute",width:ne,height:ce},children:[(0,s.jsx)("canvas",{ref:$,width:ne,height:ce,style:{position:"absolute",left:0,top:0,zIndex:1}}),(0,s.jsx)("canvas",{ref:ee,width:ne,height:ce,style:{position:"absolute",left:0,top:0,background:"transparent",zIndex:2,imageRendering:"pixelated"}}),t&&(0,s.jsxs)("div",{className:"game-over",style:{zIndex:3},children:[(0,s.jsx)("p",{className:"game-over-text",children:(0,s.jsxs)("span",{children:["GAME OVER"," "]})}),(0,s.jsx)("p",{className:"game-over-text second",children:(0,s.jsxs)("span",{children:["GAME OVER"," "]})})]})]}),(0,s.jsx)("p",{className:"score",style:{display:x||t?"block":"none"},children:e}),J&&x&&G.current?(0,s.jsx)(G.current,{setDirection:E}):null]})})})}},7375:(e,r,t)=>{t.d(r,{D:()=>n});class n extends Audio{constructor(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e),this.isPlayingSrc=e=>{var r;return(null===(r=this.src)||void 0===r?void 0:r.includes(e))&&this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2},this.timeLeft=()=>this.duration-this.currentTime,this.reset=()=>{this.pause(),this.currentTime=0},this.loop=r}}}}]);
//# sourceMappingURL=386.ccff7d50.chunk.js.map